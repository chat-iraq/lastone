!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=57)}([function(e,t,n){var r;e.exports=(r=r||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=a<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){t=t;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<t;o+=4){var s=i(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=i/(4*o),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,u=e.min(4*c,i);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(r,l);var d=r.splice(0,c);n.sigBytes-=u}return new a.init(d,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(i.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math),r)},function(e,t,n){var r,i,o,a,s,c,u,l,d,p,f,h,m,g,_,v,y,b,w;e.exports=(r=n(0),n(5),void(r.lib.Cipher||(i=r,o=i.lib,a=o.Base,s=o.WordArray,c=o.BufferedBlockAlgorithm,u=i.enc,u.Utf8,l=u.Base64,d=i.algo.EvpKDF,p=o.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(n,r,i){return e(r).encrypt(t,n,r,i)},decrypt:function(n,r,i){return e(r).decrypt(t,n,r,i)}}}}()}),o.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=i.mode={},h=o.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=f.CBC=function(){var e=h.extend();function t(e,t,n){var r=this._iv;if(r){var i=r;this._iv=void 0}else i=this._prevBlock;for(var o=0;o<n;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+i)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);r.decryptBlock(e,n),t.call(this,e,n,i),this._prevBlock=o}}),e}(),g=(i.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,o=[],a=0;a<r;a+=4)o.push(i);var c=s.create(o,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.BlockCipher=p.extend({cfg:p.cfg.extend({mode:m,padding:g}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else r=n.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),_=o.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(i.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=s.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(l)},parse:function(e){var t=l.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=s.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return _.create({ciphertext:t,salt:r})}},y=o.SerializableCipher=a.extend({cfg:a.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),o=i.finalize(t),a=i.cfg;return _.create({ciphertext:o,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(i.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=s.random(8));var i=d.create({keySize:t+n}).compute(e,r),o=s.create(i.words.slice(t),4*n);return i.sigBytes=4*t,_.create({key:i,iv:o,salt:r})}},w=o.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:b}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var o=y.encrypt.call(this,e,t,i.key,r);return o.mixIn(i),o},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=i.iv,y.decrypt.call(this,e,t,i.key,r)}}))))},function(e,t){function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.sessions={},a.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||a.extension.isInstalled()}return!0};var o={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var r=new Error("NavigatorUserMediaError");r.name="You cancelled the request for permission, giving up...",n(r)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function a(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:a.noop,!a.initDone)return e.error("Library not initialized"),{};if(!a.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(a.log("Library initialized: "+a.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,r=null,o={},s=null,c=null,u=0,l=e.server;a.isArray(l)?(a.log("Multiple servers provided ("+l.length+"), will use the first that works"),l=null,c=e.server,a.debug(c)):0===l.indexOf("ws")?(t=!0,a.log("Using WebSockets to contact Janus: "+l)):(t=!1,a.log("Using REST API to contact Janus: "+l));var d=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],p=e.iceTransportPolicy,f=e.bundlePolicy,h=!0===e.ipv6,m=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(m=!0===e.withCredentials);var g=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(g=e.max_poll_events),g<1&&(g=1);var _=null;void 0!==e.token&&null!==e.token&&(_=e.token);var v=null;void 0!==e.apisecret&&null!==e.apisecret&&(v=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var y=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(y=e.keepAlivePeriod),isNaN(y)&&(y=25e3);var b=6e4;function w(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(b=e.longPollTimeout),isNaN(b)&&(b=6e4);var S=!1,k=null,C={},E=this,T=0,P={};function A(){if(null!=k)if(a.debug("Long poll..."),S){var t=l+"/"+k+"?rid="+(new Date).getTime();g&&(t=t+"&maxev="+g),_&&(t=t+"&token="+encodeURIComponent(_)),v&&(t=t+"&apisecret="+encodeURIComponent(v)),a.httpAPICall(t,{verb:"GET",withCredentials:m,success:R,timeout:b,error:function(t,n){if(a.error(t+":",n),++T>3)return S=!1,void e.error("Lost connection to the server (is it down?)");A()}})}else a.warn("Is the server down? (connected=false)")}function R(e,n){if(T=0,t||null==k||!0===n||A(),t||!a.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){if(!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");var i=e.candidate;a.debug("Got a trickled candidate on session "+k),a.debug(i);var o=d.webrtcStuff;o.pc&&o.remoteSdp?(a.debug("Adding remote candidate:",i),i&&!0!==i.completed?o.pc.addIceCandidate(i):o.pc.addIceCandidate(a.endOfCandidates)):(a.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),o.candidates||(o.candidates=[]),o.candidates.push(i),a.debug(o.candidates))}else{if("webrtcup"===e.janus)return a.debug("Got a webrtcup event on session "+k),a.debug(e),(u=e.sender)?(d=C[u])?void d.webrtcState(!0):void a.debug("This handle is not attached to this session"):void a.warn("Missing sender...");if("hangup"===e.janus){if(a.debug("Got a hangup event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.webrtcState(!1,e.reason),d.hangup()}else if("detached"===e.janus){if(a.debug("Got a detached event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return;d.detached=!0,d.ondetached(),d.detach()}else if("media"===e.janus){if(a.debug("Got a media event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(a.debug("Got a slowlink event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(d=C[u]))return void a.debug("This handle is not attached to this session");d.slowLink(e.uplink,e.lost)}else{if("error"===e.janus){var s,c;if(a.error("Ooops: "+e.error.code+" "+e.error.reason),a.debug(e),s=e.transaction)(c=P[s])&&c(e),delete P[s];return}if("event"===e.janus){var u;if(a.debug("Got a plugin event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");var l=e.plugindata;if(!l)return void a.warn("Missing plugindata...");a.debug("  -- Event is coming from "+u+" ("+l.plugin+")");var d,p=l.data;if(a.debug(p),!(d=C[u]))return void a.warn("This handle is not attached to this session");var f=e.jsep;f&&(a.debug("Handling SDP as well..."),a.debug(f));var h=d.onmessage;h?(a.debug("Notifying application..."),h(p,f)):a.debug("No provided notification callback")}else{if("timeout"===e.janus)return a.error("Timeout on session "+k),a.debug(e),void(t&&r.close(3504,"Gateway timeout"));a.warn("Unknown message/event  '"+e.janus+"' on session "+k),a.debug(e)}}}else a.debug("Got a success on session "+k),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.debug("Got an ack on session "+k),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.debug("Got info on the Janus instance"),a.debug(e),(s=e.transaction)&&((c=P[s])&&c(e),delete P[s]);else a.vdebug("Got a keepalive on session "+k);else for(var m=0;m<e.length;m++)R(e[m],!0)}function O(){if(l&&t&&S){s=setTimeout(O,y);var e={janus:"keepalive",session_id:k,transaction:a.randomString(12)};_&&(e.token=_),v&&(e.apisecret=v),r.send(JSON.stringify(e))}}function x(n){var i=a.randomString(12),d={janus:"create",transaction:i};if(n.reconnect&&(S=!1,d.janus="claim",d.session_id=k,r&&(r.onopen=null,r.onerror=null,r.onclose=null,s&&(clearTimeout(s),s=null))),_&&(d.token=_),v&&(d.apisecret=v),!l&&a.isArray(c)&&(0===(l=c[u]).indexOf("ws")?(t=!0,a.log("Server #"+(u+1)+": trying WebSockets to contact Janus ("+l+")")):(t=!1,a.log("Server #"+(u+1)+": trying REST API to contact Janus ("+l+")"))),t)for(var p in r=a.newWebSocket(l,"janus-protocol"),o={error:function(){if(a.error("Error connecting to the Janus WebSockets server... "+l),a.isArray(c)&&!n.reconnect)return++u===c.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){x(n)}),200));n.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){P[i]=function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);s=setTimeout(O,y),S=!0,k=e.session_id?e.session_id:e.data.id,n.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,n.success()},r.send(JSON.stringify(d))},message:function(e){R(JSON.parse(e.data))},close:function(){l&&S&&(S=!1,e.error("Lost connection to the server (is it down?)"))}})r.addEventListener(p,o[p]);else a.httpAPICall(l,{verb:"POST",withCredentials:m,body:d,success:function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);S=!0,k=e.session_id?e.session_id:e.data.id,n.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,A(),n.success()},error:function(e,t){if(a.error(e+":",t),a.isArray(c)&&!n.reconnect)return++u===c.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){x(n)}),200));""===t?n.error(e+": Is the server down?"):n.error(e+": "+t)}})}function M(e,n){if((n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var i=C[e];if(!i||!i.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var o=n.message,s=n.jsep,c=a.randomString(12),u={janus:"message",body:o,transaction:c};if(i.token&&(u.token=i.token),v&&(u.apisecret=v),s&&(u.jsep={type:s.type,sdp:s.sdp},s.e2ee&&(u.jsep.e2ee=!0),"hml"!==s.rid_order&&"lmh"!==s.rid_order||(u.jsep.rid_order=s.rid_order)),a.debug("Sending message to plugin (handle="+e+"):"),a.debug(u),t)return u.session_id=k,u.handle_id=e,P[c]=function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void n.success();a.log("Synchronous transaction successful ("+t.plugin+")");var r=t.data;return a.debug(r),void n.success(r)}"ack"===e.janus?n.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),n.error("Unknown error"))},void r.send(JSON.stringify(u));a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:u,success:function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void n.success();a.log("Synchronous transaction successful ("+t.plugin+")");var r=t.data;return a.debug(r),void n.success(r)}"ack"===e.janus?n.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){a.error(e+":",t),n.error(e+": "+t)}})}function I(e,n){if(S){var i=C[e];if(i&&i.webrtcStuff){var o={janus:"trickle",candidate:n,transaction:a.randomString(12)};if(i.token&&(o.token=i.token),v&&(o.apisecret=v),a.vdebug("Sending trickle candidate (handle="+e+"):"),a.vdebug(o),t)return o.session_id=k,o.handle_id=e,void r.send(JSON.stringify(o));a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:o,success:function(e){a.vdebug("Candidate sent!"),a.vdebug(e),"ack"===e.janus||a.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){a.error(e+":",t)}})}else a.warn("Invalid handle")}else a.warn("Is the server down? (connected=false)")}function D(e,t,r,i,o){var s=C[e];if(s&&s.webrtcStuff){var c=s.webrtcStuff;if(c.pc){var u=function(e){a.log("Received state change on data channel:",e);var t=e.target.label,r=e.target.protocol,i=c.dataChannel[t]?c.dataChannel[t].readyState:"null";if(a.log("State change on <"+t+"> data channel: "+i),"open"===i){if(c.dataChannel[t].pending&&c.dataChannel[t].pending.length>0){a.log("Sending pending messages on <"+t+">:",c.dataChannel[t].pending.length);var o,u=n(c.dataChannel[t].pending);try{for(u.s();!(o=u.n()).done;){var l=o.value;a.log("Sending data on data channel <"+t+">"),a.debug(l),c.dataChannel[t].send(l)}}catch(e){u.e(e)}finally{u.f()}c.dataChannel[t].pending=[]}s.ondataopen(t,r)}};if(i)c.dataChannel[t]=i;else{var l={ordered:!0};r&&(l.protocol=r),c.dataChannel[t]=c.pc.createDataChannel(t,l)}c.dataChannel[t].onmessage=function(e){a.log("Received message on data channel:",e);var t=e.target.label;s.ondata(e.data,t)},c.dataChannel[t].onopen=u,c.dataChannel[t].onclose=u,c.dataChannel[t].onerror=function(e){a.error("Got error on data channel:",e)},c.dataChannel[t].pending=[],o&&c.dataChannel[t].pending.push(o)}else a.warn("Invalid PeerConnection")}else a.warn("Invalid handle")}function B(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var r=n.webrtcStuff,i=t.text||t.data;if(!i)return a.warn("Invalid data"),void t.error("Invalid data");var o=t.label?t.label:a.dataChanDefaultLabel;return r.dataChannel[o]?"open"!==r.dataChannel[o].readyState?(r.dataChannel[o].pending.push(i),void t.success()):(a.log("Sending data on data channel <"+o+">"),a.debug(i),r.dataChannel[o].send(i),void t.success()):(D(e,o,t.protocol,!1,i,t.protocol),void t.success())}function U(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var r=n.webrtcStuff;if(!r.dtmfSender){if(r.pc){var i=r.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!i)return a.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");r.dtmfSender=i.dtmf,r.dtmfSender&&(a.log("Created DTMF Sender"),r.dtmfSender.ontonechange=function(e){a.debug("Sent DTMF tone: "+e.tone)})}if(!r.dtmfSender)return a.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var o=t.dtmf;if(!o)return a.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=o.tones;if(!s)return a.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var c="number"==typeof o.duration?o.duration:500,u="number"==typeof o.gap?o.gap:50;a.debug("Sending DTMF string "+s+" (duration "+c+"ms, gap "+u+"ms)"),r.dtmfSender.insertDTMF(s,c,u),t.success()}function L(e,n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop;var i=!0===n.noRequest;a.log("Destroying handle "+e+" (only-locally="+i+")"),z(e);var o=C[e];if(!o||o.detached)return delete C[e],void n.success();if(i)return delete C[e],void n.success();if(!S)return a.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var s={janus:"detach",transaction:a.randomString(12)};if(o.token&&(s.token=o.token),v&&(s.apisecret=v),t)return s.session_id=k,s.handle_id=e,r.send(JSON.stringify(s)),delete C[e],void n.success();a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:s,success:function(t){a.log("Destroyed handle:"),a.debug(t),"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),delete C[e],n.success()},error:function(t,r){a.error(t+":",r),delete C[e],n.success()}})}function j(e,t,r,o,s){var c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),o.stream||a.stopAllTracks(s),void o.error("Invalid handle");var u=c.webrtcStuff;a.debug("streamsDone:",s),s&&(a.debug("  -- Audio tracks:",s.getAudioTracks()),a.debug("  -- Video tracks:",s.getVideoTracks()));var l=!1;if(u.myStream&&r.update&&!u.streamExternal){if((!r.update&&H(r)||r.update&&(r.addAudio||r.replaceAudio))&&s.getAudioTracks()&&s.getAudioTracks().length)if(u.myStream.addTrack(s.getAudioTracks()[0]),a.unifiedPlan){a.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]);var m=null;if((v=u.pc.getTransceivers())&&v.length>0){var g,_=n(v);try{for(_.s();!(g=_.n()).done;){if((k=g.value).sender&&k.sender.track&&"audio"===k.sender.track.kind||k.receiver&&k.receiver.track&&"audio"===k.receiver.track.kind){m=k;break}}}catch(e){_.e(e)}finally{_.f()}}m&&m.sender?m.sender.replaceTrack(s.getAudioTracks()[0]):u.pc.addTrack(s.getAudioTracks()[0],s)}else a.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]),u.pc.addTrack(s.getAudioTracks()[0],s);if((!r.update&&X(r)||r.update&&(r.addVideo||r.replaceVideo))&&s.getVideoTracks()&&s.getVideoTracks().length)if(u.myStream.addTrack(s.getVideoTracks()[0]),a.unifiedPlan){a.log((r.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]);var v,y=null;if((v=u.pc.getTransceivers())&&v.length>0){var b,S=n(v);try{for(S.s();!(b=S.n()).done;){var k;if((k=b.value).sender&&k.sender.track&&"video"===k.sender.track.kind||k.receiver&&k.receiver.track&&"video"===k.receiver.track.kind){y=k;break}}}catch(e){S.e(e)}finally{S.f()}}y&&y.sender?y.sender.replaceTrack(s.getVideoTracks()[0]):u.pc.addTrack(s.getVideoTracks()[0],s)}else a.log((r.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]),u.pc.addTrack(s.getVideoTracks()[0],s)}else u.myStream=s,l=!0;if(!u.pc){var E={iceServers:d,iceTransportPolicy:p,bundlePolicy:f};"chrome"===a.webRTCAdapter.browserDetails.browser&&(E.sdpSemantics=a.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var T={optional:[{DtlsSrtpKeyAgreement:!0}]};if(h&&T.optional.push({googIPv6:!0}),o.rtcConstraints&&"object"===i(o.rtcConstraints))for(var P in a.debug("Adding custom PeerConnection constraints:",o.rtcConstraints),o.rtcConstraints)T.optional.push(o.rtcConstraints[P]);"edge"===a.webRTCAdapter.browserDetails.browser&&(E.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(o.senderTransforms||o.receiverTransforms)&&(u.senderTransforms=o.senderTransforms,u.receiverTransforms=o.receiverTransforms,E.forceEncodedAudioInsertableStreams=!0,E.forceEncodedVideoInsertableStreams=!0,E.encodedInsertableStreams=!0),a.log("Creating PeerConnection"),a.debug(T),u.pc=new RTCPeerConnection(E,T),a.debug(u.pc),u.pc.getStats&&(u.volume={},u.bitrate.value="0 kbits/sec"),a.log("Preparing local SDP and gathering candidates (trickle="+u.trickle+")"),u.pc.oniceconnectionstatechange=function(e){u.pc&&c.iceState(u.pc.iceConnectionState)},u.pc.onicecandidate=function(t){if(!t.candidate||"edge"===a.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)a.log("End of candidates."),u.iceDone=!0,!0===u.trickle?I(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return void a.warn("Invalid handle, not sending anything");var r=n.webrtcStuff;if(a.log("Sending offer/answer SDP..."),!r.mySdp)return void a.warn("Local SDP instance is invalid, not sending anything...");r.mySdp={type:r.pc.localDescription.type,sdp:r.pc.localDescription.sdp},!1===r.trickle&&(r.mySdp.trickle=!1);a.debug(t),r.sdpSent=!0,t.success(r.mySdp)}(e,o);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===u.trickle&&I(e,n)}},u.pc.ontrack=function(e){if(a.log("Handling Remote Track"),a.debug(e),e.streams&&(u.remoteStream=e.streams[0],c.onremotestream(u.remoteStream),!e.track.onended)){if(u.receiverTransforms){var t=null;RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&u.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&u.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writable))}var n=null;a.log("Adding onended callback to track:",e.track),e.track.onended=function(e){a.log("Remote track removed:",e),u.remoteStream&&(clearTimeout(n),u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream))},e.track.onmute=function(e){a.log("Remote track muted:",e),u.remoteStream&&null==n&&(n=setTimeout((function(){a.log("Removing remote track"),u.remoteStream&&(u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream)),n=null}),2520))},e.track.onunmute=function(e){if(a.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{u.remoteStream.addTrack(e.target),c.onremotestream(u.remoteStream)}catch(e){a.error(e)}}}}}if(l&&s){a.log("Adding local stream");var A=!0===o.simulcast2;s.getTracks().forEach((function(e){a.log("Adding local track:",e);var t=null;if(A&&"audio"!==e.kind){a.log("Enabling rid-based simulcasting:",e);var n=w(o.simulcastMaxBitrates),r=u.pc.addTransceiver(e,{direction:"sendrecv",streams:[s],sendEncodings:o.sendEncodings||[{rid:"h",active:!0,maxBitrate:n.high},{rid:"m",active:!0,maxBitrate:n.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:n.low,scaleResolutionDownBy:4}]});r&&(t=r.sender)}else t=u.pc.addTrack(e,s);if(t&&u.senderTransforms){var i=null;RTCRtpSender.prototype.createEncodedStreams?i=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&u.senderTransforms.audio?i=t.createEncodedAudioStreams():"video"===t.track.kind&&u.senderTransforms.video&&(i=t.createEncodedVideoStreams())),i&&(console.log(i),i.readableStream&&i.writableStream?i.readableStream.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(i.writableStream):i.readable&&i.writable&&i.readable.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(i.writable))}}))}(function(e){if(a.debug("isDataEnabled:",e),"edge"===a.webRTCAdapter.browserDetails.browser)return a.warn("Edge doesn't support data channels yet"),!1;return null!=e&&!0===e.data})(r)&&!u.dataChannel[a.dataChanDefaultLabel]&&(a.log("Creating default data channel"),D(e,a.dataChanDefaultLabel,null,!1),u.pc.ondatachannel=function(t){a.log("Data channel created by Janus:",t),D(e,t.channel.label,t.channel.protocol,t.channel)}),u.myStream&&c.onlocalstream(u.myStream),t?u.pc.setRemoteDescription(t).then((function(){if(a.log("Remote description accepted!"),u.remoteSdp=t.sdp,u.candidates&&u.candidates.length>0){for(var i=0;i<u.candidates.length;i++){var s=u.candidates[i];a.debug("Adding remote candidate:",s),s&&!0!==s.completed?u.pc.addIceCandidate(s):u.pc.addIceCandidate(a.endOfCandidates)}u.candidates=[]}!function(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:a.noop;var i=C[e];if(!i||!i.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff,s=!0===r.simulcast;s?a.log("Creating answer (iceDone="+o.iceDone+", simulcast="+s+")"):a.log("Creating answer (iceDone="+o.iceDone+")");var c=null;if(a.unifiedPlan){c={};var u=null,l=null,d=o.pc.getTransceivers();if(d&&d.length>0){var p,f=n(d);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind?u||(u=h):(h.sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind)&&(l||(l=h))}}catch(e){f.e(e)}finally{f.f()}}var m=H(t),g=J(t);if(m||g){if(m&&g){if(u)try{u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)}catch(e){a.error(e)}}else if(m&&!g)try{u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u))}catch(e){a.error(e)}else if(!m&&g)if(u)try{u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)}catch(e){a.error(e)}else u=o.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u)}else if(t.removeAudio&&u)try{u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u)}catch(e){a.error(e)}var _=X(t),v=Y(t);if(_||v){if(_&&v){if(l)try{l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)}catch(e){a.error(e)}}else if(_&&!v){if(l)try{l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)}catch(e){a.error(e)}}else if(!_&&v)if(l)try{l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)}catch(e){a.error(e)}else l=o.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l)}else if(t.removeVideo&&l)try{l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l)}catch(e){a.error(e)}}else c="firefox"===a.webRTCAdapter.browserDetails.browser||"edge"===a.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:J(t),offerToReceiveVideo:Y(t)}:{mandatory:{OfferToReceiveAudio:J(t),OfferToReceiveVideo:Y(t)}};a.debug(c);var y=X(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=o.pc.getSenders()[1];a.log(b);var S=b.getParameters();a.log(S);var k=w(r.simulcastMaxBitrates);b.setParameters({encodings:r.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}]})}o.pc.createAnswer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser?a.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp={type:"answer",sdp:e.sdp},o.pc.setLocalDescription(e).catch(r.error),o.mediaConstraints=c,o.iceDone||o.trickle?((o.senderTransforms||o.receiverTransforms)&&(e.e2ee=!0),r.success(e)):a.log("Waiting for all candidates...")}),r.error)}(e,r,o)}),o.error):function(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:a.noop;var i=C[e];if(!i||!i.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var o=i.webrtcStuff,s=!0===r.simulcast;s?a.log("Creating offer (iceDone="+o.iceDone+", simulcast="+s+")"):a.log("Creating offer (iceDone="+o.iceDone+")");var c={};if(a.unifiedPlan){var u=null,l=null,d=o.pc.getTransceivers();if(d&&d.length>0){var p,f=n(d);try{for(f.s();!(p=f.n()).done;){var h=p.value;h.sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind?u||(u=h):(h.sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind)&&(l||(l=h))}}catch(e){f.e(e)}finally{f.f()}}var m=H(t),g=J(t);m||g?m&&g?u&&(u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)):m&&!g?u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u)):!m&&g&&(u?(u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)):(u=o.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u))):t.removeAudio&&u&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u));var _=X(t),v=Y(t);_||v?_&&v?l&&(l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)):_&&!v?l&&(l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)):!_&&v&&(l?(l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)):(l=o.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l))):t.removeVideo&&l&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l))}else c.offerToReceiveAudio=J(t),c.offerToReceiveVideo=Y(t);!0===r.iceRestart&&(c.iceRestart=!0);a.debug(c);var y=X(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=o.pc.getSenders().find((function(e){return"video"===e.track.kind}));if(b){var S=b.getParameters();S||(S={});var k=w(r.simulcastMaxBitrates);S.encodings=r.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}],b.setParameters(S)}}o.pc.createOffer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser||"safari"===a.webRTCAdapter.browserDetails.browser?(a.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t=e.split("\r\n"),n=!1,r=[-1],i=[-1],o=null,s=null,c=null,u=null,l=-1,d=0;d<t.length;d++){if(f=t[d].match(/m=(\w+) */)){if("video"===f[1]){if(!(r[0]<0)){l=d;break}n=!0}else if(r[0]>-1){l=d;break}}else if(n){if(t[d].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/))return a.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var p=t[d].match(/a=ssrc-group:FID (\d+) (\d+)/);if(p)r[0]=p[1],i[0]=p[2],t.splice(d,1),d--;else{if(r[0]){if((m=t[d].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(o=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(s=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(c=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" label:(.+)"))&&(u=m[1]),0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}}0!=t[d].length||(t.splice(d,1),d--)}}}if(r[0]<0){l=-1,n=!1;for(d=0;d<t.length;d++){var f;if(f=t[d].match(/m=(\w+) */)){if("video"===f[1]){if(!(r[0]<0)){l=d;break}n=!0}else if(r[0]>-1){l=d;break}}else if(n){if(r[0]<0){var h=t[d].match(/a=ssrc:(\d+)/);if(h){r[0]=h[1],t.splice(d,1),d--;continue}}else{var m;if((m=t[d].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(o=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(s=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(c=m[1]),(m=t[d].match("a=ssrc:"+r[0]+" label:(.+)"))&&(u=m[1]),0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}}0!==t[d].length||(t.splice(d,1),d--)}}}if(r[0]<0)return a.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length);r[1]=Math.floor(4294967295*Math.random()),r[2]=Math.floor(4294967295*Math.random()),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random());for(d=0;d<r.length;d++)o&&(t.splice(l,0,"a=ssrc:"+r[d]+" cname:"+o),l++),s&&(t.splice(l,0,"a=ssrc:"+r[d]+" msid:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+r[d]+" mslabel:"+c),l++),u&&(t.splice(l,0,"a=ssrc:"+r[d]+" label:"+u),l++),o&&(t.splice(l,0,"a=ssrc:"+i[d]+" cname:"+o),l++),s&&(t.splice(l,0,"a=ssrc:"+i[d]+" msid:"+s),l++),c&&(t.splice(l,0,"a=ssrc:"+i[d]+" mslabel:"+c),l++),u&&(t.splice(l,0,"a=ssrc:"+i[d]+" label:"+u),l++);t.splice(l,0,"a=ssrc-group:FID "+r[2]+" "+i[2]),t.splice(l,0,"a=ssrc-group:FID "+r[1]+" "+i[1]),t.splice(l,0,"a=ssrc-group:FID "+r[0]+" "+i[0]),t.splice(l,0,"a=ssrc-group:SIM "+r[0]+" "+r[1]+" "+r[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n");return e}(e.sdp)):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),o.mySdp={type:"offer",sdp:e.sdp},o.pc.setLocalDescription(e).catch(r.error),o.mediaConstraints=c,o.iceDone||o.trickle?((o.senderTransforms||o.receiverTransforms)&&(e.e2ee=!0),r.success(e)):a.log("Waiting for all candidates...")}),r.error)}(e,r,o)}function F(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:W;var o=r.jsep;if(t&&o)return a.error("Provided a JSEP to a createOffer"),void r.error("Provided a JSEP to a createOffer");if(!(t||o&&o.type&&o.sdp))return a.error("A valid JSEP is required for createAnswer"),void r.error("A valid JSEP is required for createAnswer");r.media="object"===i(r.media)&&r.media?r.media:{audio:!0,video:!0};var s=r.media,c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var u,l=c.webrtcStuff;if(l.trickle=(u=r.trickle,a.debug("isTrickleEnabled:",u),!1!==u),l.pc){if(a.log("Updating existing media session"),s.update=!0,r.stream)r.stream!==l.myStream&&a.log("Renegotiation involves a new external stream");else{if(s.addAudio){if(s.keepAudio=!1,s.replaceAudio=!1,s.removeAudio=!1,s.audioSend=!0,l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length)return a.error("Can't add audio stream, there already is one"),void r.error("Can't add audio stream, there already is one")}else s.removeAudio?(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!1,s.audioSend=!1):s.replaceAudio&&(s.keepAudio=!1,s.addAudio=!1,s.removeAudio=!1,s.audioSend=!0);if(l.myStream&&l.myStream.getAudioTracks()&&0!==l.myStream.getAudioTracks().length?!H(s)||s.removeAudio||s.replaceAudio||(s.keepAudio=!0):(s.replaceAudio&&(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!0,s.audioSend=!0),H(s)&&(s.keepAudio=!1,s.addAudio=!0)),s.addVideo){if(s.keepVideo=!1,s.replaceVideo=!1,s.removeVideo=!1,s.videoSend=!0,l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length)return a.error("Can't add video stream, there already is one"),void r.error("Can't add video stream, there already is one")}else s.removeVideo?(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!1,s.videoSend=!1):s.replaceVideo&&(s.keepVideo=!1,s.addVideo=!1,s.removeVideo=!1,s.videoSend=!0);l.myStream&&l.myStream.getVideoTracks()&&0!==l.myStream.getVideoTracks().length?!X(s)||s.removeVideo||s.replaceVideo||(s.keepVideo=!0):(s.replaceVideo&&(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!0,s.videoSend=!0),X(s)&&(s.keepVideo=!1,s.addVideo=!0)),s.addData&&(s.data=!0)}if(H(s)&&s.keepAudio&&X(s)&&s.keepVideo)return c.consentDialog(!1),void j(e,o,s,r,l.myStream)}else s.update=!1,s.keepAudio=!1,s.keepVideo=!1;if(s.update&&!l.streamExternal){if(s.removeAudio||s.replaceAudio){if(l.myStream&&l.myStream.getAudioTracks()&&l.myStream.getAudioTracks().length){var d=l.myStream.getAudioTracks()[0];a.log("Removing audio track:",d),l.myStream.removeTrack(d);try{d.stop()}catch(e){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var p=!0;if(s.replaceAudio&&a.unifiedPlan&&(p=!1),p){var f,h=n(l.pc.getSenders());try{for(h.s();!(f=h.n()).done;){var m=f.value;m&&m.track&&"audio"===m.track.kind&&(a.log("Removing audio sender:",m),l.pc.removeTrack(m))}}catch(e){h.e(e)}finally{h.f()}}}}if(s.removeVideo||s.replaceVideo){if(l.myStream&&l.myStream.getVideoTracks()&&l.myStream.getVideoTracks().length){var g=l.myStream.getVideoTracks()[0];a.log("Removing video track:",g),l.myStream.removeTrack(g);try{g.stop()}catch(e){}}if(l.pc.getSenders()&&l.pc.getSenders().length){var _=!0;if(s.replaceVideo&&a.unifiedPlan&&(_=!1),_){var v,y=n(l.pc.getSenders());try{for(y.s();!(v=y.n()).done;){var b=v.value;b&&b.track&&"video"===b.track.kind&&(a.log("Removing video sender:",b),l.pc.removeTrack(b))}}catch(e){y.e(e)}finally{y.f()}}}}}if(r.stream){var w=r.stream;return a.log("MediaStream provided by the application"),a.debug(w),s.update&&l.myStream&&l.myStream!==r.stream&&!l.streamExternal&&(a.stopAllTracks(l.myStream),l.myStream=null),l.streamExternal=!0,c.consentDialog(!1),void j(e,o,s,r,w)}if(H(s)||X(s)){if(!a.isGetUserMediaAvailable())return void r.error("getUserMedia not available");var S={mandatory:{},optional:[]};c.consentDialog(!0);var k=H(s);k&&s&&"object"===i(s.audio)&&(k=s.audio);var E=X(s);if(E&&s){var T=!0===r.simulcast,P=!0===r.simulcast2;if(!T&&!P||o||s.video||(s.video="hires"),s.video&&"screen"!=s.video&&"window"!=s.video)if("object"===i(s.video))E=s.video;else{var A=0,R=0;"lowres"===s.video?(R=240,A=320):"lowres-16:9"===s.video?(R=180,A=320):"hires"===s.video||"hires-16:9"===s.video||"hdres"===s.video?(R=720,A=1280):"fhdres"===s.video?(R=1080,A=1920):"4kres"===s.video?(R=2160,A=3840):"stdres"===s.video?(R=480,A=640):"stdres-16:9"===s.video?(R=360,A=640):(a.log("Default video setting is stdres 4:3"),R=480,A=640),a.log("Adding media constraint:",s.video),E={height:{ideal:R},width:{ideal:A}},a.log("Adding video constraint:",E)}else if("screen"===s.video||"window"===s.video){var O=function(t,n){c.consentDialog(!1),t?r.error(t):j(e,o,s,r,n)},x=function(e,t,n){a.log("Adding media constraint (screen capture)"),a.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){c.consentDialog(!1),t(e)}))};if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return S.video={},s.screenshareFrameRate&&(S.video.frameRate=s.screenshareFrameRate),s.screenshareHeight&&(S.video.height=s.screenshareHeight),s.screenshareWidth&&(S.video.width=s.screenshareWidth),S.audio=s.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(S).then((function(t){c.consentDialog(!1),H(s)&&!s.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){t.addTrack(n.getAudioTracks()[0]),j(e,o,s,r,t)})):j(e,o,s,r,t)}),(function(e){c.consentDialog(!1),r.error(e)}));if("chrome"===a.webRTCAdapter.browserDetails.browser){var M=a.webRTCAdapter.browserDetails.version,I=33;window.navigator.userAgent.match("Linux")&&(I=35),M>=26&&M<=I?(S={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate,chromeMediaSource:"screen"}},audio:H(s)&&!s.keepAudio},x(S,O)):a.extension.getScreen((function(e,t){if(e)return c.consentDialog(!1),r.error(e);(S={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,x(S,O,H(s)&&!s.keepAudio)}))}else if("firefox"===a.webRTCAdapter.browserDetails.browser){if(!(a.webRTCAdapter.browserDetails.version>=33)){var D=new Error("NavigatorUserMediaError");return D.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",c.consentDialog(!1),void r.error(D)}S={video:{mozMediaSource:s.video,mediaSource:s.video},audio:H(s)&&!s.keepAudio},x(S,(function(e,t){if(O(e,t),!e)var n=t.currentTime,r=window.setInterval((function(){t||window.clearInterval(r),t.currentTime==n&&(window.clearInterval(r),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}s&&"screen"===s.video||navigator.mediaDevices.enumerateDevices().then((function(t){var n=t.some((function(e){return"audioinput"===e.kind})),u=function(e){if(a.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==i(e.video)||"object"!==i(e.video.mandatory))return!1;var t=e.video.mandatory;if(t.chromeMediaSource)return"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource;if(t.mozMediaSource)return"window"===t.mozMediaSource||"screen"===t.mozMediaSource;if(t.mediaSource)return"window"===t.mediaSource||"screen"===t.mediaSource;return!1}(s)||t.some((function(e){return"videoinput"===e.kind})),l=H(s),d=X(s),p=function(e){return a.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(s),f=function(e){return a.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(s);if(l||d||p||f){var h=!!l&&n,m=!!d&&u;if(!h&&!m)return c.consentDialog(!1),r.error("No capture device found"),!1;if(!h&&p)return c.consentDialog(!1),r.error("Audio capture is required, but no capture device found"),!1;if(!m&&f)return c.consentDialog(!1),r.error("Video capture is required, but no capture device found"),!1}var g={audio:!(!n||s.keepAudio)&&k,video:!(!u||s.keepVideo)&&E};a.debug("getUserMedia constraints",g),g.audio||g.video?navigator.mediaDevices.getUserMedia(g).then((function(t){c.consentDialog(!1),j(e,o,s,r,t)})).catch((function(e){c.consentDialog(!1),r.error({code:e.code,name:e.name,message:e.message})})):(c.consentDialog(!1),j(e,o,s,r,w))})).catch((function(e){c.consentDialog(!1),r.error(e)}))}else j(e,o,s,r)}function N(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:W;var n=t.jsep,r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var i=r.webrtcStuff;if(n){if(!i.pc)return a.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");i.pc.setRemoteDescription(n).then((function(){if(a.log("Remote description accepted!"),i.remoteSdp=n.sdp,i.candidates&&i.candidates.length>0){for(var e=0;e<i.candidates.length;e++){var r=i.candidates[e];a.debug("Adding remote candidate:",r),r&&!0!==r.completed?i.pc.addIceCandidate(r):i.pc.addIceCandidate(a.endOfCandidates)}i.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function $(e,t){var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),0;var r=t?"remote":"local",i=n.webrtcStuff;return i.volume[r]||(i.volume[r]={value:0}),!i.pc.getStats||"chrome"!==a.webRTCAdapter.browserDetails.browser&&"safari"!==a.webRTCAdapter.browserDetails.browser?(a.warn("Getting the "+r+" volume unsupported by browser"),0):t&&!i.remoteStream?(a.warn("Remote stream unavailable"),0):t||i.myStream?i.volume[r].timer?i.volume[r].value:(a.log("Starting "+r+" volume monitor"),i.volume[r].timer=setInterval((function(){i.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(i.volume[r].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(a.warn("Local stream unavailable"),0)}function q(e,t){var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),!0;var r=n.webrtcStuff;return r.pc?r.myStream?t?r.myStream.getVideoTracks()&&0!==r.myStream.getVideoTracks().length?!r.myStream.getVideoTracks()[0].enabled:(a.warn("No video track"),!0):r.myStream.getAudioTracks()&&0!==r.myStream.getAudioTracks().length?!r.myStream.getAudioTracks()[0].enabled:(a.warn("No audio track"),!0):(a.warn("Invalid local MediaStream"),!0):(a.warn("Invalid PeerConnection"),!0)}function G(e,t,n){var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),!1;var i=r.webrtcStuff;return i.pc?i.myStream?t?i.myStream.getVideoTracks()&&0!==i.myStream.getVideoTracks().length?(i.myStream.getVideoTracks()[0].enabled=!n,!0):(a.warn("No video track"),!1):i.myStream.getAudioTracks()&&0!==i.myStream.getAudioTracks().length?(i.myStream.getAudioTracks()[0].enabled=!n,!0):(a.warn("No audio track"),!1):(a.warn("Invalid local MediaStream"),!1):(a.warn("Invalid PeerConnection"),!1)}function V(e){var t=C[e];if(!t||!t.webrtcStuff)return a.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return n.pc?n.pc.getStats?n.bitrate.timer?n.bitrate.value:(a.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var r=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"===a.webRTCAdapter.browserDetails.browser&&(r/=1e3);var i=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/r);"safari"===a.webRTCAdapter.browserDetails.browser&&(i=parseInt(i/1e3)),n.bitrate.value=i+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(a.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function W(e){a.error("WebRTC error:",e)}function z(e,n){a.log("Cleaning WebRTC stuff");var i=C[e];if(i){var o=i.webrtcStuff;if(o){if(!0===n){var s={janus:"hangup",transaction:a.randomString(12)};i.token&&(s.token=i.token),v&&(s.apisecret=v),a.debug("Sending hangup request (handle="+e+"):"),a.debug(s),t?(s.session_id=k,s.handle_id=e,r.send(JSON.stringify(s))):a.httpAPICall(l+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:s})}o.remoteStream=null,o.volume&&(o.volume.local&&o.volume.local.timer&&clearInterval(o.volume.local.timer),o.volume.remote&&o.volume.remote.timer&&clearInterval(o.volume.remote.timer)),o.volume={},o.bitrate.timer&&clearInterval(o.bitrate.timer),o.bitrate.timer=null,o.bitrate.bsnow=null,o.bitrate.bsbefore=null,o.bitrate.tsnow=null,o.bitrate.tsbefore=null,o.bitrate.value=null,!o.streamExternal&&o.myStream&&(a.log("Stopping local stream tracks"),a.stopAllTracks(o.myStream)),o.streamExternal=!1,o.myStream=null;try{o.pc.close()}catch(e){}o.pc=null,o.candidates=null,o.mySdp=null,o.remoteSdp=null,o.iceDone=!1,o.dataChannel={},o.dtmfSender=null,o.senderTransforms=null,o.receiverTransforms=null}i.oncleanup()}}function H(e){return a.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function J(e){return a.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function X(e){return a.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function Y(e){return a.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}x(e),this.getServer=function(){return l},this.isConnected=function(){return S},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.reconnect=!0,x(e)},this.getSessionId=function(){return k},this.getInfo=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,a.log("Getting info on Janus instance"),!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=a.randomString(12),i={janus:"info",transaction:n};_&&(i.token=_);v&&(i.apisecret=v);if(t)return P[n]=function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},void r.send(JSON.stringify(i));a.httpAPICall(l,{verb:"POST",withCredentials:m,body:i,success:function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,n){a.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)},this.destroy=function(n){!function(n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop;var i=!0===n.unload,c=!0;void 0!==n.notifyDestroyed&&null!==n.notifyDestroyed&&(c=!0===n.notifyDestroyed);var u=!0===n.cleanupHandles;if(a.log("Destroying session "+k+" (unload="+i+")"),!k)return a.warn("No session to destroy"),n.success(),void(c&&e.destroyed());if(u)for(var d in C)L(d,{noRequest:!0});if(!S)return a.warn("Is the server down? (connected=false)"),k=null,void n.success();var p={janus:"destroy",transaction:a.randomString(12)};_&&(p.token=_);v&&(p.apisecret=v);if(i)return t?(r.onclose=null,r.close(),r=null):navigator.sendBeacon(l+"/"+k,JSON.stringify(p)),a.log("Destroyed session:"),k=null,S=!1,n.success(),void(c&&e.destroyed());if(t){p.session_id=k;var f=function(){for(var e in o)r.removeEventListener(e,o[e]);r.removeEventListener("message",h),r.removeEventListener("error",g),s&&clearTimeout(s),r.close()},h=function(t){var r=JSON.parse(t.data);r.session_id==p.session_id&&r.transaction==p.transaction&&(f(),n.success(),c&&e.destroyed())},g=function(t){f(),n.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return r.addEventListener("message",h),r.addEventListener("error",g),void(1===r.readyState?r.send(JSON.stringify(p)):g())}a.httpAPICall(l+"/"+k,{verb:"POST",withCredentials:m,body:p,success:function(t){a.log("Destroyed session:"),a.debug(t),k=null,S=!1,"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),n.success(),c&&e.destroyed()},error:function(t,r){a.error(t+":",r),k=null,S=!1,n.success(),c&&e.destroyed()}})}(n)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:a.noop,e.iceState="function"==typeof e.iceState?e.iceState:a.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:a.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:a.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:a.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:a.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:a.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:a.noop,e.ondata="function"==typeof e.ondata?e.ondata:a.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:a.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:a.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=e.plugin;if(!n)return a.error("Invalid plugin"),void e.error("Invalid plugin");var i=e.opaqueId,o=e.token?e.token:_,s=a.randomString(12),c={janus:"attach",plugin:n,opaque_id:i,transaction:s};o&&(c.token=o);v&&(c.apisecret=v);if(t)return P[s]=function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var r=t.data.id;a.log("Created handle: "+r);var i={session:E,plugin:n,id:r,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(){return $(r,!0)},getRemoteVolume:function(){return $(r,!0)},getLocalVolume:function(){return $(r,!1)},isAudioMuted:function(){return q(r,!1)},muteAudio:function(){return G(r,!1,!0)},unmuteAudio:function(){return G(r,!1,!1)},isVideoMuted:function(){return q(r,!0)},muteVideo:function(){return G(r,!0,!0)},unmuteVideo:function(){return G(r,!0,!1)},getBitrate:function(){return V(r)},send:function(e){M(r,e)},data:function(e){B(r,e)},dtmf:function(e){U(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(r,!0,e)},createAnswer:function(e){F(r,!1,e)},handleRemoteJsep:function(e){N(r,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){z(r,!0===e)},detach:function(e){L(r,e)}};C[r]=i,e.success(i)},c.session_id=k,void r.send(JSON.stringify(c));a.httpAPICall(l+"/"+k,{verb:"POST",withCredentials:m,body:c,success:function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var r=t.data.id;a.log("Created handle: "+r);var i={session:E,plugin:n,id:r,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(){return $(r,!0)},getRemoteVolume:function(){return $(r,!0)},getLocalVolume:function(){return $(r,!1)},isAudioMuted:function(){return q(r,!1)},muteAudio:function(){return G(r,!1,!0)},unmuteAudio:function(){return G(r,!1,!1)},isVideoMuted:function(){return q(r,!0)},muteVideo:function(){return G(r,!0,!0)},unmuteVideo:function(){return G(r,!0,!1)},getBitrate:function(){return V(r)},send:function(e){M(r,e)},data:function(e){B(r,e)},dtmf:function(e){U(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(r,!0,e)},createAnswer:function(e){F(r,!1,e)},handleRemoteJsep:function(e){N(r,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){z(r,!0===e)},detach:function(e){L(r,e)}};C[r]=i,e.success(i)},error:function(t,n){a.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}a.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,r=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new r(e,t)},extension:e&&e.extension||o,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,r){var o={method:r.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===r.verb&&(o.headers["Content-Type"]="application/json"),void 0!==r.withCredentials&&(o.credentials=!0===r.withCredentials?"include":r.withCredentials?r.withCredentials:"omit"),r.body&&(o.body=JSON.stringify(r.body));var s=t(e,o).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(r.timeout){var c=new n((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:r.timeout})}),r.timeout)}));s=n.race([s,c])}return s.then((function(e){return e.ok?i(r.success)===i(a.noop)?e.json().then((function(e){r.success(e)})).catch((function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){i(r.error)===i(a.noop)&&r.error(e.message||"<< internal error >>",e)})),s}}},a.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||o,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,n){var r=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},o=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(r,o,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){i(n.success)===i(a.noop)&&n.success(e)},error:function(e,t,r){i(n.error)===i(a.noop)&&n.error(t,r)}}))}}},a.noop=function(){},a.dataChanDefaultLabel="JanusDataChannel",a.endOfCandidates=null,a.stopAllTracks=function(e){try{var t,r=n(e.getTracks());try{for(r.s();!(t=r.n()).done;){var i=t.value;a.log(i),i&&i.stop()}}catch(e){r.e(e)}finally{r.f()}}catch(e){}},a.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:a.noop,a.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),a.trace=a.noop,a.debug=a.noop,a.vdebug=a.noop,a.log=a.noop,a.warn=a.noop,a.error=a.noop,!0===e.debug||"all"===e.debug)a.trace=console.trace.bind(console),a.debug=console.debug.bind(console),a.vdebug=console.debug.bind(console),a.log=console.log.bind(console),a.warn=console.warn.bind(console),a.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,r=n(e.debug);try{for(r.s();!(t=r.n()).done;){var i=t.value;switch(i){case"trace":a.trace=console.trace.bind(console);break;case"debug":a.debug=console.debug.bind(console);break;case"vdebug":a.vdebug=console.debug.bind(console);break;case"log":a.log=console.log.bind(console);break;case"warn":a.warn=console.warn.bind(console);break;case"error":a.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+i+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}}catch(e){r.e(e)}finally{r.f()}}a.log("Initializing library");var o=e.dependencies||a.useDefaultDependencies();a.isArray=o.isArray,a.webRTCAdapter=o.webRTCAdapter,a.httpAPICall=o.httpAPICall,a.newWebSocket=o.newWebSocket,a.extension=o.extension,a.extension.init(),a.listDevices=function(e,t){e="function"==typeof e?e:a.noop,null==t&&(t={audio:!0,video:!0}),a.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){a.debug(n),e(n),a.stopAllTracks(t)}))})).catch((function(t){a.error(t),e([])})):(a.warn("navigator.mediaDevices unavailable"),e([]))},a.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(e){a.error("Error attaching stream to element")}}},a.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(e){a.error("Error reattaching stream to element")}}};var s=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",c=window["on"+s];if(window.addEventListener(s,(function(e){for(var t in a.log("Closing window"),a.sessions)a.sessions[t]&&a.sessions[t].destroyOnUnload&&(a.log("Destroying session "+t),a.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));c&&"function"==typeof c&&c()})),a.safariVp8=!1,"safari"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var u,l=n(RTCRtpSender.getCapabilities("video").codecs);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(d&&d.mimeType&&"video/vp8"===d.mimeType.toLowerCase()){a.safariVp8=!0;break}}}catch(e){l.e(e)}finally{l.f()}a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var p=new RTCPeerConnection({});p.createOffer({offerToReceiveVideo:!0}).then((function(e){a.safariVp8=-1!==e.sdp.indexOf("VP8"),a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),p.close(),p=null}))}if(a.unifiedPlan=!1,"firefox"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=59)a.unifiedPlan=!0;else if("chrome"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=72)a.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var f=new RTCPeerConnection;try{f.addTransceiver("audio"),a.unifiedPlan=!0}catch(e){}f.close()}else a.unifiedPlan=!1;a.initDone=!0,e.callback()}},a.isWebrtcSupported=function(){return!!window.RTCPeerConnection},a.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},a.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n},e.exports=a},function(e,t,n){"use strict";var r=n(31),i=n(93),o=Object.prototype.toString;function a(e){return"[object Array]"===o.call(e)}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){var r=n(110),i=n(111),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){var r,i,o,a,s,c,u,l;e.exports=(l=n(0),n(15),n(16),i=(r=l).lib,o=i.Base,a=i.WordArray,s=r.algo,c=s.MD5,u=s.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),i=a.create(),o=i.words,s=n.keySize,c=n.iterations;o.length<s;){u&&r.update(u);var u=r.update(e).finalize(t);r.reset();for(var l=1;l<c;l++)u=r.finalize(u),r.reset();i.concat(u)}return i.sigBytes=4*s,i}}),r.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)},l.EvpKDF)},function(e,t,n){var r,i,o;e.exports=(o=n(0),i=(r=o).lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<n;s++)i.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var r=[],o=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,c=n[e.charCodeAt(a)]>>>6-a%4*2;r[o>>>2]|=(s|c)<<24-o%4*8,o++}return i.create(r,o)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)},function(e,t,n){var r;e.exports=(r=n(0),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o=this._hash.words,a=e[t+0],c=e[t+1],f=e[t+2],h=e[t+3],m=e[t+4],g=e[t+5],_=e[t+6],v=e[t+7],y=e[t+8],b=e[t+9],w=e[t+10],S=e[t+11],k=e[t+12],C=e[t+13],E=e[t+14],T=e[t+15],P=o[0],A=o[1],R=o[2],O=o[3];P=u(P,A,R,O,a,7,s[0]),O=u(O,P,A,R,c,12,s[1]),R=u(R,O,P,A,f,17,s[2]),A=u(A,R,O,P,h,22,s[3]),P=u(P,A,R,O,m,7,s[4]),O=u(O,P,A,R,g,12,s[5]),R=u(R,O,P,A,_,17,s[6]),A=u(A,R,O,P,v,22,s[7]),P=u(P,A,R,O,y,7,s[8]),O=u(O,P,A,R,b,12,s[9]),R=u(R,O,P,A,w,17,s[10]),A=u(A,R,O,P,S,22,s[11]),P=u(P,A,R,O,k,7,s[12]),O=u(O,P,A,R,C,12,s[13]),R=u(R,O,P,A,E,17,s[14]),P=l(P,A=u(A,R,O,P,T,22,s[15]),R,O,c,5,s[16]),O=l(O,P,A,R,_,9,s[17]),R=l(R,O,P,A,S,14,s[18]),A=l(A,R,O,P,a,20,s[19]),P=l(P,A,R,O,g,5,s[20]),O=l(O,P,A,R,w,9,s[21]),R=l(R,O,P,A,T,14,s[22]),A=l(A,R,O,P,m,20,s[23]),P=l(P,A,R,O,b,5,s[24]),O=l(O,P,A,R,E,9,s[25]),R=l(R,O,P,A,h,14,s[26]),A=l(A,R,O,P,y,20,s[27]),P=l(P,A,R,O,C,5,s[28]),O=l(O,P,A,R,f,9,s[29]),R=l(R,O,P,A,v,14,s[30]),P=d(P,A=l(A,R,O,P,k,20,s[31]),R,O,g,4,s[32]),O=d(O,P,A,R,y,11,s[33]),R=d(R,O,P,A,S,16,s[34]),A=d(A,R,O,P,E,23,s[35]),P=d(P,A,R,O,c,4,s[36]),O=d(O,P,A,R,m,11,s[37]),R=d(R,O,P,A,v,16,s[38]),A=d(A,R,O,P,w,23,s[39]),P=d(P,A,R,O,C,4,s[40]),O=d(O,P,A,R,a,11,s[41]),R=d(R,O,P,A,h,16,s[42]),A=d(A,R,O,P,_,23,s[43]),P=d(P,A,R,O,b,4,s[44]),O=d(O,P,A,R,k,11,s[45]),R=d(R,O,P,A,T,16,s[46]),P=p(P,A=d(A,R,O,P,f,23,s[47]),R,O,a,6,s[48]),O=p(O,P,A,R,v,10,s[49]),R=p(R,O,P,A,E,15,s[50]),A=p(A,R,O,P,g,21,s[51]),P=p(P,A,R,O,k,6,s[52]),O=p(O,P,A,R,h,10,s[53]),R=p(R,O,P,A,w,15,s[54]),A=p(A,R,O,P,c,21,s[55]),P=p(P,A,R,O,y,6,s[56]),O=p(O,P,A,R,T,10,s[57]),R=p(R,O,P,A,_,15,s[58]),A=p(A,R,O,P,C,21,s[59]),P=p(P,A,R,O,m,6,s[60]),O=p(O,P,A,R,S,10,s[61]),R=p(R,O,P,A,f,15,s[62]),A=p(A,R,O,P,b,21,s[63]),o[0]=o[0]+P|0,o[1]=o[1]+A|0,o[2]=o[2]+R|0,o[3]=o[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296),a=r;n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,r,i,o,a){var s=e+(t&n|~t&r)+i+a;return(s<<o|s>>>32-o)+t}function l(e,t,n,r,i,o,a){var s=e+(t&r|n&~r)+i+a;return(s<<o|s>>>32-o)+t}function d(e,t,n,r,i,o,a){var s=e+(t^n^r)+i+a;return(s<<o|s>>>32-o)+t}function p(e,t,n,r,i,o,a){var s=e+(n^(t|~r))+i+a;return(s<<o|s>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),r.MD5)},function(e,t,n){var r,i=n(123),o=n(44),a=n(125),s=n(126),c=n(127);"undefined"!=typeof ArrayBuffer&&(r=n(128));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=u||l;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=i(p),h={type:"error",data:"parser error"},m=n(129);function g(e,t,n){for(var r=new Array(e.length),i=s(e.length,n),o=function(e,n,i){t(n,(function(t,n){r[e]=n,i(t,r)}))},a=0;a<e.length;a++)o(a,e[a],i)}t.encodePacket=function(e,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var o=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=p[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return r(a.buffer)}(e,n,i);if(void 0!==m&&o instanceof m)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(d)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var i=new Uint8Array(1);i[0]=p[e.type];var o=new m([i.buffer,e.data]);return r(o)}(e,n,i);if(o&&o.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,i);var a=p[e.type];return void 0!==e.data&&(a+=r?c.encode(String(e.data),{strict:!1}):String(e.data)),i(""+a)},t.encodeBase64Packet=function(e,n){var r,i="b"+t.packets[e.type];if(void 0!==m&&e.data instanceof m){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return i+=btoa(r),n(i)},t.decodePacket=function(e,n,r){if(void 0===e)return h;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return h;var i=e.charAt(0);return Number(i)==i&&f[i]?e.length>1?{type:f[i],data:e.substring(1)}:{type:f[i]}:h}i=new Uint8Array(e)[0];var o=a(e,1);return m&&"blob"===n&&(o=new m([o])),{type:f[i],data:o}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&m&&(i=new m([i])),{type:n,data:i}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=o(e);if(n&&i)return m&&!d?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");g(e,(function(e,r){t.encodePacket(e,!!i&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(h,0,1);for(var o,a,s="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(o=Number(s)))return r(h,0,1);if(s!=(a=e.substr(c+1,o)).length)return r(h,0,1);if(a.length){if(i=t.decodePacket(a,n,!1),h.type===i.type&&h.data===i.data)return r(h,0,1);if(!1===r(i,c+o,u))return}c+=o,s=""}else s+=l}return""!==s?r(h,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}i[o++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)i[o++]=parseInt(s[a]);i[o++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)i[o++]=r[a]})),n(i.buffer)}))},t.encodePayloadAsBlob=function(e,n){g(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)a[i]=parseInt(o[i]);if(a[o.length]=255,m){var s=new m([t.buffer,a.buffer,e]);n(null,s)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var s=new Uint8Array(i),c=0===s[0],u="",l=1;255!==s[l];l++){if(u.length>310)return r(h,0,1);u+=s[l]}i=a(i,2+u.length),u=parseInt(u);var d=a(i,0,u);if(c)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var p=new Uint8Array(d);d="";for(l=0;l<p.length;l++)d+=String.fromCharCode(p[l])}o.push(d),i=a(i,u)}var f=o.length;o.forEach((function(e,i){r(t.decodePacket(e,n,!0),i,f)}))}},function(e,t,n){e.exports=n(92)},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(114)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(18))},function(e,t,n){var r,i,o,a,s,c;e.exports=(c=n(0),i=(r=c).lib,o=i.Base,a=i.WordArray,(s=r.x64={}).Word=o.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=o.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),c)},function(e,t,n){"use strict";var r,i,o,a=n(84),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function c(){o=!1}function u(e){if(e){if(e!==r){if(e.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+t.join(", "));r=e,c()}}else r!==s&&(r=s,c())}function l(){return o||(o=function(){r||u(s);for(var e,t=r.split(""),n=[],i=a.nextValue();t.length>0;)i=a.nextValue(),e=Math.floor(i*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}e.exports={get:function(){return r||s},characters:function(e){return u(e),r},seed:function(e){a.seed(e),i!==e&&(c(),i=e)},lookup:function(e){return l()[e]},shuffled:l}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(130)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(18))},function(e,t,n){var r,i,o,a,s,c,u,l;e.exports=(l=n(0),i=(r=l).lib,o=i.WordArray,a=i.Hasher,s=r.algo,c=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var d=(r<<5|r>>>27)+s+c[u];d+=u<20?1518500249+(i&o|~i&a):u<40?1859775393+(i^o^a):u<60?(i&o|i&a|o&a)-1894007588:(i^o^a)-899497514,s=a,a=o,o=i<<30|i>>>2,i=r,r=d}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=a._createHelper(u),r.HmacSHA1=a._createHmacHelper(u),l.SHA1)},function(e,t,n){var r,i,o,a;e.exports=(r=n(0),o=(i=r).lib.Base,a=i.enc.Utf8,void(i.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),s=i.words,c=o.words,u=0;u<n;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},function(e,t,n){"use strict";(function(t){var r=n(3),i=n(95),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(e=n(32)),e}(),transformRequest:[function(e,t){return i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){s.headers[e]=r.merge(o)})),e.exports=s}).call(this,n(18))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=s(p);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(10)("socket.io-parser"),i=n(21),o=n(115),a=n(39),s=n(40);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=d;var u=t.ERROR+'"encode error"';function l(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return u;n+=i}return r("encoded %j as %s",e,n),n}function d(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function f(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){o.removeBlobs(e,(function(e){var n=o.deconstructPacket(e),r=l(n.packet),i=n.buffers;i.unshift(r),t(i)}))}(e,n):n([l(e)])},i(d.prototype),d.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return f("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===e.charAt(n+1))for(i.nsp="";++n;){if(","===(c=e.charAt(n)))break;if(i.nsp+=c,n===e.length)break}else i.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(i.id="";++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!(!1!==u&&(i.type===t.ERROR||a(u))))return f("invalid payload");i.data=u}return r("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";(function(e){var r=n(116),i=n(117),o=n(118);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&o(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return N(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var d=!0,p=0;p<c;p++)if(u(e,o+p)!==u(t,p)){d=!1;break}if(d)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return q(N(t,e.length-n),e,n,r)}function w(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return w(e,t,n,r)}function k(e,t,n,r){return q($(t),e,n,r)}function C(e,t,n,r){return q(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(u[d]!==l[d]){o=u[d],a=l[d];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return S(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=F(e[o]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function B(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,o){return o||B(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return o||B(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:N(new c(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function $(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(19))},function(e,t,n){var r=n(121),i=n(24);e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(e,t,n){var r=n(8),i=n(26);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t,n){"use strict";(function(e,r){var i,o=n(56);i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var a=Object(o.a)(i);t.a=a}).call(this,n(19),n(138)(e))},function(e,t,n){var r;e.exports=(r=n(0),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(s[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var u=[],l=a.SHA256=o.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],d=n[6],p=n[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var h=u[f-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,g=u[f-2],_=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[f]=m+u[f-7]+_+u[f-16]}var v=r&i^r&o^i&o,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+c[f]+u[f];p=d,d=l,l=s,s=a+b|0,a=o,o=i,i=r,r=b+(y+v)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),r.SHA256)},function(e,t,n){var r;e.exports=(r=n(0),n(11),function(){var e=r,t=e.lib.Hasher,n=e.x64,i=n.Word,o=n.WordArray,a=e.algo;function s(){return i.create.apply(i,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=s()}();var l=a.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],d=n[6],p=n[7],f=r.high,h=r.low,m=i.high,g=i.low,_=o.high,v=o.low,y=a.high,b=a.low,w=s.high,S=s.low,k=l.high,C=l.low,E=d.high,T=d.low,P=p.high,A=p.low,R=f,O=h,x=m,M=g,I=_,D=v,B=y,U=b,L=w,j=S,F=k,N=C,$=E,q=T,G=P,V=A,W=0;W<80;W++){var z=u[W];if(W<16)var H=z.high=0|e[t+2*W],J=z.low=0|e[t+2*W+1];else{var X=u[W-15],Y=X.high,K=X.low,Q=(Y>>>1|K<<31)^(Y>>>8|K<<24)^Y>>>7,Z=(K>>>1|Y<<31)^(K>>>8|Y<<24)^(K>>>7|Y<<25),ee=u[W-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ie=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),oe=u[W-7],ae=oe.high,se=oe.low,ce=u[W-16],ue=ce.high,le=ce.low;H=(H=(H=Q+ae+((J=Z+se)>>>0<Z>>>0?1:0))+re+((J+=ie)>>>0<ie>>>0?1:0))+ue+((J+=le)>>>0<le>>>0?1:0),z.high=H,z.low=J}var de,pe=L&F^~L&$,fe=j&N^~j&q,he=R&x^R&I^x&I,me=O&M^O&D^M&D,ge=(R>>>28|O<<4)^(R<<30|O>>>2)^(R<<25|O>>>7),_e=(O>>>28|R<<4)^(O<<30|R>>>2)^(O<<25|R>>>7),ve=(L>>>14|j<<18)^(L>>>18|j<<14)^(L<<23|j>>>9),ye=(j>>>14|L<<18)^(j>>>18|L<<14)^(j<<23|L>>>9),be=c[W],we=be.high,Se=be.low,ke=G+ve+((de=V+ye)>>>0<V>>>0?1:0),Ce=_e+me;G=$,V=q,$=F,q=N,F=L,N=j,L=B+(ke=(ke=(ke=ke+pe+((de+=fe)>>>0<fe>>>0?1:0))+we+((de+=Se)>>>0<Se>>>0?1:0))+H+((de+=J)>>>0<J>>>0?1:0))+((j=U+de|0)>>>0<U>>>0?1:0)|0,B=I,U=D,I=x,D=M,x=R,M=O,R=ke+(ge+he+(Ce>>>0<_e>>>0?1:0))+((O=de+Ce|0)>>>0<de>>>0?1:0)|0}h=r.low=h+O,r.high=f+R+(h>>>0<O>>>0?1:0),g=i.low=g+M,i.high=m+x+(g>>>0<M>>>0?1:0),v=o.low=v+D,o.high=_+I+(v>>>0<D>>>0?1:0),b=a.low=b+U,a.high=y+B+(b>>>0<U>>>0?1:0),S=s.low=S+j,s.high=w+L+(S>>>0<j>>>0?1:0),C=l.low=C+N,l.high=k+F+(C>>>0<N>>>0?1:0),T=d.low=T+q,d.high=E+$+(T>>>0<q>>>0?1:0),A=p.low=A+V,p.high=P+G+(A>>>0<V>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),r.SHA512)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(3),i=n(96),o=n(98),a=n(99),s=n(100),c=n(33);e.exports=function(e){return new Promise((function(t,u){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",h=e.auth.password||"";d.Authorization="Basic "+btoa(f+":"+h)}if(p.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:n,config:e,request:p};i(t,u,r),p=null}},p.onerror=function(){u(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var m=n(101),g=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(d[e.xsrfHeaderName]=g)}if("setRequestHeader"in p&&r.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),u(e),p=null)})),void 0===l&&(l=null),p.send(l)}))}},function(e,t,n){"use strict";var r=n(97);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t){var n=1e3,r=6e4,i=60*r,o=24*i;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?a(s=e,o,"day")||a(s,i,"hour")||a(s,r,"minute")||a(s,n,"second")||s+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(22).Buffer)},function(e,t,n){var r=n(119),i=n(47),o=n(21),a=n(20),s=n(48),c=n(49),u=n(10)("socket.io-client:manager"),l=n(46),d=n(137),p=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=s(n,"open",(function(){i.onopen(),e&&e()})),a=s(n,"error",(function(t){if(u("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c),0===c&&o.destroy();var l=setTimeout((function(){u("connect attempt timed out after %d",c),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(a),this},f.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",c(this,"ondata"))),this.subs.push(s(e,"ping",c(this,"onping"))),this.subs.push(s(e,"pong",c(this,"onpong"))),this.subs.push(s(e,"error",c(this,"onerror"))),this.subs.push(s(e,"close",c(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",c(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&o()}function o(){~l(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){var r=n(23),i=n(122),o=n(131),a=n(132);t.polling=function(e){var t=!1,n=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!a)throw new Error("JSONP disabled");return new o(e)},t.websocket=a},function(e,t,n){var r=n(25),i=n(27),o=n(8),a=n(13),s=n(45),c=n(14)("engine.io-client:polling");e.exports=l;var u=null!=new(n(23))({xdomain:!1}).responseType;function l(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),r.call(this,e)}a(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||n()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||n()})))}else n()},l.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(e){var t=this;c("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},l.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){(function(t){var r=n(124),i=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,s=n.length;i<s;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}}).call(this,n(22).Buffer)},function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},a=0,s=0;function c(e){var t="";do{t=i[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function u(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)}for(;s<64;s++)o[i[s]]=s;u.encode=c,u.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=64*t+o[e.charAt(s)];return t},e.exports=u},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(20),i=n(21),o=n(135),a=n(48),s=n(49),c=n(10)("socket.io-client:socket"),u=n(136),l=n(44);e.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=i.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);c("sending ack %j",i),t.packet({type:l(i)?r.BINARY_ACK:r.ACK,id:e,data:i})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){"use strict";e.exports=n(83)},function(e,t,n){(function(n){var r;function i(e){if(!e)throw"MediaStream is mandatory.";var t;this.start=function(n){var r;"undefined"!=typeof MediaRecorder?r=_:(d||l||u)&&(-1!==this.mimeType.indexOf("video")?r=b:-1!==this.mimeType.indexOf("audio")&&(r=v)),"image/gif"===this.mimeType&&(r=S),"audio/wav"!==this.mimeType&&"audio/pcm"!==this.mimeType||(r=v),this.recorderType&&(r=this.recorderType),(t=new r(e)).blobs=[];var i=this;t.ondataavailable=function(e){t.blobs.push(e),i.ondataavailable(e)},t.onstop=this.onstop,t.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(t=function(e,t){for(var n in t)"function"!=typeof t[n]&&(e[n]=t[n]);return e}(t,this)).start(n)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.stop=function(){t&&t.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.save=function(e,n){if(e)f(e,n);else{if(!t)return;ConcatenateBlobs(t.blobs,t.blobs[0].type,(function(e){f(e)}))}},this.pause=function(){t&&(t.pause(),console.log("Paused recording.",this.mimeType||t.mimeType))},this.resume=function(){t&&(t.resume(),console.log("Resumed recording.",this.mimeType||t.mimeType))},this.recorderType=null,this.mimeType="video/webm",this.disableLogs=!1}void 0!==i&&(i.MultiStreamRecorder=function(e){if(!e)throw"MediaStream is mandatory.";var t,n,r=this,o=g();this.stream=e,this.start=function(c){for(var u in t=new i(e),n=new i(e),t.mimeType="audio/ogg",n.mimeType="video/webm",this)"function"!=typeof this[u]&&(t[u]=n[u]=this[u]);function l(e){s++,r.ondataavailable(e)}t.ondataavailable=function(e){a[s]||(a[s]={}),a[s].audio=e,a[s].video&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,l(a[s]))},n.ondataavailable=function(e){if(o)return r.ondataavailable({video:e,audio:e});a[s]||(a[s]={}),a[s].video=e,a[s].audio&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,l(a[s]))},n.onstop=t.onstop=function(e){r.onstop(e)},o||(n.onStartedDrawingNonBlankFrames=function(){n.clearOldRecordedFrames(),t.start(c)}),n.start(c)},this.stop=function(){t&&t.stop(),n&&n.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.pause=function(){t&&t.pause(),n&&n.pause()},this.resume=function(){t&&t.resume(),n&&n.resume()};var a={},s=0});var o,a,s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";o=void 0!==n?n:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==n&&(n.navigator={userAgent:s,getUserMedia:function(){}},o.window=n),"undefined"==typeof document&&(o.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(o.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(o.screen={width:0,height:0})),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext)),"undefined"==typeof window&&(window={}),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext));var c=window.URL;void 0===c&&"undefined"!=typeof webkitURL&&(c=webkitURL),"undefined"!=typeof navigator?(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:s};var u=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),l=!1;"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")&&(l=!0);var d=!u&&!u&&!!navigator.webkitGetUserMedia,p=window.MediaStream;function f(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var n=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var r=t.split(".");t=r[0],n=r[1]}var i=(t||Math.round(9999999999*Math.random())+888888888)+"."+n;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,i);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,i);var o=document.createElement("a");o.href=c.createObjectURL(e),o.target="_blank",o.download=i,navigator.mozGetUserMedia&&(o.onclick=function(){(document.body||document.documentElement).removeChild(o)},(document.body||document.documentElement).appendChild(o));var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(a),navigator.mozGetUserMedia||c.revokeObjectURL(o.href)}function h(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}void 0===p&&"undefined"!=typeof webkitMediaStream&&(p=webkitMediaStream),void 0!==p&&("getVideoTracks"in p.prototype||(p.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)})),e},p.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)})),e}),"stop"in p.prototype||(p.prototype.stop=function(){this.getAudioTracks().forEach((function(e){e.stop&&e.stop()})),this.getVideoTracks().forEach((function(e){e.stop&&e.stop()}))})),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var m={AudioContext:a};function g(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;if(!t)return!1;navigator.appVersion;var n,r,i=navigator.userAgent,o=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);return t&&(n=i.indexOf("Chrome"),o=i.substring(n+7)),-1!==(r=o.indexOf(";"))&&(o=o.substring(0,r)),-1!==(r=o.indexOf(" "))&&(o=o.substring(0,r)),a=parseInt(""+o,10),isNaN(a)&&(o=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),a>=49}m={AudioContext:window.AudioContext||window.webkitAudioContext};function _(e){var t,n=this;this.start=function(r,i){var o;(n.mimeType||(n.mimeType="video/webm"),-1!==n.mimeType.indexOf("audio"))&&(e.getVideoTracks().length&&e.getAudioTracks().length&&(navigator.mozGetUserMedia?(o=new p).addTrack(e.getAudioTracks()[0]):o=new p(e.getAudioTracks()),e=o));-1!==n.mimeType.indexOf("audio")&&(n.mimeType=d?"audio/webm":"audio/ogg"),n.dontFireOnDataAvailableEvent=!1;var a={mimeType:n.mimeType};n.disableLogs||i||console.log("Passing following params over MediaRecorder API.",a),t&&(t=null),d&&!g()&&(a="video/vp8");try{t=new MediaRecorder(e,a)}catch(n){t=new MediaRecorder(e)}"canRecordMimeType"in t&&!1===t.canRecordMimeType(n.mimeType)&&(n.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",n.mimeType)),t.ignoreMutedMedia=n.ignoreMutedMedia||!1;var s=!1;t.ondataavailable=function(e){if(!n.dontFireOnDataAvailableEvent&&e.data&&e.data.size&&!(e.data.size<26800)&&!s){s=!0;var i=n.getNativeBlob?e.data:new Blob([e.data],{type:n.mimeType||"video/webm"});n.ondataavailable(i),n.dontFireOnDataAvailableEvent=!0,t&&(t.stop(),t=null),n.start(r,"__disableLogs")}},t.onerror=function(e){n.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),t&&"inactive"!==t.state&&"stopped"!==t.state&&t.stop()};try{t.start(36e5)}catch(e){t=null}setTimeout((function(){t&&"recording"===t.state&&t.requestData()}),r)},this.stop=function(e){t&&"recording"===t.state&&(t.requestData(),setTimeout((function(){n.dontFireOnDataAvailableEvent=!0,t&&"recording"===t.state&&t.stop(),t=null}),2e3))},this.pause=function(){t&&"recording"===t.state&&t.pause()},this.ondataavailable=function(e){console.log("recorded-blob",e)},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=n.disableLogs;return n.disableLogs=!0,this.record(),void(n.disableLogs=e)}t&&"paused"===t.state&&t.resume()},this.clearRecordedData=function(){t&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())},function r(){t&&(!1!==function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?setTimeout(r,1e3):n.stop())}()}function v(e){var t,n;this.start=function(r){r=r||1e3,(t=new y(e,this)).record(),n=setInterval((function(){t.requestData()}),r)},this.stop=function(){t&&(t.stop(),clearTimeout(n))},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function y(e,t){var n;m.AudioContextConstructor||(m.AudioContextConstructor=new m.AudioContext),n=m.AudioContextConstructor.sampleRate;var r,i=[],o=[],a=!1,s=0,c=t.sampleRate||n,u=(t.mimeType||"audio/wav").indexOf("audio/pcm")>-1,l=t.audioChannels||2;function d(e,t){for(var n=new Float32Array(t),r=0,i=e.length,o=0;o<i;o++){var a=e[o];n.set(a,r),r+=a.length}return n}function p(e,t,n){for(var r=n.length,i=0;i<r;i++)e.setUint8(t+i,n.charCodeAt(i))}function f(e){for(var t=e.length,n=new Int16Array(t);t--;)n[t]=65535*e[t];return n.buffer}this.record=function(){a=!0,i.length=o.length=0,s=0},this.requestData=function(){if(!w)if(0!==s){b=!0;var e=i.slice(0),n=o.slice(0),r=s;i.length=o.length=[],s=0,b=!1;var a=d(e,r),m=a;if(2===l)m=function(e,t){for(var n=e.length+t.length,r=new Float32Array(n),i=0,o=0;o<n;)r[o++]=e[i],r[o++]=t[i],i++;return r}(a,d(n,r));if(u){var g=new Blob([f(m)],{type:"audio/pcm"});return console.debug("audio recorded blob size:",h(g.size)),void t.ondataavailable(g)}var _=new ArrayBuffer(44+2*m.length),v=new DataView(_);p(v,0,"RIFF"),v.setUint32(4,44+2*m.length-8,!0),p(v,8,"WAVE"),p(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,l,!0),v.setUint32(24,c,!0),v.setUint32(28,c*l*2,!0),v.setUint16(32,2*l,!0),v.setUint16(34,16,!0),p(v,36,"data"),v.setUint32(40,2*m.length,!0);for(var y=m.length,S=44,k=0;k<y;k++)v.setInt16(S,32767*m[k],!0),S+=2;g=new Blob([v],{type:"audio/wav"});console.debug("audio recorded blob size:",h(g.size)),t.ondataavailable(g)}else b=!1},this.stop=function(){a=!1,this.requestData(),_.disconnect()};var g=m.AudioContextConstructor;m.VolumeGainNode=g.createGain();var _,v=m.VolumeGainNode;m.AudioInput=g.createMediaStreamSource(e),(_=m.AudioInput).connect(v);var y=t.bufferSize||2048;if(0===t.bufferSize&&(y=0),g.createJavaScriptNode)r=g.createJavaScriptNode(y,l,l);else{if(!g.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=g.createScriptProcessor(y,l,l)}y=r.bufferSize,console.debug("using audio buffer-size:",y);var b=!1;window.scriptprocessornode=r,1===l&&console.debug("All right-channels are skipped.");var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1},r.onaudioprocess=function(e){if(a&&!b&&!w){var t=e.inputBuffer.getChannelData(0);if(i.push(new Float32Array(t)),2===l){var n=e.inputBuffer.getChannelData(1);o.push(new Float32Array(n))}s+=y}},v.connect(r),r.connect(g.destination)}function b(e){var t,n;this.start=function(r){for(var i in r=r||1e3,t=new w(e,this),this)"function"!=typeof this[i]&&(t[i]=this[i]);t.record(),n=setInterval((function(){t.requestData()}),r)},this.stop=function(){t&&(t.stop(),clearTimeout(n))},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function w(e,t){this.record=function(n){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=a.videoWidth||a.clientWidth||320),this.height||(this.height=a.videoHeight||a.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),l.width=this.canvas.width,l.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?(this.isHTMLObject=!0,a=this.video.cloneNode()):((a=document.createElement("video")).src=c.createObjectURL(e),a.width=this.video.width,a.height=this.video.height),a.muted=!0,a.play(),s=(new Date).getTime(),u=new k.Video(t.speed,t.quality),console.log("canvas resolutions",l.width,"*",l.height),console.log("video width/height",a.width||l.width,"*",a.height||l.height),i()},this.clearOldRecordedFrames=function(){u.frames=[]};var n=!1;this.requestData=function(){if(!f)if(u.frames.length){n=!0;var e=u.frames.slice(0);u.frames=function(e,t,n,r){var i=document.createElement("canvas");i.width=l.width,i.height=l.height;for(var o=i.getContext("2d"),a=[],s=-1===t,c=t&&t>0&&t<=e.length?t:e.length,u={r:0,g:0,b:0},d=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),p=n&&n>=0&&n<=1?n:0,f=r&&r>=0&&r<=1?r:0,h=!1,m=0;m<c;m++){var g,_,v;if(!h){var y=new Image;y.src=e[m].image,o.drawImage(y,0,0,l.width,l.height);var b=o.getImageData(0,0,l.width,l.height);g=0,_=b.data.length,v=b.data.length/4;for(var w=0;w<_;w+=4){var S={r:b.data[w],g:b.data[w+1],b:b.data[w+2]};Math.sqrt(Math.pow(S.r-u.r,2)+Math.pow(S.g-u.g,2)+Math.pow(S.b-u.b,2))<=d*p&&g++}}!h&&v-g<=v*f||(s&&(h=!0),a.push(e[m]))}(a=a.concat(e.slice(c))).length<=0&&a.push(e[e.length-1]);return a}(e,-1),u.compile((function(e){t.ondataavailable(e),console.debug("video recorded blob size:",h(e.size))})),u.frames=[],n=!1}else n=!1};var r=!1;function i(){if(f)return s=(new Date).getTime(),void setTimeout(i,500);if(!o){if(n)return setTimeout(i,100);var e=(new Date).getTime()-s;if(!e)return i();s=(new Date).getTime(),!p.isHTMLObject&&a.paused&&a.play(),d.drawImage(a,0,0,l.width,l.height),o||u.frames.push({duration:e,image:l.toDataURL("image/webp")}),r||function(e,t,n){var r=document.createElement("canvas");r.width=l.width,r.height=l.height;var i,o,a,s=r.getContext("2d"),c={r:0,g:0,b:0},u=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),d=t&&t>=0&&t<=1?t:0,p=n&&n>=0&&n<=1?n:0,f=new Image;f.src=e.image,s.drawImage(f,0,0,l.width,l.height);var h=s.getImageData(0,0,l.width,l.height);i=0,o=h.data.length,a=h.data.length/4;for(var m=0;m<o;m+=4){var g={r:h.data[m],g:h.data[m+1],b:h.data[m+2]};Math.sqrt(Math.pow(g.r-c.r,2)+Math.pow(g.g-c.g,2)+Math.pow(g.b-c.b,2))<=u*d&&i++}return!(a-i<=a*p)}(u.frames[u.frames.length-1])||(r=!0,t.onStartedDrawingNonBlankFrames()),setTimeout(i,10)}}var o=!1;this.stop=function(){o=!0,this.requestData()};var a,s,u,l=document.createElement("canvas"),d=l.getContext("2d"),p=this;var f=!1;this.pause=function(){f=!0},this.resume=function(){f=!1}}function S(e){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";function t(){Date.now();var e=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"});r.ondataavailable(e),u.stream().bin=[]}this.start=function(e){e=e||1e3;var r=this.videoWidth||320,c=this.videoHeight||240;i.width=a.width=r,i.height=a.height=c,(u=new GIFEncoder).setRepeat(0),u.setDelay(this.frameRate||this.speed||200),u.setQuality(this.quality||1),u.start(),Date.now(),d=requestAnimationFrame((function e(t){n?setTimeout(e,500,t):(d=requestAnimationFrame(e),void 0===typeof s&&(s=t),t-s<90||(a.paused&&a.play(),o.drawImage(a,0,0,r,c),u.addFrame(o),s=t))})),l=setTimeout(t,e)},this.stop=function(){d&&(cancelAnimationFrame(d),clearTimeout(l),t())};var n=!1;this.pause=function(){n=!0},this.resume=function(){n=!1},this.ondataavailable=function(){},this.onstop=function(){};var r=this,i=document.createElement("canvas"),o=i.getContext("2d"),a=document.createElement("video");a.muted=!0,a.autoplay=!0,a.src=c.createObjectURL(e),a.play();var s,u,l,d=null}void 0!==i&&(i.MediaRecorderWrapper=_),void 0!==i&&(i.StereoAudioRecorder=v),void 0!==i&&(i.StereoAudioRecorderHelper=y),void 0!==i&&(i.WhammyRecorder=b),void 0!==i&&(i.WhammyRecorderHelper=w),void 0!==i&&(i.GifRecorder=S);var k=function(){function e(e,t){this.frames=[],e||(e=1),this.duration=1e3/e,this.quality=t||.8}function t(e){function t(e,t,n){return[{data:e,id:231}].concat(n.map((function(e){var n=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:n,id:163}})))}function n(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function r(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}function i(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}var o=new function(e){var i=function(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,n=e[0].height,r=e[0].duration,i=1;i<e.length;i++)r+=e[i].duration;return{duration:r,width:t,height:n}}(e);if(!i)return[];for(var o,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(o=i.duration,[].slice.call(new Uint8Array(new Float64Array([o]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:i.width,id:176},{data:i.height,id:186}]}]}]}]}],s=0,c=0;s<e.length;){var u=[],l=0;do{u.push(e[s]),l+=e[s].duration,s++}while(s<e.length&&l<3e4);var d={id:524531317,data:t(c,0,u)};a[1].data.push(d),c+=l}return function e(t){for(var i=[],o=0;o<t.length;o++){var a=t[o].data;"object"==typeof a&&(a=e(a)),"number"==typeof a&&(a=r(a.toString(2))),"string"==typeof a&&(a=new Uint8Array(a.split("").map((function(e){return e.charCodeAt(0)}))));var s=a.size||a.byteLength||a.length,c=Math.ceil(Math.ceil(Math.log(s)/Math.log(2))/8),u=s.toString(2),l=new Array(7*c+7+1-u.length).join("0")+u,d=new Array(c).join("0")+"1"+l;i.push(n(t[o].id)),i.push(r(d)),i.push(a)}return new Blob(i,{type:"video/webm"})}(a)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],n=t.indexOf("*"),r=0,i=[];r<4;r++)i[r]=t.charCodeAt(n+3+r);return{width:16383&(i[1]<<8|i[0]),height:16383&(i[3]<<8|i[2]),data:t,riff:e}}(function e(t){for(var n=0,r={};n<t.length;){var o=t.substr(n,4),a=i(t,n),s=t.substr(n+4+4,a);n+=8+a,r[o]=r[o]||[],"RIFF"===o||"LIST"===o?r[o].push(e(s)):r[o].push(s)}return r}(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(o)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var n,r,i,o=(n=t,r=c.createObjectURL(new Blob([n.toString(),"this.onmessage =  function (e) {"+n.name+"(e.data);}"],{type:"application/javascript"})),i=new Worker(r),c.revokeObjectURL(r),i);o.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},o.postMessage(this.frames)},{Video:e}}();void 0!==i&&(i.Whammy=k),window.ConcatenateBlobs=function(e,t,n){var r=[],i=0;!function o(){if(!e[i])return function(){var e=0;r.forEach((function(t){e+=t.byteLength}));var i=new Uint16Array(e),o=0;r.forEach((function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),i.set(new Uint16Array(e),o),o+=t}));var a=new Blob([i.buffer],{type:t});n(a)}();var a=new FileReader;a.onload=function(e){r.push(e.target.result),i++,o()},a.readAsArrayBuffer(e[i])}()},e.exports=i,void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}).call(this,n(19))},function(e,t,n){parcelRequire=function(t,r,i,o){var a,s="function"==typeof parcelRequire&&parcelRequire;function c(e,i){if(!r[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(e,!0);if(s)return s(e,!0);if("string"==typeof e)return n(109)(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var u=r[e]=new c.Module(e);t[e][0].call(u.exports,l,u,u.exports,this)}return r[e].exports;function l(e){return c(l.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=r,c.parent=s,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var u=0;u<i.length;u++)try{c(i[u])}catch(t){a||(a=t)}if(i.length){var l=c(i[i.length-1]);e.exports=l}if(parcelRequire=c,a)throw a;return c}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures,o={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=o,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},a.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),a=t<<31|n+1023<<20|i/o&1048575,s=i%o;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(n,r){var i=s(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,o))}),{}):t},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&c(e,n,i)}))})),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),i=function(e){if("object"!==o(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===o(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[i("min",n)]=r.ideal,t.optional.push(a),(a={})[i("max",n)]=r.ideal,t.optional.push(a)):(a[i("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===o(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===o(e.video)){var c=e.video.facingMode;c=c&&("object"===o(c)?c:{ideal:c});var u,l=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&u.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=i(e.video),a("chrome: "+JSON.stringify(e)),r(e)}));e.video=i(e.video)}return a("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,i]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(a(o(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(a(o(e)))},r])})).then(r,i)}}},n.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(n?r=!0:n=e),e.track===i})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=u,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return u(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=l(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,n=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,n};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,d=a.localCapabilities,p=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var f=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);s&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===u.state&&u.start(c,f,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=o(d,p);i._transceive(a,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var d={};l.remoteStreams.forEach((function(e){d[e.id]=e}));var p=[],f=r.splitSections(i.sdp),h=f.shift(),m=r.matchPrefix(h,"a=ice-lite").length>0,g=r.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=g;var _=r.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!_&&_.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(a,c){var u=r.splitLines(a),f=r.getKind(a),_=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,v=u[0].substr(2).split(" ")[2],y=r.getDirection(a,h),b=r.parseMsid(a),w=r.getMid(a)||r.generateIdentifier();if(_||"application"===f&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))l.transceivers[c]={mid:w,kind:f,protocol:v,rejected:!0};else{var S,k,C,E,T,P,A,R,O;!_&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(f,!0));var x,M,I=r.parseRtpParameters(a);_||(x=r.getIceParameters(a,h),(M=r.getDtlsParameters(a,h)).role="client"),A=r.parseRtpEncodingParameters(a);var D=r.parseRtcpParameters(a),B=r.matchPrefix(a,"a=end-of-candidates",h).length>0,U=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!_&&g&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||_)"answer"!==i.type||_||(k=(S=l.transceivers[c]).iceGatherer,C=S.iceTransport,E=S.dtlsTransport,T=S.rtpReceiver,P=S.sendEncodingParameters,R=S.localCapabilities,l.transceivers[c].recvEncodingParameters=A,l.transceivers[c].remoteCapabilities=I,l.transceivers[c].rtcpParameters=D,U.length&&"new"===C.state&&(!m&&!B||g&&0!==c?U.forEach((function(e){s(S.iceTransport,e)})):C.setRemoteCandidates(U)),g&&0!==c||("new"===C.state&&C.start(k,x,"controlling"),"new"===E.state&&E.start(M)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,l._transceive(S,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!T||"sendrecv"!==y&&"sendonly"!==y?delete S.rtpReceiver:(O=T.track,b?(d[b.stream]||(d[b.stream]=new e.MediaStream),n(O,d[b.stream]),p.push([O,T,d[b.stream]])):(d.default||(d.default=new e.MediaStream),n(O,d.default),p.push([O,T,d.default]))));else{(S=l.transceivers[c]||l._createTransceiver(f)).mid=w,S.iceGatherer||(S.iceGatherer=l._createIceGatherer(c,g)),U.length&&"new"===S.iceTransport.state&&(!B||g&&0!==c?U.forEach((function(e){s(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(U)),R=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(R.codecs=R.codecs.filter((function(e){return"rtx"!==e.name}))),P=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,j=!1;"sendrecv"===y||"sendonly"===y?(j=!S.rtpReceiver,T=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,f),j&&(O=T.track,b&&"-"===b.stream||(b?(d[b.stream]||(d[b.stream]=new e.MediaStream,Object.defineProperty(d[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(O,"id",{get:function(){return b.track}}),L=d[b.stream]):(d.default||(d.default=new e.MediaStream),L=d.default)),L&&(n(O,L),S.associatedRemoteMediaStreams.push(L)),p.push([O,T,L]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n,r,i=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=R,S.remoteCapabilities=I,S.rtpReceiver=T,S.rtcpParameters=D,S.sendEncodingParameters=P,S.recvEncodingParameters=A,l._transceive(l.transceivers[c],!1,j)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(d).forEach((function(t){var n=d[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}p.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])}))}})),p.forEach((function(e){e[2]||u(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var d=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,d))return o(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(d.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var f=0;f<n.transceivers.length&&(n.transceivers[f].rejected||(n.transceivers[f].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));f++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var d=["createOffer","createAnswer"];return d.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(d=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,o.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./filtericeservers"),o=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===o(e)&&"object"===o(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},i&&i.prototype.getSettings){var c=i.prototype.getSettings;i.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(i&&i.prototype.applyConstraints){var u=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===o(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===s(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,n,r]=arguments;return o.apply(this,[e||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(n,r)}}},n.shimSenderGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:i}=r,o=i.getParameters();"encodings"in o||(o.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===o(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var c=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===o(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.default.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var i,o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(u=o,l=65536,"firefox"===t.browser&&(l=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),l),s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],o);i=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return i}}),this._sctp=c}var u,l;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,u=r.detectBrowser(e),l={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),l;n("adapter.js shimming chrome."),l.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),l;n("adapter.js shimming firefox."),l.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!o||!o.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),l;n("adapter.js shimming edge."),l.browserShim=o,o.shimGetUserMedia(e),o.shimGetDisplayMedia(e),o.shimPeerConnection(e),o.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),l;n("adapter.js shimming safari."),l.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return l};var r=l(e("./utils")),i=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),s=l(e("./safari/safari_shim")),c=l(e("./common_shim"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(e){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("peerjs-js-binarypack")),o=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/n.util.chunkedMTU),o=0,a=0;a<r;){var s=Math.min(r,a+n.util.chunkedMTU),c=e.slice(a,s),u={__peerData:this._dataCount,n:o,data:c,total:i};t.push(u),a=s,o++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function u(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var p,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return c(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||c(this,o);else{for(var s=0,u=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[o]=1===u.length?u[0]:u:c(this,o)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var o,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(o=n.LogLevel||(n.LogLevel={}));var s=function(){function e(){this._logLevel=o.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,i([o.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,i([o.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,i([o.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=i([a],t);for(var s in r)r[s]instanceof Error&&(r[s]="("+r[s].name+") "+r[s].message);e>=o.All?console.log.apply(console,i(r)):e>=o.Warnings?console.warn.apply(console,i(["WARNING"],r)):e>=o.Errors&&console.error.apply(console,i(["ERROR"],r))},e}();n.default=new s},{}],ZRYf:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=s(e("./logger")),l=e("./enums"),d=function(e){function t(t,n,r,i,o,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!0,s._messagesQueue=[];var c=t?"wss://":"ws://";return s._baseUrl=c+n+":"+r+i+"peerjs?key="+o,s}return r(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),u.default.log("Server message received:",t)}catch(t){return void u.default.log("Invalid server message",e.data)}n.emit(l.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(u.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(l.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),u.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:l.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=o(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(n),i=r.next();!i.done;i=r.next()){var s=i.value;this.send(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(l.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(c.EventEmitter);n.Socket=d},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},i=t.createDataChannel(n.label,r);n.initialize(i)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+n+":",e.candidate),o.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var i=e.streams[0],a=o.getConnection(n,r);if(a.type===u.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(i,s)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===u.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,n,i,a,l,d;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===u.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=o.sent())&&(t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return d=o.sent(),t.emitError(u.PeerErrorType.WebRTC,d),c.default.log("Failed to createOffer, ",d),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(u.PeerErrorType.WebRTC,i),c.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),i=this,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return o.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return a=o.sent(),r.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,n,r,i,a,s;return o(this,(function(o){switch(o.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=o.sent(),a.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=i},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./negotiator"),l=e("./enums"),d=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+s.util.randomToken(),o._negotiator=new u.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,l.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(i(i({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=o(a),u=s.next();!u.done;u=s.next()){var l=u.value;this.handleMessage(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=d},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("eventemitter3"),a=i(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(o.EventEmitter);n.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=e("./negotiator"),u=e("./enums"),l=e("./baseconnection"),d=e("./encodingQueue"),p=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.stringify=JSON.stringify,o.parse=JSON.parse,o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new d.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+a.util.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||u.SerializationType.Binary,o.reliable=!!o.options.reliable,o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){s.default.error("DC#"+o.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),o.close()})),o._negotiator=new c.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(i===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);n.emit(u.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)o=a.util.unpack(r);else if(i===String){var s=a.util.binaryStringToArrayBuffer(r);o=a.util.unpack(s)}}else this.serialization===u.SerializationType.JSON&&(o=this.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,u.ConnectionEventType.Data,o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var o=i(r),c=o.next();!c.done;c=o.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(l.BaseConnection);n.DataConnection=p},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=o(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=i.sent(),s.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("peers"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status){if(401===t.status)throw"",n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=i.sent(),s.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),l=s(e("./logger")),d=e("./socket"),p=e("./mediaconnection"),f=e("./dataconnection"),h=e("./enums"),m=e("./api"),g=function(e){function t(n,r){var o,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(o=n.toString()),r=i({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==u.util.CLOUD_HOST?a._options.secure=u.util.isSecure():a._options.host==u.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&l.default.setLogFunction(a._options.logFunction),l.default.logLevel=a._options.debug||0,a._api=new m.API(r),a._socket=a._createServerConnection(),u.util.supports.audioVideo||u.util.supports.data?o&&!u.util.validateId(o)?(a._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+o+'" is invalid'),a):(o?a._initialize(o):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(h.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=o(this._connections),i=r.next();!i.done;i=r.next()){var s=a(i.value,2),c=s[0],u=s[1];n[c]=u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new d.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,a=e.src;switch(r){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,i.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:l.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case h.ServerMessageType.Offer:var s=i.connectionId;if((g=this.getConnection(a,s))&&(g.close(),l.default.warn("Offer received for existing Connection ID:"+s)),i.type===h.ConnectionType.Media)g=new p.MediaConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata}),this._addConnection(a,g),this.emit(h.PeerEventType.Call,g);else{if(i.type!==h.ConnectionType.Data)return void l.default.warn("Received malformed connection type:"+i.type);g=new f.DataConnection(a,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(a,g),this.emit(h.PeerEventType.Connection,g)}var c=this._getMessages(s);try{for(var u=o(c),d=u.next();!d.done;d=u.next()){var m=d.value;g.handleMessage(m)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}break;default:if(!i)return void l.default.warn("You received a malformed message from "+a+" of type "+r);var g;s=i.connectionId,(g=this.getConnection(a,s))&&g.peerConnection?g.handleMessage(e):s?this._storeMessage(s,e):l.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new f.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return l.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new p.MediaConnection(e,this,n);return this._addConnection(e,r),r}l.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){l.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var a=o(i),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.connectionId===t)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){l.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;l.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(l.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=o(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=o(r),a=i.next();!a.done;a=i.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;l.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)l.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");l.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);n.Peer=g},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),i=e("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i={options:{disableScrolling:!1,hostedStyles:!0,animations:!0,keyboardControl:!0,minResolution:0,autoInit:!0,wrapAround:!1,showImageCount:!0},version:"1.4.11"};function o(e,t){var n=this;this.root=t,this.index=e,this.imgPaths=[],this.subTexts=[],this.altTexts=[],this.options={};var r=document.getElementsByClassName("hes-gallery")[this.index];this.options.wrapAround=r.hasAttribute("data-wrap")?"true"==r.dataset.wrap:this.root.options.wrapAround,this.options.showImageCount=r.hasAttribute("data-img-count")?"true"==r.dataset.imgCount:this.root.options.showImageCount;var i=0;r.querySelectorAll("img").forEach((function(e,t){e.hasAttribute("data-disabled")?i++:(e.hasAttribute("data-fullsize")?n.imgPaths.push(e.dataset.fullsize||""):n.imgPaths.push(e.src||""),n.subTexts.push(e.dataset.subtext||""),n.altTexts.push(e.alt||""),e.onclick=function(){n.root.show(n.index,t-i)})})),this.count=this.imgPaths.length}i.setOptions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)this.options[t]=e[t]},i.init=function(e){var t=this;this.setOptions(e),this.executed||this.createDOM(),this.options.animations?this.elements.pic_cont.classList="hg-transition":this.elements.pic_cont.classList="",this.count=document.querySelectorAll(".hes-gallery").length,this.galleries=[];for(var n=0;n<this.count;n++)this.galleries[n]=new o(n,this);return this.options.keyboardControl&&!this.keydownEventListener&&(addEventListener("keydown",(function(e){var n=e.keyCode;39==n&&t.open&&t.options.keyboardControl&&t.next(),37==n&&t.open&&t.options.keyboardControl&&t.prev(),27==n&&t.open&&t.options.keyboardControl&&t.hide()})),this.keydownEventListener=!0),"HesGallery initiated!"},i.createDOM=function(){var e=this;this.elements={},this.options.hostedStyles&&(document.head.innerHTML+="<link rel='stylesheet' href='https://unpkg.com/hes-gallery/dist/hes-gallery.min.css'>");var t=document.createElement("div");t.id="hgallery",t.setAttribute("style","visibility:hidden;"),this.elements.galery=t,this.elements.galery.innerHTML+="\n    <div id='hg-bg'></div>\n    <div id='hg-pic-cont'>\n      <img id='hg-pic' />\n      <div id='hg-prev-onpic'></div>\n      <div id='hg-next-onpic'></div>\n      <div id='hg-subtext'></div>\n      <div id='hg-howmany'></div>\n    </div>\n    <button id='hg-prev'></button>\n    <button id='hg-next'></button>\n  ",document.body.appendChild(t),this.elements.b_prev=document.getElementById("hg-prev"),this.elements.b_next=document.getElementById("hg-next"),this.elements.pic_cont=document.getElementById("hg-pic-cont"),this.elements.b_next_onpic=document.getElementById("hg-next-onpic"),this.elements.b_prev_onpic=document.getElementById("hg-prev-onpic"),this.elements.b_prev.onclick=this.elements.b_prev_onpic.onclick=function(){e.prev()},this.elements.b_next.onclick=this.elements.b_next_onpic.onclick=function(){e.next()},document.getElementById("hg-bg").onclick=function(){e.hide()},this.executed=!0},i.show=function(e,t){if(innerWidth<this.options.minResolution)return!1;this.currentImg=t,this.currentGal=e,this.open=!0,!this.options.animations&&"hg-transition"!=this.elements.pic_cont.classList||this.elements.pic_cont.classList.remove("hg-transition"),document.getElementById("hg-pic").setAttribute("src",this.galleries[e].imgPaths[t]),document.getElementById("hg-pic").alt=this.galleries[e].altTexts[t],this.elements.galery.classList.add("open"),document.getElementById("hg-subtext").innerHTML=this.galleries[e].subTexts[t],this.galleries[this.currentGal].options.showImageCount&&1!=this.galleries[this.currentGal].imgPaths.length?document.getElementById("hg-howmany").innerHTML=this.currentImg+1+"/"+this.galleries[e].count:document.getElementById("hg-howmany").innerHTML="",1==this.galleries[this.currentGal].imgPaths.length?(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"):this.currentImg+1!=1||this.galleries[this.currentGal].options.wrapAround?(this.currentImg+1!=this.galleries[this.currentGal].count||this.galleries[this.currentGal].options.wrapAround?(this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""):(this.elements.b_next.classList="hg-unvisible",this.elements.b_next_onpic.classList="hg-unvisible"),this.elements.b_prev.classList="",this.elements.b_prev_onpic.classList=""):(this.elements.b_prev.classList="hg-unvisible",this.elements.b_prev_onpic.classList="hg-unvisible",this.elements.b_next.classList="",this.elements.b_next_onpic.classList=""),this.options.disableScrolling&&(document.body.classList+=" hg-disable-scrolling")},i.hide=function(){this.options.animations&&this.elements.pic_cont.classList.add("hg-transition"),this.elements.galery.classList.remove("open"),this.open=!1,this.options.disableScrolling&&document.body.classList.remove("hg-disable-scrolling")},i.next=function(){this.galleries[this.currentGal].options.wrapAround&&this.currentImg==this.galleries[this.currentGal].count-1?this.show(this.currentGal,0):this.currentImg+1<this.galleries[this.currentGal].count&&this.show(this.currentGal,this.currentImg+1)},i.prev=function(){this.galleries[this.currentGal].options.wrapAround&&0==this.currentImg?this.show(this.currentGal,this.galleries[this.currentGal].count-1):1<this.currentImg+1&&this.show(this.currentGal,this.currentImg-1)},document.addEventListener("DOMContentLoaded",(function(){i.options.autoInit&&i.init()})),"object"==r(t)&&void 0!==e&&(e.exports=i),"undefined"!=typeof NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach)},function(e,t,n){var r=n(112),i=n(20),o=n(41),a=n(10)("socket.io-client");e.exports=t=c;var s=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),c=i.source,u=i.id,l=i.path,d=s[u]&&l in s[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(a("ignoring socket cache for %s",c),n=o(c,t)):(s[u]||(a("new io instance for %s",c),s[u]=o(c,t)),n=s[u]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}t.protocol=i.protocol,t.connect=c,t.Manager=n(41),t.Socket=n(47)},function(e,t){e.exports=function e(t){var n=new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","googlebot","baiduspider","gurujibot","yandexbot","slurp","msnbot","bingbot","facebookexternalhit","linkedinbot","twitterbot","slackbot","telegrambot","applebot","pingdom","tumblr ","Embedly","spbot"].join("|")+").*$");t=t||{};var r={version:!1,language:!1,platform:!0,os:!0,pixelDepth:!0,colorDepth:!0,resolution:!1,isAuthoritative:!0,silkAccelerated:!0,isKindleFire:!0,isDesktop:!0,isMobile:!0,isTablet:!0,isWindows:!0,isLinux:!0,isLinux64:!0,isChromeOS:!0,isMac:!0,isiPad:!0,isiPhone:!0,isiPod:!0,isAndroid:!0,isSamsung:!0,isSmartTV:!0,isRaspberry:!0,isBlackberry:!0,isTouchScreen:!0,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,source:!1,cpuCores:!1};for(var i in t)t.hasOwnProperty(i)&&void 0!==r[i]&&(r[i]=t[i]);return this.options=r,this.version="1.0.0",this._Versions={Edge:/Edge\/([\d\w\.\-]+)/i,Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])|trident\/\d+\.\d+;.*[rv:]+(\d+\.\d)/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Chromium:/(?:chromium|crios)\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Opera:/version\/([\d\w\.\-]+)|OPR\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i,Amaya:/amaya\/([\d\w\.\-]+)/i,SeaMonkey:/seamonkey\/([\d\w\.\-]+)/i,OmniWeb:/omniweb\/v([\d\w\.\-]+)/i,Flock:/flock\/([\d\w\.\-]+)/i,Epiphany:/epiphany\/([\d\w\.\-]+)/i,WinJs:/msapphost\/([\d\w\.\-]+)/i,PhantomJS:/phantomjs\/([\d\w\.\-]+)/i,UC:/UCBrowser\/([\d\w\.]+)/i},this._Browsers={Edge:/edge/i,Amaya:/amaya/i,Konqueror:/konqueror/i,Epiphany:/epiphany/i,SeaMonkey:/seamonkey/i,Flock:/flock/i,OmniWeb:/omniweb/i,Chromium:/chromium|crios/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie|trident/i,Opera:/opera|OPR/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i,WinJs:/msapphost/i,PhantomJS:/phantomjs/i,UC:/UCBrowser/i},this._OS={Windows10:/windows nt 10\.0/i,Windows81:/windows nt 6\.3/i,Windows8:/windows nt 6\.2/i,Windows7:/windows nt 6\.1/i,UnknownWindows:/windows nt 6\.\d+/i,WindowsVista:/windows nt 6\.0/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,WindowsPhone8:/windows phone 8\./,OSXCheetah:/os x 10[._]0/i,OSXPuma:/os x 10[._]1(\D|$)/i,OSXJaguar:/os x 10[._]2/i,OSXPanther:/os x 10[._]3/i,OSXTiger:/os x 10[._]4/i,OSXLeopard:/os x 10[._]5/i,OSXSnowLeopard:/os x 10[._]6/i,OSXLion:/os x 10[._]7/i,OSXMountainLion:/os x 10[._]8/i,OSXMavericks:/os x 10[._]9/i,OSXYosemite:/os x 10[._]10/i,OSXElCapitan:/os x 10[._]11/i,OSXSierra:/os x 10[._]12/i,Mac:/os x/i,Linux:/linux/i,Linux64:/linux x86_64/i,ChromeOS:/cros/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,iPad:/\(iPad.*os (\d+)[._](\d+)/i,iPhone:/\(iPhone.*os (\d+)[._](\d+)/i,Bada:/Bada\/(\d+)\.(\d+)/i,Curl:/curl\/(\d+)\.(\d+)\.(\d+)/i},this._Platform={Windows:/windows nt/i,WindowsPhone:/windows phone/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,iPad:/ipad/i,iPod:/ipod/i,iPhone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i,Samsung:/samsung/i,Curl:/curl/i},this.DefaultAgent={isAuthoritative:!0,isMobile:!1,isTablet:!1,isiPad:!1,isiPod:!1,isiPhone:!1,isAndroid:!1,isBlackberry:!1,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,isDesktop:!1,isWindows:!1,isLinux:!1,isLinux64:!1,isMac:!1,isChromeOS:!1,isBada:!1,isSamsung:!1,isRaspberry:!1,isBot:!1,isCurl:!1,isAndroidTablet:!1,isWinJs:!1,isKindleFire:!1,isSilk:!1,isCaptive:!1,isSmartTV:!1,isUC:!1,isTouchScreen:!1,silkAccelerated:!1,colorDepth:-1,pixelDepth:-1,resolution:[],cpuCores:-1,language:"unknown",browser:"unknown",version:"unknown",os:"unknown",platform:"unknown",geoIp:{},source:"",hashInt:function(e){var t,n,r=0;if(0===e.length)return r;for(t=0,n=e.length;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r},hashMD5:function(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,i,o,a;return i=2147483648&e,o=2147483648&t,a=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(r=1073741824&t)?2147483648^a^i^o:n|r?1073741824&a?3221225472^a^i^o:1073741824^a^i^o:a^i^o}function r(e,r,i,o,a,s,c){return e=n(e,n(n(function(e,t,n){return e&t|~e&n}(r,i,o),a),c)),n(t(e,s),r)}function i(e,r,i,o,a,s,c){return e=n(e,n(n(function(e,t,n){return e&n|t&~n}(r,i,o),a),c)),n(t(e,s),r)}function o(e,r,i,o,a,s,c){return e=n(e,n(n(function(e,t,n){return e^t^n}(r,i,o),a),c)),n(t(e,s),r)}function a(e,r,i,o,a,s,c){return e=n(e,n(n(function(e,t,n){return t^(e|~n)}(r,i,o),a),c)),n(t(e,s),r)}function s(e){var t,n="",r="";for(t=0;t<=3;t++)n+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return n}var c,u,l,d,p,f,h,m,g,_;for(c=function(e){for(var t,n=e.length,r=n+8,i=16*((r-r%64)/64+1),o=new Array(i-1),a=0,s=0;s<n;)a=s%4*8,o[t=(s-s%4)/4]=o[t]|e.charCodeAt(s)<<a,s++;return a=s%4*8,o[t=(s-s%4)/4]=o[t]|128<<a,o[i-2]=n<<3,o[i-1]=n>>>29,o}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)),h=1732584193,m=4023233417,g=2562383102,_=271733878,u=0;u<c.length;u+=16)l=h,d=m,p=g,f=_,h=r(h,m,g,_,c[u+0],7,3614090360),_=r(_,h,m,g,c[u+1],12,3905402710),g=r(g,_,h,m,c[u+2],17,606105819),m=r(m,g,_,h,c[u+3],22,3250441966),h=r(h,m,g,_,c[u+4],7,4118548399),_=r(_,h,m,g,c[u+5],12,1200080426),g=r(g,_,h,m,c[u+6],17,2821735955),m=r(m,g,_,h,c[u+7],22,4249261313),h=r(h,m,g,_,c[u+8],7,1770035416),_=r(_,h,m,g,c[u+9],12,2336552879),g=r(g,_,h,m,c[u+10],17,4294925233),m=r(m,g,_,h,c[u+11],22,2304563134),h=r(h,m,g,_,c[u+12],7,1804603682),_=r(_,h,m,g,c[u+13],12,4254626195),g=r(g,_,h,m,c[u+14],17,2792965006),h=i(h,m=r(m,g,_,h,c[u+15],22,1236535329),g,_,c[u+1],5,4129170786),_=i(_,h,m,g,c[u+6],9,3225465664),g=i(g,_,h,m,c[u+11],14,643717713),m=i(m,g,_,h,c[u+0],20,3921069994),h=i(h,m,g,_,c[u+5],5,3593408605),_=i(_,h,m,g,c[u+10],9,38016083),g=i(g,_,h,m,c[u+15],14,3634488961),m=i(m,g,_,h,c[u+4],20,3889429448),h=i(h,m,g,_,c[u+9],5,568446438),_=i(_,h,m,g,c[u+14],9,3275163606),g=i(g,_,h,m,c[u+3],14,4107603335),m=i(m,g,_,h,c[u+8],20,1163531501),h=i(h,m,g,_,c[u+13],5,2850285829),_=i(_,h,m,g,c[u+2],9,4243563512),g=i(g,_,h,m,c[u+7],14,1735328473),h=o(h,m=i(m,g,_,h,c[u+12],20,2368359562),g,_,c[u+5],4,4294588738),_=o(_,h,m,g,c[u+8],11,2272392833),g=o(g,_,h,m,c[u+11],16,1839030562),m=o(m,g,_,h,c[u+14],23,4259657740),h=o(h,m,g,_,c[u+1],4,2763975236),_=o(_,h,m,g,c[u+4],11,1272893353),g=o(g,_,h,m,c[u+7],16,4139469664),m=o(m,g,_,h,c[u+10],23,3200236656),h=o(h,m,g,_,c[u+13],4,681279174),_=o(_,h,m,g,c[u+0],11,3936430074),g=o(g,_,h,m,c[u+3],16,3572445317),m=o(m,g,_,h,c[u+6],23,76029189),h=o(h,m,g,_,c[u+9],4,3654602809),_=o(_,h,m,g,c[u+12],11,3873151461),g=o(g,_,h,m,c[u+15],16,530742520),h=a(h,m=o(m,g,_,h,c[u+2],23,3299628645),g,_,c[u+0],6,4096336452),_=a(_,h,m,g,c[u+7],10,1126891415),g=a(g,_,h,m,c[u+14],15,2878612391),m=a(m,g,_,h,c[u+5],21,4237533241),h=a(h,m,g,_,c[u+12],6,1700485571),_=a(_,h,m,g,c[u+3],10,2399980690),g=a(g,_,h,m,c[u+10],15,4293915773),m=a(m,g,_,h,c[u+1],21,2240044497),h=a(h,m,g,_,c[u+8],6,1873313359),_=a(_,h,m,g,c[u+15],10,4264355552),g=a(g,_,h,m,c[u+6],15,2734768916),m=a(m,g,_,h,c[u+13],21,1309151649),h=a(h,m,g,_,c[u+4],6,4149444226),_=a(_,h,m,g,c[u+11],10,3174756917),g=a(g,_,h,m,c[u+2],15,718787259),m=a(m,g,_,h,c[u+9],21,3951481745),h=n(h,l),m=n(m,d),g=n(g,p),_=n(_,f);return(s(h)+s(m)+s(g)+s(_)).toLowerCase()}},this.Agent={},this.getBrowser=function(e){switch(!0){case this._Browsers.Edge.test(e):return this.Agent.isEdge=!0,"Edge";case this._Browsers.PhantomJS.test(e):return this.Agent.isPhantomJS=!0,"PhantomJS";case this._Browsers.Konqueror.test(e):return this.Agent.isKonqueror=!0,"Konqueror";case this._Browsers.Amaya.test(e):return this.Agent.isAmaya=!0,"Amaya";case this._Browsers.Epiphany.test(e):return this.Agent.isEpiphany=!0,"Epiphany";case this._Browsers.SeaMonkey.test(e):return this.Agent.isSeaMonkey=!0,"SeaMonkey";case this._Browsers.Flock.test(e):return this.Agent.isFlock=!0,"Flock";case this._Browsers.OmniWeb.test(e):return this.Agent.isOmniWeb=!0,"OmniWeb";case this._Browsers.Opera.test(e):return this.Agent.isOpera=!0,"Opera";case this._Browsers.Chromium.test(e):return this.Agent.isChrome=!0,"Chromium";case this._Browsers.Chrome.test(e):return this.Agent.isChrome=!0,"Chrome";case this._Browsers.Safari.test(e):return this.Agent.isSafari=!0,"Safari";case this._Browsers.WinJs.test(e):return this.Agent.isWinJs=!0,"WinJs";case this._Browsers.IE.test(e):return this.Agent.isIE=!0,"IE";case this._Browsers.PS3.test(e):return"ps3";case this._Browsers.PSP.test(e):return"psp";case this._Browsers.Firefox.test(e):return this.Agent.isFirefox=!0,"Firefox";case this._Browsers.UC.test(e):return this.Agent.isUC=!0,"UCBrowser";default:return 0!==e.indexOf("Mozilla")&&/^([\d\w\-\.]+)\/[\d\w\.\-]+/i.test(e)?(this.Agent.isAuthoritative=!1,RegExp.$1):"unknown"}},this.getBrowserVersion=function(e){switch(this.Agent.browser){case"Edge":if(this._Versions.Edge.test(e))return RegExp.$1;break;case"PhantomJS":if(this._Versions.PhantomJS.test(e))return RegExp.$1;break;case"Chrome":if(this._Versions.Chrome.test(e))return RegExp.$1;break;case"Chromium":if(this._Versions.Chromium.test(e))return RegExp.$1;break;case"Safari":if(this._Versions.Safari.test(e))return RegExp.$1;break;case"Opera":if(this._Versions.Opera.test(e))return RegExp.$1?RegExp.$1:RegExp.$2;break;case"Firefox":if(this._Versions.Firefox.test(e))return RegExp.$1;break;case"WinJs":if(this._Versions.WinJs.test(e))return RegExp.$1;break;case"IE":if(this._Versions.IE.test(e))return RegExp.$2?RegExp.$2:RegExp.$1;break;case"ps3":if(this._Versions.Ps3.test(e))return RegExp.$1;break;case"psp":if(this._Versions.Psp.test(e))return RegExp.$1;break;case"Amaya":if(this._Versions.Amaya.test(e))return RegExp.$1;break;case"Epiphany":if(this._Versions.Epiphany.test(e))return RegExp.$1;break;case"SeaMonkey":if(this._Versions.SeaMonkey.test(e))return RegExp.$1;break;case"Flock":if(this._Versions.Flock.test(e))return RegExp.$1;break;case"OmniWeb":if(this._Versions.OmniWeb.test(e))return RegExp.$1;break;case"UCBrowser":if(this._Versions.UC.test(e))return RegExp.$1;break;default:if("unknown"!==this.Agent.browser&&new RegExp(this.Agent.browser+"[\\/ ]([\\d\\w\\.\\-]+)","i").test(e))return RegExp.$1}},this.getOS=function(e){switch(!0){case this._OS.WindowsVista.test(e):return this.Agent.isWindows=!0,"Windows Vista";case this._OS.Windows7.test(e):return this.Agent.isWindows=!0,"Windows 7";case this._OS.Windows8.test(e):return this.Agent.isWindows=!0,"Windows 8";case this._OS.Windows81.test(e):return this.Agent.isWindows=!0,"Windows 8.1";case this._OS.Windows10.test(e):return this.Agent.isWindows=!0,"Windows 10.0";case this._OS.Windows2003.test(e):return this.Agent.isWindows=!0,"Windows 2003";case this._OS.WindowsXP.test(e):return this.Agent.isWindows=!0,"Windows XP";case this._OS.Windows2000.test(e):return this.Agent.isWindows=!0,"Windows 2000";case this._OS.WindowsPhone8.test(e):return"Windows Phone 8";case this._OS.Linux64.test(e):return this.Agent.isLinux=!0,this.Agent.isLinux64=!0,"Linux 64";case this._OS.Linux.test(e):return this.Agent.isLinux=!0,"Linux";case this._OS.ChromeOS.test(e):return this.Agent.isChromeOS=!0,"Chrome OS";case this._OS.Wii.test(e):return"Wii";case this._OS.PS3.test(e):case this._OS.PSP.test(e):return"Playstation";case this._OS.OSXCheetah.test(e):return this.Agent.isMac=!0,"OS X Cheetah";case this._OS.OSXPuma.test(e):return this.Agent.isMac=!0,"OS X Puma";case this._OS.OSXJaguar.test(e):return this.Agent.isMac=!0,"OS X Jaguar";case this._OS.OSXPanther.test(e):return this.Agent.isMac=!0,"OS X Panther";case this._OS.OSXTiger.test(e):return this.Agent.isMac=!0,"OS X Tiger";case this._OS.OSXLeopard.test(e):return this.Agent.isMac=!0,"OS X Leopard";case this._OS.OSXSnowLeopard.test(e):return this.Agent.isMac=!0,"OS X Snow Leopard";case this._OS.OSXLion.test(e):return this.Agent.isMac=!0,"OS X Lion";case this._OS.OSXMountainLion.test(e):return this.Agent.isMac=!0,"OS X Mountain Lion";case this._OS.OSXMavericks.test(e):return this.Agent.isMac=!0,"OS X Mavericks";case this._OS.OSXYosemite.test(e):return this.Agent.isMac=!0,"OS X Yosemite";case this._OS.OSXElCapitan.test(e):return this.Agent.isMac=!0,"OS X El Capitan";case this._OS.OSXSierra.test(e):return this.Agent.isMac=!0,"macOS Sierra";case this._OS.Mac.test(e):return this.Agent.isMac=!0,"OS X";case this._OS.iPad.test(e):return this.Agent.isiPad=!0,e.match(this._OS.iPad)[0].replace("_",".");case this._OS.iPhone.test(e):return this.Agent.isiPhone=!0,e.match(this._OS.iPhone)[0].replace("_",".");case this._OS.Bada.test(e):return this.Agent.isBada=!0,"Bada";case this._OS.Curl.test(e):return this.Agent.isCurl=!0,"Curl";default:return"unknown"}},this.getPlatform=function(e){switch(!0){case this._Platform.Windows.test(e):return"Microsoft Windows";case this._Platform.WindowsPhone.test(e):return this.Agent.isWindowsPhone=!0,"Microsoft Windows Phone";case this._Platform.Mac.test(e):return"Apple Mac";case this._Platform.Curl.test(e):return"Curl";case this._Platform.Android.test(e):return this.Agent.isAndroid=!0,"Android";case this._Platform.Blackberry.test(e):return this.Agent.isBlackberry=!0,"Blackberry";case this._Platform.Linux.test(e):return"Linux";case this._Platform.Wii.test(e):return"Wii";case this._Platform.Playstation.test(e):return"Playstation";case this._Platform.iPad.test(e):return this.Agent.isiPad=!0,"iPad";case this._Platform.iPod.test(e):return this.Agent.isiPod=!0,"iPod";case this._Platform.iPhone.test(e):return this.Agent.isiPhone=!0,"iPhone";case this._Platform.Samsung.test(e):return this.Agent.isiSamsung=!0,"Samsung";default:return"unknown"}},this.testCompatibilityMode=function(){var e=this;if(this.Agent.isIE&&/Trident\/(\d)\.0/i.test(e.Agent.source)){var t=parseInt(RegExp.$1,10),n=parseInt(e.Agent.version,10);7===n&&7===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=11),7===n&&6===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=10),7===n&&5===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=9),7===n&&4===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=8)}},this.testSilk=function(){switch(!0){case new RegExp("silk","gi").test(this.Agent.source):this.Agent.isSilk=!0}return/Silk-Accelerated=true/gi.test(this.Agent.source)&&(this.Agent.SilkAccelerated=!0),!!this.Agent.isSilk&&"Silk"},this.testKindleFire=function(){var e=this;switch(!0){case/KFOT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire";case/KFTT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD";case/KFJWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9";case/KFJWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9 4G";case/KFSOWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 7";case/KFTHWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7";case/KFTHWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7 4G";case/KFAPWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9";case/KFAPWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9 4G";default:return!1}},this.testCaptiveNetwork=function(){switch(!0){case/CaptiveNetwork/gi.test(this.Agent.source):return this.Agent.isCaptive=!0,this.Agent.isMac=!0,this.Agent.platform="Apple Mac","CaptiveNetwork";default:return!1}},this.testMobile=function(){var e=this;switch(!0){case e.Agent.isWindows:case e.Agent.isLinux:case e.Agent.isMac:case e.Agent.isChromeOS:e.Agent.isDesktop=!0;break;case e.Agent.isAndroid:case e.Agent.isSamsung:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}switch(!0){case e.Agent.isiPad:case e.Agent.isiPod:case e.Agent.isiPhone:case e.Agent.isBada:case e.Agent.isBlackberry:case e.Agent.isAndroid:case e.Agent.isWindowsPhone:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}/mobile/i.test(e.Agent.source)&&(e.Agent.isMobile=!0,e.Agent.isDesktop=!1)},this.testTablet=function(){var e=this;switch(!0){case e.Agent.isiPad:case e.Agent.isAndroidTablet:case e.Agent.isKindleFire:e.Agent.isTablet=!0}/tablet/i.test(e.Agent.source)&&(e.Agent.isTablet=!0)},this.testNginxGeoIP=function(e){var t=this;Object.keys(e).forEach((function(n){/^GEOIP/i.test(n)&&(t.Agent.geoIp[n]=e[n])}))},this.testBot=function(){var e=this,t=n.exec(e.Agent.source.toLowerCase());t?e.Agent.isBot=t[1]:e.Agent.isAuthoritative||(e.Agent.isBot=/bot/i.test(e.Agent.source))},this.testSmartTV=function(){var e=new RegExp("smart-tv|smarttv|googletv|appletv|hbbtv|pov_tv|netcast.tv","gi").exec(this.Agent.source.toLowerCase());e&&(this.Agent.isSmartTV=e[1])},this.testAndroidTablet=function(){this.Agent.isAndroid&&!/mobile/i.test(this.Agent.source)&&(this.Agent.isAndroidTablet=!0)},this.testTouchSupport=function(){this.Agent.isTouchScreen="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},this.getLaguage=function(){this.Agent.language=(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase()},this.getColorDepth=function(){this.Agent.colorDepth=screen.colorDepth||-1},this.getScreenResolution=function(){this.Agent.resolution=[screen.availWidth,screen.availHeight]},this.getPixelDepth=function(){this.Agent.pixelDepth=screen.pixelDepth||-1},this.getCPU=function(){this.Agent.cpuCores=navigator.hardwareConcurrency||-1},this.reset=function(){var e=this;for(var t in e.DefaultAgent)e.DefaultAgent.hasOwnProperty(t)&&(e.Agent[t]=e.DefaultAgent[t]);return e},this.parse=function(t){t=t||navigator.userAgent;var n=new e;return n.Agent.source=t.replace(/^\s*/,"").replace(/\s*$/,""),n.Agent.os=n.getOS(n.Agent.source),n.Agent.platform=n.getPlatform(n.Agent.source),n.Agent.browser=n.getBrowser(n.Agent.source),n.Agent.version=n.getBrowserVersion(n.Agent.source),n.testBot(),n.testSmartTV(),n.testMobile(),n.testAndroidTablet(),n.testTablet(),n.testCompatibilityMode(),n.testSilk(),n.testKindleFire(),n.testCaptiveNetwork(),n.testTouchSupport(),n.getLaguage(),n.getColorDepth(),n.getPixelDepth(),n.getScreenResolution(),n.getCPU(),n.Agent},this.get=function(e){var t=this.parse(),n=[];for(var r in this.options)this.options.hasOwnProperty(r)&&!0===this.options[r]&&n.push(t[r]);e&&n.push(e),!this.options.resolution&&t.isMobile&&n.push(t.resolution);var i=t.hashMD5(n.join(":"));return[i.slice(0,8),i.slice(8,12),"4"+i.slice(12,15),"b"+i.slice(15,18),i.slice(20)].join("-")},this.Agent=this.DefaultAgent,this}},function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},function(e,t,n){n(139),e.exports=n(140)},function(e,t,n){var r;e.exports=(r=n(0),n(11),n(59),n(60),n(6),n(7),n(15),n(29),n(61),n(30),n(62),n(63),n(64),n(16),n(65),n(5),n(1),n(66),n(67),n(68),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),r)},function(e,t,n){var r;e.exports=(r=n(0),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],i=0;i<n;i++)r[i>>>2]|=e[i]<<24-i%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),r.lib.WordArray)},function(e,t,n){var r;e.exports=(r=n(0),function(){var e=r,t=e.lib.WordArray,n=e.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var o=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var n=e.length,r=[],i=0;i<n;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return t.create(r,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var a=i(t[o>>>2]>>>16-o%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var n=e.length,r=[],o=0;o<n;o++)r[o>>>1]|=i(e.charCodeAt(o)<<16-o%2*16);return t.create(r,2*n)}}}(),r.enc.Utf16)},function(e,t,n){var r,i,o,a,s,c;e.exports=(c=n(0),n(29),i=(r=c).lib.WordArray,o=r.algo,a=o.SHA256,s=o.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),r.SHA224=a._createHelper(s),r.HmacSHA224=a._createHmacHelper(s),c.SHA224)},function(e,t,n){var r,i,o,a,s,c,u,l;e.exports=(l=n(0),n(11),n(30),i=(r=l).x64,o=i.Word,a=i.WordArray,s=r.algo,c=s.SHA512,u=s.SHA384=c.extend({_doReset:function(){this._hash=new a.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),r.SHA384=c._createHelper(u),r.HmacSHA384=c._createHmacHelper(u),l.SHA384)},function(e,t,n){var r;e.exports=(r=n(0),n(11),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.x64.Word,s=t.algo,c=[],u=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,o=0;o<24;o++){for(var s=0,d=0,p=0;p<7;p++){if(1&i){var f=(1<<p)-1;f<32?d^=1<<f:s^=1<<f-32}128&i?i=i<<1^113:i<<=1}l[o]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var p=s.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var o=e[t+2*i],a=e[t+2*i+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(A=n[i]).high^=a,A.low^=o}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var f=0,h=0,m=0;m<5;m++)f^=(A=n[p+5*m]).high,h^=A.low;var g=d[p];g.high=f,g.low=h}for(p=0;p<5;p++){var _=d[(p+4)%5],v=d[(p+1)%5],y=v.high,b=v.low;for(f=_.high^(y<<1|b>>>31),h=_.low^(b<<1|y>>>31),m=0;m<5;m++)(A=n[p+5*m]).high^=f,A.low^=h}for(var w=1;w<25;w++){var S=(A=n[w]).high,k=A.low,C=c[w];C<32?(f=S<<C|k>>>32-C,h=k<<C|S>>>32-C):(f=k<<C-32|S>>>64-C,h=S<<C-32|k>>>64-C);var E=d[u[w]];E.high=f,E.low=h}var T=d[0],P=n[0];for(T.high=P.high,T.low=P.low,p=0;p<5;p++)for(m=0;m<5;m++){var A=n[w=p+5*m],R=d[w],O=d[(p+1)%5+5*m],x=d[(p+2)%5+5*m];A.high=R.high^~O.high&x.high,A.low=R.low^~O.low&x.low}A=n[0];var M=l[s];A.high^=M.high,A.low^=M.low}},_doFinalize:function(){var t=this._data,n=t.words,r=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(e.ceil((r+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,c=s/8,u=[],l=0;l<c;l++){var d=a[l],p=d.high,f=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),u.push(f),u.push(p)}return new i.init(u,s)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=o._createHelper(p),t.HmacSHA3=o._createHmacHelper(p)}(Math),r.SHA3)},function(e,t,n){var r;e.exports=(r=n(0),function(e){var t=r,n=t.lib,i=n.WordArray,o=n.Hasher,a=t.algo,s=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=i.create([0,1518500249,1859775393,2400959708,2840853838]),p=i.create([1352829926,1548603684,1836072691,2053994217,0]),f=a.RIPEMD160=o.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var o,a,f,b,w,S,k,C,E,T,P,A=this._hash.words,R=d.words,O=p.words,x=s.words,M=c.words,I=u.words,D=l.words;for(S=o=A[0],k=a=A[1],C=f=A[2],E=b=A[3],T=w=A[4],n=0;n<80;n+=1)P=o+e[t+x[n]]|0,P+=n<16?h(a,f,b)+R[0]:n<32?m(a,f,b)+R[1]:n<48?g(a,f,b)+R[2]:n<64?_(a,f,b)+R[3]:v(a,f,b)+R[4],P=(P=y(P|=0,I[n]))+w|0,o=w,w=b,b=y(f,10),f=a,a=P,P=S+e[t+M[n]]|0,P+=n<16?v(k,C,E)+O[0]:n<32?_(k,C,E)+O[1]:n<48?g(k,C,E)+O[2]:n<64?m(k,C,E)+O[3]:h(k,C,E)+O[4],P=(P=y(P|=0,D[n]))+T|0,S=T,T=E,E=y(C,10),C=k,k=P;P=A[1]+f+E|0,A[1]=A[2]+b+T|0,A[2]=A[3]+w+S|0,A[3]=A[4]+o+k|0,A[4]=A[0]+a+C|0,A[0]=P},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,o=i.words,a=0;a<5;a++){var s=o[a];o[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return i},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function m(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function _(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(f),t.HmacRIPEMD160=o._createHmacHelper(f)}(Math),r.RIPEMD160)},function(e,t,n){var r,i,o,a,s,c,u,l,d;e.exports=(d=n(0),n(15),n(16),i=(r=d).lib,o=i.Base,a=i.WordArray,s=r.algo,c=s.SHA1,u=s.HMAC,l=s.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=u.create(n.hasher,e),i=a.create(),o=a.create([1]),s=i.words,c=o.words,l=n.keySize,d=n.iterations;s.length<l;){var p=r.update(t).finalize(o);r.reset();for(var f=p.words,h=f.length,m=p,g=1;g<d;g++){m=r.finalize(m),r.reset();for(var _=m.words,v=0;v<h;v++)f[v]^=_[v]}i.concat(p),c[0]++}return i.sigBytes=4*l,i}}),r.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},d.PBKDF2)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,n,r){var i=this._iv;if(i){var o=i.slice(0);this._iv=void 0}else o=this._prevBlock;r.encryptBlock(o,0);for(var a=0;a<n;a++)e[t+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize;t.call(this,e,n,i,r),this._prevBlock=e.slice(n,n+i)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=e.slice(n,n+i);t.call(this,e,n,i,r),this._prevBlock=o}}),e}(),r.mode.CFB)},function(e,t,n){var r,i,o;e.exports=(o=n(0),n(1),o.mode.CTR=(r=o.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._counter;i&&(o=this._counter=i.slice(0),this._iv=void 0);var a=o.slice(0);n.encryptBlock(a,0),o[r-1]=o[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}}),r.Decryptor=i,r),o.mode.CTR)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,i=r.blockSize,o=this._iv,a=this._counter;o&&(a=this._counter=o.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var c=0;c<i;c++)e[n+c]^=s[c]}});return e.Decryptor=n,e}(),r.mode.CTRGladman)},function(e,t,n){var r,i,o;e.exports=(o=n(0),n(1),o.mode.OFB=(r=o.lib.BlockCipherMode.extend(),i=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,o=this._keystream;i&&(o=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(o,0);for(var a=0;a<r;a++)e[t+a]^=o[a]}}),r.Decryptor=i,r),o.mode.OFB)},function(e,t,n){var r,i;e.exports=(i=n(0),n(1),i.mode.ECB=((r=i.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),i.mode.ECB)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,o=n+i-1;e.clamp(),e.words[o>>>2]|=i<<24-o%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.pad.Iso10126={pad:function(e,t){var n=4*t,i=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(i-1)).concat(r.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},r.pad.ZeroPadding)},function(e,t,n){var r;e.exports=(r=n(0),n(1),r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)},function(e,t,n){var r,i,o,a;e.exports=(a=n(0),n(1),i=(r=a).lib.CipherParams,o=r.enc.Hex,r.format.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return i.create({ciphertext:t})}},a.format.Hex)},function(e,t,n){var r;e.exports=(r=n(0),n(6),n(7),n(5),n(1),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,i=[],o=[],a=[],s=[],c=[],u=[],l=[],d=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var h=r^r<<1^r<<2^r<<3^r<<4;h=h>>>8^255&h^99,i[n]=h,o[h]=n;var m=e[n],g=e[m],_=e[g],v=257*e[h]^16843008*h;a[n]=v<<24|v>>>8,s[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,u[n]=v,v=16843009*_^65537*g^257*m^16843008*n,l[h]=v<<24|v>>>8,d[h]=v<<16|v>>>16,p[h]=v<<8|v>>>24,f[h]=v,n?(n=m^e[e[e[_^m]]],r^=e[e[r]]):n=r=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],m=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),o=this._keySchedule=[],a=0;a<r;a++)if(a<n)o[a]=t[a];else{var s=o[a-1];a%n?n>6&&a%n==4&&(s=i[s>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s]):(s=i[(s=s<<8|s>>>24)>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s],s^=h[a/n|0]<<24),o[a]=o[a-n]^s}for(var c=this._invKeySchedule=[],u=0;u<r;u++)a=r-u,s=u%4?o[a]:o[a-4],c[u]=u<4||a<=4?s:l[i[s>>>24]]^d[i[s>>>16&255]]^p[i[s>>>8&255]]^f[i[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,p,f,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,a,s){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],f=4,h=1;h<c;h++){var m=r[u>>>24]^i[l>>>16&255]^o[d>>>8&255]^a[255&p]^n[f++],g=r[l>>>24]^i[d>>>16&255]^o[p>>>8&255]^a[255&u]^n[f++],_=r[d>>>24]^i[p>>>16&255]^o[u>>>8&255]^a[255&l]^n[f++],v=r[p>>>24]^i[u>>>16&255]^o[l>>>8&255]^a[255&d]^n[f++];u=m,l=g,d=_,p=v}m=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[f++],g=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&u])^n[f++],_=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^n[f++],v=(s[p>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[f++],e[t]=m,e[t+1]=g,e[t+2]=_,e[t+3]=v},keySize:8});e.AES=t._createHelper(m)}(),r.AES)},function(e,t,n){var r;e.exports=(r=n(0),n(6),n(7),n(5),n(1),function(){var e=r,t=e.lib,n=t.WordArray,i=t.BlockCipher,o=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=a[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],o=0;o<16;o++){var u=i[o]=[],l=c[o];for(n=0;n<24;n++)u[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,u[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(u[0]=u[0]<<1|u[0]>>>31,n=1;n<7;n++)u[n]=u[n]>>>4*(n-1)+3;u[7]=u[7]<<5|u[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),p.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],o=this._lBlock,a=this._rBlock,s=0,c=0;c<8;c++)s|=u[c][((a^i[c])&l[c])>>>0];this._lBlock=a,this._rBlock=o^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function f(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=i._createHelper(d);var h=o.TripleDES=i.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(n.create(e.slice(0,2))),this._des2=d.createEncryptor(n.create(e.slice(2,4))),this._des3=d.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=i._createHelper(h)}(),r.TripleDES)},function(e,t,n){var r;e.exports=(r=n(0),n(6),n(7),n(5),n(1),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var o=0;i<256;i++){var a=i%n,s=t[a>>>2]>>>24-a%4*8&255;o=(o+r[i]+s)%256;var c=r[i];r[i]=r[o],r[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[n],e[n]=o,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}e.RC4=t._createHelper(i);var a=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(a)}(),r.RC4)},function(e,t,n){var r;e.exports=(r=n(0),n(6),n(7),n(5),n(1),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],a=[],s=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var o=t.words,a=o[0],s=o[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(i[0]^=u,i[1]^=d,i[2]^=l,i[3]^=p,i[4]^=u,i[5]^=d,i[6]^=l,i[7]^=p,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,s=r>>>16,c=((i*i>>>17)+i*s>>>15)+s*s,u=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),r.Rabbit)},function(e,t,n){var r;e.exports=(r=n(0),n(6),n(7),n(5),n(1),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,i=[],o=[],a=[],s=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)c.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var o=t.words,a=o[0],s=o[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=u>>>16|4294901760&l,p=l<<16|65535&u;for(r[0]^=u,r[1]^=d,r[2]^=l,r[3]^=p,r[4]^=u,r[5]^=d,r[6]^=l,r[7]^=p,i=0;i<4;i++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),i[0]=n[0]^n[5]>>>16^n[3]<<16,i[1]=n[2]^n[7]>>>16^n[5]<<16,i[2]=n[4]^n[1]>>>16^n[7]<<16,i[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,s=r>>>16,c=((i*i>>>17)+i*s>>>15)+s*s,u=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),r.RabbitLegacy)},function(e,t){e.exports={aes_secret:">|Z2i580Py*4C3r"}},function(e,t,n){"use strict";var r=n(12),i=n(85),o=n(89),a=n(90)||0;function s(){return i(a)}e.exports=s,e.exports.generate=s,e.exports.seed=function(t){return r.seed(t),e.exports},e.exports.worker=function(t){return a=t,e.exports},e.exports.characters=function(e){return void 0!==e&&r.characters(e),r.shuffled()},e.exports.isValid=o},function(e,t,n){"use strict";var r=1;e.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(e){r=e}}},function(e,t,n){"use strict";var r,i,o=n(86);n(12);e.exports=function(e){var t="",n=Math.floor(.001*(Date.now()-1567752802062));return n===i?r++:(r=0,i=n),t+=o(7),t+=o(e),r>0&&(t+=o(r)),t+=o(n)}},function(e,t,n){"use strict";var r=n(12),i=n(87),o=n(88);e.exports=function(e){for(var t,n=0,a="";!t;)a+=o(i,r.get(),1),t=e<Math.pow(16,n+1),n++;return a}},function(e,t,n){"use strict";var r,i="object"==typeof window&&(window.crypto||window.msCrypto);r=i&&i.getRandomValues?function(e){return i.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],n=0;n<e;n++)t.push(Math.floor(256*Math.random()));return t},e.exports=r},function(e,t){e.exports=function(e,t,n){for(var r=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*r*n/t.length),o="";;)for(var a=e(i),s=i;s--;)if((o+=t[a[s]&r]||"").length===+n)return o}},function(e,t,n){"use strict";var r=n(12);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6)&&!new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e)}},function(e,t,n){"use strict";e.exports=0},function(e,t,n){"use strict";var r;window.jscolor||(window.jscolor=((r={register:function(){r.attachDOMReadyEvent(r.init),r.attachEvent(document,"mousedown",r.onDocumentMouseDown),r.attachEvent(document,"touchstart",r.onDocumentTouchStart),r.attachEvent(window,"resize",r.onWindowResize)},init:function(){r.jscolor.lookupClass&&r.jscolor.installByClassName(r.jscolor.lookupClass)},tryInstallOnElements:function(e,t){for(var n=new RegExp("(^|\\s)("+t+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),i=0;i<e.length;i+=1){var o;if((void 0===e[i].type||"color"!=e[i].type.toLowerCase()||!r.isColorAttrSupported)&&!e[i].jscolor&&e[i].className&&(o=e[i].className.match(n))){var a=e[i],s=null,c=r.getDataAttr(a,"jscolor");null!==c?s=c:o[4]&&(s=o[4]);var u={};if(s)try{u=new Function("return ("+s+")")()}catch(e){r.warn("Error parsing jscolor options: "+e+":\n"+s)}a.jscolor=new r.jscolor(a,u)}}},isColorAttrSupported:function(){var e=document.createElement("input");return!(!e.setAttribute||(e.setAttribute("type","color"),"color"!=e.type.toLowerCase()))}(),isCanvasSupported:function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},isElementType:function(e,t){return e.nodeName.toLowerCase()===t.toLowerCase()},getDataAttr:function(e,t){var n="data-"+t,r=e.getAttribute(n);return null!==r?r:null},attachEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},detachEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},_attachedGroupEvents:{},attachGroupEvent:function(e,t,n,i){r._attachedGroupEvents.hasOwnProperty(e)||(r._attachedGroupEvents[e]=[]),r._attachedGroupEvents[e].push([t,n,i]),r.attachEvent(t,n,i)},detachGroupEvents:function(e){if(r._attachedGroupEvents.hasOwnProperty(e)){for(var t=0;t<r._attachedGroupEvents[e].length;t+=1){var n=r._attachedGroupEvents[e][t];r.detachEvent(n[0],n[1],n[2])}delete r._attachedGroupEvents[e]}},attachDOMReadyEvent:function(e){var t=!1,n=function(){t||(t=!0,e())};"complete"!==document.readyState?document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),n())})),window.attachEvent("onload",n),document.documentElement.doScroll&&window==window.top)&&function e(){if(document.body)try{document.documentElement.doScroll("left"),n()}catch(t){setTimeout(e,1)}}():setTimeout(n,1)},warn:function(e){window.console&&window.console.warn&&window.console.warn(e)},preventDefault:function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1},captureTarget:function(e){e.setCapture&&(r._capturedTarget=e,r._capturedTarget.setCapture())},releaseTarget:function(){r._capturedTarget&&(r._capturedTarget.releaseCapture(),r._capturedTarget=null)},fireEvent:function(e,t){if(e)if(document.createEvent)(n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),e.dispatchEvent(n);else if(document.createEventObject){var n=document.createEventObject();e.fireEvent("on"+t,n)}else e["on"+t]&&e["on"+t]()},classNameToList:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(e,t){return!!t&&-1!=(" "+e.className.replace(/\s+/g," ")+" ").indexOf(" "+t+" ")},setClass:function(e,t){for(var n=r.classNameToList(t),i=0;i<n.length;i+=1)r.hasClass(e,n[i])||(e.className+=(e.className?" ":"")+n[i])},unsetClass:function(e,t){for(var n=r.classNameToList(t),i=0;i<n.length;i+=1){var o=new RegExp("^\\s*"+n[i]+"\\s*|\\s*"+n[i]+"\\s*$|\\s+"+n[i]+"(\\s+)","g");e.className=e.className.replace(o,"$1")}},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},setStyle:function(){var e=document.createElement("div"),t=function(t){for(var n=0;n<t.length;n+=1)if(t[n]in e.style)return t[n]},n={borderRadius:t(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:t(["boxShadow","MozBoxShadow","webkitBoxShadow"])};return function(e,t,r){switch(t.toLowerCase()){case"opacity":var i=Math.round(100*parseFloat(r));e.style.opacity=r,e.style.filter="alpha(opacity="+i+")";break;default:e.style[n[t]]=r}}}(),setBorderRadius:function(e,t){r.setStyle(e,"borderRadius",t||"0")},setBoxShadow:function(e,t){r.setStyle(e,"boxShadow",t||"none")},getElementPos:function(e,t){var n=0,i=0,o=e.getBoundingClientRect();if(n=o.left,i=o.top,!t){var a=r.getViewPos();n+=a[0],i+=a[1]}return[n,i]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getAbsPointerPos:function(e){e||(e=window.event);var t=0,n=0;return void 0!==e.changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(t=e.clientX,n=e.clientY),{x:t,y:n}},getRelPointerPos:function(e){e||(e=window.event);var t=(e.target||e.srcElement).getBoundingClientRect(),n=0,r=0;return void 0!==e.changedTouches&&e.changedTouches.length?(n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(n=e.clientX,r=e.clientY),{x:n-t.left,y:r-t.top}},getViewPos:function(){var e=document.documentElement;return[(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),(window.pageYOffset||e.scrollTop)-(e.clientTop||0)]},getViewSize:function(){var e=document.documentElement;return[window.innerWidth||e.clientWidth,window.innerHeight||e.clientHeight]},redrawPosition:function(){if(r.picker&&r.picker.owner){var e,t,n=r.picker.owner;n.fixed?(e=r.getElementPos(n.targetElement,!0),t=[0,0]):(e=r.getElementPos(n.targetElement),t=r.getViewPos());var i,o,a,s=r.getElementSize(n.targetElement),c=r.getViewSize(),u=r.getPickerOuterDims(n);switch(n.position.toLowerCase()){case"left":i=1,o=0,a=-1;break;case"right":i=1,o=0,a=1;break;case"top":i=0,o=1,a=-1;break;default:i=0,o=1,a=1}var l=(s[o]+u[o])/2;if(n.smartPosition)d=[-t[i]+e[i]+u[i]>c[i]&&-t[i]+e[i]+s[i]/2>c[i]/2&&e[i]+s[i]-u[i]>=0?e[i]+s[i]-u[i]:e[i],-t[o]+e[o]+s[o]+u[o]-l+l*a>c[o]?-t[o]+e[o]+s[o]/2>c[o]/2&&e[o]+s[o]-l-l*a>=0?e[o]+s[o]-l-l*a:e[o]+s[o]-l+l*a:e[o]+s[o]-l+l*a>=0?e[o]+s[o]-l+l*a:e[o]+s[o]-l-l*a];else var d=[e[i],e[o]+s[o]-l+l*a];var p=d[i],f=d[o],h=n.fixed?"fixed":"absolute",m=(d[0]+u[0]>e[0]||d[0]<e[0]+s[0])&&d[1]+u[1]<e[1]+s[1];r._drawPosition(n,p,f,h,m)}},_drawPosition:function(e,t,n,i,o){var a=o?0:e.shadowBlur;r.picker.wrap.style.position=i,r.picker.wrap.style.left=t+"px",r.picker.wrap.style.top=n+"px",r.setBoxShadow(r.picker.boxS,e.shadow?new r.BoxShadow(0,a,e.shadowBlur,0,e.shadowColor):null)},getPickerDims:function(e){var t=!!r.getSliderComponent(e);return[2*e.insetWidth+2*e.padding+e.width+(t?2*e.insetWidth+r.getPadToSliderPadding(e)+e.sliderSize:0),2*e.insetWidth+2*e.padding+e.height+(e.closable?2*e.insetWidth+e.padding+e.buttonHeight:0)]},getPickerOuterDims:function(e){var t=r.getPickerDims(e);return[t[0]+2*e.borderWidth,t[1]+2*e.borderWidth]},getPadToSliderPadding:function(e){return Math.max(e.padding,1.5*(2*e.pointerBorderWidth+e.pointerThickness))},getPadYComponent:function(e){switch(e.mode.charAt(1).toLowerCase()){case"v":return"v"}return"s"},getSliderComponent:function(e){if(e.mode.length>2)switch(e.mode.charAt(2).toLowerCase()){case"s":return"s";case"v":return"v"}return null},onDocumentMouseDown:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?r.onControlPointerStart(e,t,t._jscControlName,"mouse"):r.picker&&r.picker.owner&&r.picker.owner.hide()},onDocumentTouchStart:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?r.onControlPointerStart(e,t,t._jscControlName,"touch"):r.picker&&r.picker.owner&&r.picker.owner.hide()},onWindowResize:function(e){r.redrawPosition()},onParentScroll:function(e){r.picker&&r.picker.owner&&r.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(e,t,n,i){var o=t._jscInstance;r.preventDefault(e),r.captureTarget(t);var a=function(o,a){r.attachGroupEvent("drag",o,r._pointerMoveEvent[i],r.onDocumentPointerMove(e,t,n,i,a)),r.attachGroupEvent("drag",o,r._pointerEndEvent[i],r.onDocumentPointerEnd(e,t,n,i))};if(a(document,[0,0]),window.parent&&window.frameElement){var s=window.frameElement.getBoundingClientRect(),c=[-s.left,-s.top];a(window.parent.window.document,c)}var u=r.getAbsPointerPos(e),l=r.getRelPointerPos(e);switch(r._pointerOrigin={x:u.x-l.x,y:u.y-l.y},n){case"pad":switch(r.getSliderComponent(o)){case"s":0===o.hsv[1]&&o.fromHSV(null,100,null);break;case"v":0===o.hsv[2]&&o.fromHSV(null,null,100)}r.setPad(o,e,0,0);break;case"sld":r.setSld(o,e,0)}r.dispatchFineChange(o)},onDocumentPointerMove:function(e,t,n,i,o){return function(e){var i=t._jscInstance;switch(n){case"pad":e||(e=window.event),r.setPad(i,e,o[0],o[1]),r.dispatchFineChange(i);break;case"sld":e||(e=window.event),r.setSld(i,e,o[1]),r.dispatchFineChange(i)}}},onDocumentPointerEnd:function(e,t,n,i){return function(e){var n=t._jscInstance;r.detachGroupEvents("drag"),r.releaseTarget(),r.dispatchChange(n)}},dispatchChange:function(e){e.valueElement&&r.isElementType(e.valueElement,"input")&&r.fireEvent(e.valueElement,"change")},dispatchFineChange:function(e){e.onFineChange&&("string"==typeof e.onFineChange?new Function(e.onFineChange):e.onFineChange).call(e)},setPad:function(e,t,n,i){var o=r.getAbsPointerPos(t),a=n+o.x-r._pointerOrigin.x-e.padding-e.insetWidth,s=i+o.y-r._pointerOrigin.y-e.padding-e.insetWidth,c=a*(360/(e.width-1)),u=100-s*(100/(e.height-1));switch(r.getPadYComponent(e)){case"s":e.fromHSV(c,u,null,r.leaveSld);break;case"v":e.fromHSV(c,null,u,r.leaveSld)}},setSld:function(e,t,n){var i=100-(n+r.getAbsPointerPos(t).y-r._pointerOrigin.y-e.padding-e.insetWidth)*(100/(e.height-1));switch(r.getSliderComponent(e)){case"s":e.fromHSV(null,i,null,r.leavePad);break;case"v":e.fromHSV(null,null,i,r.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,initVML:function(){if(!r._vmlReady){var e=document;if(e.namespaces[r._vmlNS]||e.namespaces.add(r._vmlNS,"urn:schemas-microsoft-com:vml"),!e.styleSheets[r._vmlCSS]){var t=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","rect","roundrect","oval","arc","image"],n=e.createStyleSheet();n.owningElement.id=r._vmlCSS;for(var i=0;i<t.length;i+=1)n.addRule(r._vmlNS+"\\:"+t[i],"behavior:url(#default#VML);")}r._vmlReady=!0}},createPalette:function(){var e={elm:null,draw:null};if(r.isCanvasSupported){var t=document.createElement("canvas"),n=t.getContext("2d"),i=function(e,r,i){t.width=e,t.height=r,n.clearRect(0,0,t.width,t.height);var o=n.createLinearGradient(0,0,t.width,0);o.addColorStop(0,"#F00"),o.addColorStop(1/6,"#FF0"),o.addColorStop(2/6,"#0F0"),o.addColorStop(.5,"#0FF"),o.addColorStop(4/6,"#00F"),o.addColorStop(5/6,"#F0F"),o.addColorStop(1,"#F00"),n.fillStyle=o,n.fillRect(0,0,t.width,t.height);var a=n.createLinearGradient(0,0,0,t.height);switch(i.toLowerCase()){case"s":a.addColorStop(0,"rgba(255,255,255,0)"),a.addColorStop(1,"rgba(255,255,255,1)");break;case"v":a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)")}n.fillStyle=a,n.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=i}else{r.initVML();var o=document.createElement("div");o.style.position="relative",o.style.overflow="hidden";var a=document.createElement(r._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="90",a.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var s=document.createElement(r._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),o.appendChild(s);var c=document.createElement(r._vmlNS+":fill");c.type="gradient",c.method="linear",c.angle="180",c.opacity="0";var u=document.createElement(r._vmlNS+":rect");u.style.position="absolute",u.style.left="-1px",u.style.top="-1px",u.stroked=!1,u.appendChild(c),o.appendChild(u),i=function(e,t,n){switch(o.style.width=e+"px",o.style.height=t+"px",s.style.width=u.style.width=e+1+"px",s.style.height=u.style.height=t+1+"px",a.color="#F00",a.color2="#F00",n.toLowerCase()){case"s":c.color=c.color2="#FFF";break;case"v":c.color=c.color2="#000"}},e.elm=o,e.draw=i}return e},createSliderGradient:function(){var e={elm:null,draw:null};if(r.isCanvasSupported){var t=document.createElement("canvas"),n=t.getContext("2d"),i=function(e,r,i,o){t.width=e,t.height=r,n.clearRect(0,0,t.width,t.height);var a=n.createLinearGradient(0,0,0,t.height);a.addColorStop(0,i),a.addColorStop(1,o),n.fillStyle=a,n.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=i}else{r.initVML();var o=document.createElement("div");o.style.position="relative",o.style.overflow="hidden";var a=document.createElement(r._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="180";var s=document.createElement(r._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),o.appendChild(s),i=function(e,t,n,r){o.style.width=e+"px",o.style.height=t+"px",s.style.width=e+1+"px",s.style.height=t+1+"px",a.color=n,a.color2=r},e.elm=o,e.draw=i}return e},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var e=function(e,t,n,r,i,o){this.hShadow=e,this.vShadow=t,this.blur=n,this.spread=r,this.color=i,this.inset=!!o};return e.prototype.toString=function(){var e=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];return this.inset&&e.push("inset"),e.join(" ")},e}(),jscolor:function(e,t){function n(e,t,n){var r=n/100*255;if(null===e)return[r,r,r];e/=60,t/=100;var i=Math.floor(e),o=r*(1-t),a=r*(1-t*(i%2?e-i:1-(e-i)));switch(i){case 6:case 0:return[r,a,o];case 1:return[a,r,o];case 2:return[o,r,a];case 3:return[o,a,r];case 4:return[a,o,r];case 5:return[r,o,a]}}function i(){d._processParentElementsInDOM(),r.picker||(r.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:r.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:r.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},r.picker.pad.appendChild(r.picker.padPal.elm),r.picker.padB.appendChild(r.picker.pad),r.picker.cross.appendChild(r.picker.crossBY),r.picker.cross.appendChild(r.picker.crossBX),r.picker.cross.appendChild(r.picker.crossLY),r.picker.cross.appendChild(r.picker.crossLX),r.picker.padB.appendChild(r.picker.cross),r.picker.box.appendChild(r.picker.padB),r.picker.box.appendChild(r.picker.padM),r.picker.sld.appendChild(r.picker.sldGrad.elm),r.picker.sldB.appendChild(r.picker.sld),r.picker.sldB.appendChild(r.picker.sldPtrOB),r.picker.sldPtrOB.appendChild(r.picker.sldPtrMB),r.picker.sldPtrMB.appendChild(r.picker.sldPtrIB),r.picker.sldPtrIB.appendChild(r.picker.sldPtrS),r.picker.box.appendChild(r.picker.sldB),r.picker.box.appendChild(r.picker.sldM),r.picker.btn.appendChild(r.picker.btnT),r.picker.box.appendChild(r.picker.btn),r.picker.boxB.appendChild(r.picker.box),r.picker.wrap.appendChild(r.picker.boxS),r.picker.wrap.appendChild(r.picker.boxB));var e=r.picker,t=!!r.getSliderComponent(d),n=r.getPickerDims(d),i=2*d.pointerBorderWidth+d.pointerThickness+2*d.crossSize,s=r.getPadToSliderPadding(d),c=Math.min(d.borderRadius,Math.round(d.padding*Math.PI));e.wrap.style.clear="both",e.wrap.style.width=n[0]+2*d.borderWidth+"px",e.wrap.style.height=n[1]+2*d.borderWidth+"px",e.wrap.style.zIndex=d.zIndex,e.box.style.width=n[0]+"px",e.box.style.height=n[1]+"px",e.boxS.style.position="absolute",e.boxS.style.left="0",e.boxS.style.top="0",e.boxS.style.width="100%",e.boxS.style.height="100%",r.setBorderRadius(e.boxS,c+"px"),e.boxB.style.position="relative",e.boxB.style.border=d.borderWidth+"px solid",e.boxB.style.borderColor=d.borderColor,e.boxB.style.background=d.backgroundColor,r.setBorderRadius(e.boxB,c+"px"),e.padM.style.background=e.sldM.style.background="#FFF",r.setStyle(e.padM,"opacity","0"),r.setStyle(e.sldM,"opacity","0"),e.pad.style.position="relative",e.pad.style.width=d.width+"px",e.pad.style.height=d.height+"px",e.padPal.draw(d.width,d.height,r.getPadYComponent(d)),e.padB.style.position="absolute",e.padB.style.left=d.padding+"px",e.padB.style.top=d.padding+"px",e.padB.style.border=d.insetWidth+"px solid",e.padB.style.borderColor=d.insetColor,e.padM._jscInstance=d,e.padM._jscControlName="pad",e.padM.style.position="absolute",e.padM.style.left="0",e.padM.style.top="0",e.padM.style.width=d.padding+2*d.insetWidth+d.width+s/2+"px",e.padM.style.height=n[1]+"px",e.padM.style.cursor="crosshair",e.cross.style.position="absolute",e.cross.style.left=e.cross.style.top="0",e.cross.style.width=e.cross.style.height=i+"px",e.crossBY.style.position=e.crossBX.style.position="absolute",e.crossBY.style.background=e.crossBX.style.background=d.pointerBorderColor,e.crossBY.style.width=e.crossBX.style.height=2*d.pointerBorderWidth+d.pointerThickness+"px",e.crossBY.style.height=e.crossBX.style.width=i+"px",e.crossBY.style.left=e.crossBX.style.top=Math.floor(i/2)-Math.floor(d.pointerThickness/2)-d.pointerBorderWidth+"px",e.crossBY.style.top=e.crossBX.style.left="0",e.crossLY.style.position=e.crossLX.style.position="absolute",e.crossLY.style.background=e.crossLX.style.background=d.pointerColor,e.crossLY.style.height=e.crossLX.style.width=i-2*d.pointerBorderWidth+"px",e.crossLY.style.width=e.crossLX.style.height=d.pointerThickness+"px",e.crossLY.style.left=e.crossLX.style.top=Math.floor(i/2)-Math.floor(d.pointerThickness/2)+"px",e.crossLY.style.top=e.crossLX.style.left=d.pointerBorderWidth+"px",e.sld.style.overflow="hidden",e.sld.style.width=d.sliderSize+"px",e.sld.style.height=d.height+"px",e.sldGrad.draw(d.sliderSize,d.height,"#000","#000"),e.sldB.style.display=t?"block":"none",e.sldB.style.position="absolute",e.sldB.style.right=d.padding+"px",e.sldB.style.top=d.padding+"px",e.sldB.style.border=d.insetWidth+"px solid",e.sldB.style.borderColor=d.insetColor,e.sldM._jscInstance=d,e.sldM._jscControlName="sld",e.sldM.style.display=t?"block":"none",e.sldM.style.position="absolute",e.sldM.style.right="0",e.sldM.style.top="0",e.sldM.style.width=d.sliderSize+s/2+d.padding+2*d.insetWidth+"px",e.sldM.style.height=n[1]+"px",e.sldM.style.cursor="default",e.sldPtrIB.style.border=e.sldPtrOB.style.border=d.pointerBorderWidth+"px solid "+d.pointerBorderColor,e.sldPtrOB.style.position="absolute",e.sldPtrOB.style.left=-(2*d.pointerBorderWidth+d.pointerThickness)+"px",e.sldPtrOB.style.top="0",e.sldPtrMB.style.border=d.pointerThickness+"px solid "+d.pointerColor,e.sldPtrS.style.width=d.sliderSize+"px",e.sldPtrS.style.height=f+"px",e.btn.style.display=d.closable?"block":"none",e.btn.style.position="absolute",e.btn.style.left=d.padding+"px",e.btn.style.bottom=d.padding+"px",e.btn.style.padding="0 15px",e.btn.style.height=d.buttonHeight+"px",e.btn.style.border=d.insetWidth+"px solid",function(){var t=d.insetColor.split(/\s+/),n=t.length<2?t[0]:t[1]+" "+t[0]+" "+t[0]+" "+t[1];e.btn.style.borderColor=n}(),e.btn.style.color=d.buttonColor,e.btn.style.font="12px sans-serif",e.btn.style.textAlign="center";try{e.btn.style.cursor="pointer"}catch(t){e.btn.style.cursor="hand"}e.btn.onmousedown=function(){d.hide()},e.btnT.style.lineHeight=d.buttonHeight+"px",e.btnT.innerHTML="",e.btnT.appendChild(document.createTextNode(d.closeText)),o(),a(),r.picker.owner&&r.picker.owner!==d&&r.unsetClass(r.picker.owner.targetElement,d.activeClass),r.picker.owner=d,r.isElementType(p,"body")?r.redrawPosition():r._drawPosition(d,0,0,"relative",!1),e.wrap.parentNode!=p&&p.appendChild(e.wrap),r.setClass(d.targetElement,d.activeClass)}function o(){switch(r.getPadYComponent(d)){case"s":var e=1;break;case"v":e=2}var t=Math.round(d.hsv[0]/360*(d.width-1)),i=Math.round((1-d.hsv[e]/100)*(d.height-1)),o=2*d.pointerBorderWidth+d.pointerThickness+2*d.crossSize,a=-Math.floor(o/2);switch(r.picker.cross.style.left=t+a+"px",r.picker.cross.style.top=i+a+"px",r.getSliderComponent(d)){case"s":var s=n(d.hsv[0],100,d.hsv[2]),c=n(d.hsv[0],0,d.hsv[2]),u="rgb("+Math.round(s[0])+","+Math.round(s[1])+","+Math.round(s[2])+")",l="rgb("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+")";r.picker.sldGrad.draw(d.sliderSize,d.height,u,l);break;case"v":var p=n(d.hsv[0],d.hsv[1],100);u="rgb("+Math.round(p[0])+","+Math.round(p[1])+","+Math.round(p[2])+")",l="#000",r.picker.sldGrad.draw(d.sliderSize,d.height,u,l)}}function a(){var e=r.getSliderComponent(d);if(e){switch(e){case"s":var t=1;break;case"v":t=2}var n=Math.round((1-d.hsv[t]/100)*(d.height-1));r.picker.sldPtrOB.style.top=n-(2*d.pointerBorderWidth+d.pointerThickness)-Math.floor(f/2)+"px"}}function s(){return r.picker&&r.picker.owner===d}for(var c in this.value=null,this.valueElement=e,this.styleElement=e,this.required=!0,this.refine=!0,this.hash=!1,this.uppercase=!0,this.onFineChange=null,this.activeClass="jscolor-active",this.minS=0,this.maxS=100,this.minV=0,this.maxV=100,this.hsv=[0,0,100],this.rgb=[255,255,255],this.width=181,this.height=101,this.showOnClick=!0,this.mode="HSV",this.position="bottom",this.smartPosition=!0,this.sliderSize=16,this.crossSize=8,this.closable=!1,this.closeText="Close",this.buttonColor="#000000",this.buttonHeight=18,this.padding=12,this.backgroundColor="#FFFFFF",this.borderWidth=1,this.borderColor="#BBBBBB",this.borderRadius=8,this.insetWidth=1,this.insetColor="#BBBBBB",this.shadow=!0,this.shadowBlur=15,this.shadowColor="rgba(0,0,0,0.2)",this.pointerColor="#4C4C4C",this.pointerBorderColor="#FFFFFF",this.pointerBorderWidth=1,this.pointerThickness=2,this.zIndex=1e3,this.container=null,t)t.hasOwnProperty(c)&&(this[c]=t[c]);if(this.hide=function(){s()&&(r.unsetClass(d.targetElement,d.activeClass),r.picker.wrap.parentNode.removeChild(r.picker.wrap),delete r.picker.owner)},this.show=function(){i()},this.redraw=function(){s()&&i()},this.importColor=function(){this.valueElement&&r.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(r.leaveValue|r.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,r.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(r.leaveValue|r.leaveStyle)):this.exportColor()},this.exportColor=function(e){if(!(e&r.leaveValue)&&this.valueElement){var t=this.toString();this.uppercase&&(t=t.toUpperCase()),this.hash&&(t="#"+t),r.isElementType(this.valueElement,"input")?this.valueElement.value=t:this.valueElement.innerHTML=t}e&r.leaveStyle||this.styleElement&&(this.styleElement.style.backgroundImage="none",this.styleElement.style.backgroundColor="#"+this.toString(),this.styleElement.style.color=this.isLight()?"#000":"#FFF"),!(e&r.leavePad)&&s()&&o(),!(e&r.leaveSld)&&s()&&a()},this.fromHSV=function(e,t,r,i){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(360,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(100,this.maxS,t),this.minS)}if(null!==r){if(isNaN(r))return!1;r=Math.max(0,Math.min(100,this.maxV,r),this.minV)}this.rgb=n(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===r?this.hsv[2]:this.hsv[2]=r),this.exportColor(i)},this.fromRGB=function(e,t,r,i){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(255,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(255,t))}if(null!==r){if(isNaN(r))return!1;r=Math.max(0,Math.min(255,r))}var o=function(e,t,n){e/=255,t/=255,n/=255;var r=Math.min(Math.min(e,t),n),i=Math.max(Math.max(e,t),n),o=i-r;if(0===o)return[null,0,100*i];var a=e===r?3+(n-t)/o:t===r?5+(e-n)/o:1+(t-e)/o;return[60*(6===a?0:a),o/i*100,100*i]}(null===e?this.rgb[0]:e,null===t?this.rgb[1]:t,null===r?this.rgb[2]:r);null!==o[0]&&(this.hsv[0]=Math.max(0,Math.min(360,o[0]))),0!==o[2]&&(this.hsv[1]=null===o[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,o[1]))),this.hsv[2]=null===o[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,o[2]));var a=n(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=a[0],this.rgb[1]=a[1],this.rgb[2]=a[2],this.exportColor(i)},this.fromString=function(e,t){var n;if(n=e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16),parseInt(n[1].substr(2,2),16),parseInt(n[1].substr(4,2),16),t):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16),parseInt(n[1].charAt(1)+n[1].charAt(1),16),parseInt(n[1].charAt(2)+n[1].charAt(2),16),t),!0;if(n=e.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){var r,i,o,a=n[1].split(","),s=/^\s*(\d*)(\.\d+)?\s*$/;if(a.length>=3&&(r=a[0].match(s))&&(i=a[1].match(s))&&(o=a[2].match(s))){var c=parseFloat((r[1]||"0")+(r[2]||"")),u=parseFloat((i[1]||"0")+(i[2]||"")),l=parseFloat((o[1]||"0")+(o[2]||""));return this.fromRGB(c,u,l,t),!0}}return!1},this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)},this.toHEXString=function(){return"#"+this.toString().toUpperCase()},this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"},this.isLight=function(){return.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]>127.5},this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var e=this.targetElement;do{var t=r.getStyle(e);t&&"fixed"===t.position.toLowerCase()&&(this.fixed=!0),e!==this.targetElement&&(e._jscEventsAttached||(r.attachEvent(e,"scroll",r.onParentScroll),e._jscEventsAttached=!0))}while((e=e.parentNode)&&!r.isElementType(e,"body"))}},"string"==typeof e){var u=e,l=document.getElementById(u);l?this.targetElement=l:r.warn("Could not find target element with ID '"+u+"'")}else e?this.targetElement=e:r.warn("Invalid target element: '"+e+"'");if(this.targetElement._jscLinkedInstance)r.warn("Cannot link jscolor twice to the same element. Skipping.");else{this.targetElement._jscLinkedInstance=this,this.valueElement=r.fetchElement(this.valueElement),this.styleElement=r.fetchElement(this.styleElement);var d=this,p=this.container?r.fetchElement(this.container):document.getElementsByTagName("body")[0],f=3;if(r.isElementType(this.targetElement,"button"))if(this.targetElement.onclick){var h=this.targetElement.onclick;this.targetElement.onclick=function(e){return h.call(this,e),!1}}else this.targetElement.onclick=function(){return!1};if(this.valueElement&&r.isElementType(this.valueElement,"input")){var m=function(){d.fromString(d.valueElement.value,r.leaveValue),r.dispatchFineChange(d)};r.attachEvent(this.valueElement,"keyup",m),r.attachEvent(this.valueElement,"input",m),r.attachEvent(this.valueElement,"blur",(function(){d.importColor()})),this.valueElement.setAttribute("autocomplete","off")}this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color}),this.value?this.fromString(this.value)||this.exportColor():this.importColor()}}}).jscolor.lookupClass="jscolor",r.jscolor.installByClassName=function(e){var t=document.getElementsByTagName("input"),n=document.getElementsByTagName("button");r.tryInstallOnElements(t,e),r.tryInstallOnElements(n,e)},r.register(),r.jscolor))},function(e,t,n){"use strict";var r=n(3),i=n(31),o=n(94),a=n(17);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(a);c.Axios=o,c.create=function(e){return s(r.merge(a,e))},c.Cancel=n(35),c.CancelToken=n(107),c.isCancel=n(34),c.all=function(e){return Promise.all(e)},c.spread=n(108),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(17),i=n(3),o=n(102),a=n(103);function s(e){this.defaults=e,this.interceptors={request:new o,response:new o}}s.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],(function(e){s.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){s.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=s},function(e,t,n){"use strict";var r=n(3);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(33);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e}},function(e,t,n){"use strict";var r=n(3);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,n){"use strict";var r=n(3),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(3);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(3);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(3);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(3),i=n(104),o=n(34),a=n(17),s=n(105),c=n(106);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(3);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(35);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=109},function(e,t,n){var r,i,o=n(36),a=n(37),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==p){var f=o();null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=i=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=h-s+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=m,i=p;var _=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;l[u++]=_>>>24&255,l[u++]=_>>>16&255,l[u++]=_>>>8&255,l[u++]=255&_;var v=h/4294967296*1e4&268435455;l[u++]=v>>>8&255,l[u++]=255&v,l[u++]=v>>>24&15|16,l[u++]=v>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var y=0;y<6;++y)l[u+y]=d[y];return t||a(l)}},function(e,t,n){var r=n(36),i=n(37);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){var r=n(113),i=n(10)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a,s,c=n.exec(e||""),u={},l=14;l--;)u[r[l]]=c[l]||"";return-1!=i&&-1!=o&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,u.path),u.queryKey=(a=u.query,s={},a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(s[t]=n)})),s),u}},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a);var u=r.log||t.log||console.log.bind(console);u.apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(38),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){var r=n(39),i=n(40),o=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=function e(t,n){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(r(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],n);return a}if("object"==typeof t&&!(t instanceof Date)){a={};for(var c in t)a[c]=e(t[c],n);return a}return t}(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;!function e(c,u,l){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){n++;var d=new FileReader;d.onload=function(){l?l[u]=this.result:o=this.result,--n||t(o)},d.readAsArrayBuffer(c)}else if(r(c))for(var p=0;p<c.length;p++)e(c[p],p,c);else if("object"==typeof c&&!i(c))for(var f in c)e(c[f],f,c)}(o),n||t(o)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,o=f&(1<<-l)-1,f>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?p/c:p*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*c-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+f]=255&a,f+=h,a/=256,u-=8);e[n+f-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(120),e.exports.parser=n(8)},function(e,t,n){var r=n(42),i=n(26),o=n(14)("engine.io-client:socket"),a=n(46),s=n(8),c=n(134),u=n(27);function l(e,t){if(!(this instanceof l))return new l(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=l,l.priorWebsocketSuccess=!1,i(l.prototype),l.protocol=s.protocol,l.Socket=l,l.Transport=n(25),l.transports=n(42),l.parser=n(8),l.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var e;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},l.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},l.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;l.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{o('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,r.emit("upgradeError",a)}})))}function a(){n||(n=!0,p(),t.close(),t=null)}function s(n){var i=new Error("probe error: "+n);i.transport=t.name,a(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function c(){s("transport closed")}function u(){s("socket closed")}function d(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),a())}function p(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",c),r.removeListener("close",u),r.removeListener("upgrading",d)}l.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",c),this.once("close",u),this.once("upgrading",d),t.open()},l.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},l.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},l.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},l.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},l.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},l.prototype.onError=function(e){o("socket error %j",e),l.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},l.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},l.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){var r=n(23),i=n(43),o=n(26),a=n(13),s=n(14)("engine.io-client:polling-xhr"),c=n(24);function u(){}function l(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function d(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=l,e.exports.Request=d,a(l,i),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new d(e)},l.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",(function(e){i.onError("xhr post error",e)})),this.sendXhr=r},l.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},o(d.prototype),d.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=d.requestsCount++,d.requests[this.index]=this)},d.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},d.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},d.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},d.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete d.requests[this.index],this.xhr=null}},d.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},d.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},d.prototype.abort=function(){this.cleanup()},d.requestsCount=0,d.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",p);else if("function"==typeof addEventListener){addEventListener("onpagehide"in c?"pagehide":"unload",p,!1)}function p(){for(var e in d.requests)d.requests.hasOwnProperty(e)&&d.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){var i=!1;return r=r||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}}},function(e,t){var n,r,i,o=String.fromCharCode;function a(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return o(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return o(e);var n="";return 0==(4294965248&e)?n=o(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=o(e>>12&15|224),n+=c(e,6)):0==(4292870144&e)&&(n=o(e>>18&7|240),n+=c(e,12),n+=c(e,6)),n+=o(63&e|128)}function l(){if(i>=r)throw Error("Invalid byte index");var e=255&n[i];if(i++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var t,o;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(t=255&n[i],i++,0==(128&t))return t;if(192==(224&t)){if((o=(31&t)<<6|l())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if((o=(15&t)<<12|l()<<6|l())>=2048)return s(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(o=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),i=r.length,o=-1,s="";++o<i;)s+=u(r[o],n);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;n=a(e),r=n.length,i=0;for(var c,u=[];!1!==(c=d(s));)u.push(c);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(u)}}},function(e,t){!function(e){"use strict";t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(t){var n,r,i,o,a,s=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),d=new Uint8Array(l);for(n=0;n<c;n+=4)r=e.indexOf(t[n]),i=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),d[u++]=r<<2|i>>4,d[u++]=(15&i)<<4|o>>2,d[u++]=(3&o)<<6|63&a;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function a(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function s(e,t){t=t||{};var r=new n;return a(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function c(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=r?i?Blob:c:o?s:void 0},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a);var u=r.log||t.log||console.log.bind(console);u.apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(38),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){var r=n(43),i=n(13),o=n(24);e.exports=l;var a,s=/\n/g,c=/\\n/g;function u(){}function l(e){r.call(this,e),this.query=this.query||{},a||(a=o.___eio=o.___eio||[]),this.index=a.length;var t=this;a.push((function(e){t.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){t.script&&(t.script.onerror=u)}),!1)}i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},l.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=a,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function u(){l(),t()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),l(),e=e.replace(c,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}},function(e,t,n){(function(t){var r,i,o=n(25),a=n(8),s=n(27),c=n(13),u=n(45),l=n(14)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=n(133)}catch(e){}var d=r||i;function p(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(d=i),o.call(this,e)}e.exports=p,c(p,o),p.prototype.name="websocket",p.prototype.supportsBinary=!0,p.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new d(e,t):new d(e):new d(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},p.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},p.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,o=r;i<o;i++)!function(e){a.encodePacket(e,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),n.perMessageDeflate)("string"==typeof i?t.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){l("websocket closed before onclose event")}--r||s()}))}(e[i]);function s(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},p.prototype.onClose=function(){o.prototype.onClose.call(this)},p.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},p.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===p.prototype.name)}}).call(this,n(22).Buffer)},function(e,t){},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a,s,c=n.exec(e||""),u={},l=14;l--;)u[r[l]]=c[l]||"";return-1!=i&&-1!=o&&(u.source=t,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,u.path),u.queryKey=(a=u.query,s={},a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(s[t]=n)})),s),u}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";n.r(t);var r=function(e){return{type:"SET_CURRENT_PANE",currentPane:e}},i=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_TV_BOX_OPEN",isTvBoxOpen:e}};function o(e){"touchstart"===e.type?(window.tvInitialX=e.touches[0].clientX-window.tvXOffset,window.tvInitialY=e.touches[0].clientY-window.tvYOffset):(window.tvInitialX=e.clientX-window.tvXOffset,window.tvInitialY=e.clientY-window.tvYOffset);var t=document.querySelector("#tv_box__header"),n=document.querySelector("#tv_box__title"),r=document.querySelector("#tv_box__body");e.target!==t&&e.target!==n&&e.target!==r||(window.tvDragActive=!0)}function a(e){window.tvInitialX=window.tvCurrentX,window.tvInitialY=window.tvCurrentY,window.tvDragActive=!1}function s(e){var t,n;window.tvDragActive&&(e.preventDefault(),"touchmove"===e.type?(window.tvCurrentX=e.touches[0].clientX-window.tvInitialX,window.tvCurrentY=e.touches[0].clientY-window.tvInitialY):(window.tvCurrentX=e.clientX-window.tvInitialX,window.tvCurrentY=e.clientY-window.tvInitialY),window.tvXOffset=window.tvCurrentX,window.tvYOffset=window.tvCurrentY,t=window.tvCurrentX,n=window.tvCurrentY,document.querySelector("#tv_box").style.transform="translate3d("+t+"px, "+n+"px, 0)")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"register",value:function(){var e=document.querySelector("#chat");window.tvDragActive=!1,window.tvXOffset=window.tvXOffset?window.tvXOffset:0,window.tvYOffset=window.tvYOffset?window.tvYOffset:0,e.addEventListener("touchstart",o,!1),e.addEventListener("touchend",a,!1),e.addEventListener("touchmove",s,!1),e.addEventListener("mousedown",o,!1),e.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",s,!1)}},{key:"unregister",value:function(){var e=document.querySelector("#chat");e.removeEventListener("touchstart",o,!1),e.removeEventListener("touchend",a,!1),e.removeEventListener("touchmove",s,!1),e.removeEventListener("mousedown",o,!1),e.removeEventListener("mouseup",a,!1),e.removeEventListener("mousemove",s,!1)}}],(n=null)&&c(t.prototype,n),r&&c(t,r),e}();function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(t){$("#tv_box__close").unbind().on("click",(function(n){e.close(t)}))}},{key:"close",value:function(e){e.dispatch(i(!1)),u.unregister(),$("#tv_box").html("")}},{key:"open",value:function(t){t.getState().isTvBoxOpen||($("#tv_box").html(e.render(t)),t.dispatch(i(!0)),e.onClose(t),u.register())}},{key:"update",value:function(t){var n=t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"",r=e.parseURL(t.getState().settings.tv_box_url);$("#tv_box__title").text(n),$("#tv_box__body iframe").attr("src")!=r&&$("#tv_box__body iframe").attr("src",r)}},{key:"parseURL",value:function(e){if(!e)return"";var t=function(e){try{if(e.includes("youtube")){var t=e.split("v=")[1];if(!t)return null;var n=t.indexOf("&");return-1!=n?t.substring(0,n):t}if(!e.includes("youtu.be/"))return null;var r=e.split("youtu.be/"),i=r[0],o=r[1];if(i&&11==i.length)return i;if(o&&11==o.length)return o}catch(e){return null}}(e);return t?"https://www.youtube.com/embed/"+t+"?playsinline=1":e}},{key:"render",value:function(t){var n="<div>";return n+="<header id='tv_box__header' class='label label-primary'>",n+="<span id='tv_box__title'>"+(t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"")+"</span>",n+="<button id='tv_box__close' class='fa fa-close btn btn-danger'></button>",n+="</header>",n+="<div id='tv_box__body' class='fl'>",n+="<iframe src='"+e.parseURL(t.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",n+="</div>",n+="</div>"}}],(n=null)&&l(t.prototype,n),r&&l(t,r),e}();function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(e){$(".chat_pane__header button").on("click",(function(t){e.dispatch(r(null)),qt.togglePane(e,!0)}))}},{key:"render",value:function(e,t){var n="<div class='chat_pane__header label label-primary '>";return n+="<h3 "+(t?"style='text-align: center;'":"")+" class='label label-primary chat_pane__header__title'>"+e+"</h3>",n+="<button class='btn btn-danger fa fa-times chat_pane__header__close'></button>",n+="</div>"}}],(n=null)&&p(t.prototype,n),i&&p(t,i),e}(),h=n(50),m=n.n(h);function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"keys",value:function(e){var t=e.getState().faces,n=[];for(var r in t)n.push(t[r].key);return n}},{key:"icons",value:function(e){var t=e.getState().faces,n=[];for(var r in t)n.push(t[r].icon);return n}},{key:"findKeys",value:function(t,n){for(var r=[],i=e.keys(n).map((function(e){return"("+e+")"})).sort((function(e,t){return e.length>t.length?-1:1})).toString().replace(/,/g,"|"),o=new RegExp("("+i+")"),a=null,s=0;s<10;s++){var c=o.exec(t);c&&(a=m.a.generate(),r.push({id:a,key:c[0]}),t=t.replace(o,a))}return{data:t,detectedFaces:r}}},{key:"renderImage",value:function(t,n){var r=e.keys(n).indexOf(t);if(r>=0){var i=e.icons(n)[r];return"?test"==location.search?"<img src='/images/floating_heart1.png' height='18' alt='' />":"<img src='/uploads/faces/"+i+"?v=1' height='18' alt='' />"}}},{key:"render",value:function(t,n){if(!t)return"";if(!e.keys(n).length)return"<span>"+t+"</span>";var r=e.findKeys(t,n);if(!r.detectedFaces.length)return"<span>"+r.data+"</span>";var i=r.data,o="";for(var a in r.detectedFaces){var s=r.detectedFaces[a];if(void 0!==i){var c=i.split(s.id);void 0!==(i=c[1])&&(c[0]?o+="<span><span>"+c[0]+"</span>"+e.renderImage(s.key,n)+"</span>":o+="<span>"+e.renderImage(s.key,n)+"</span>")}}return"<span>"+o+"<span>"+(i=i||"")+"</span></span>"}}],(n=null)&&g(t.prototype,n),r&&g(t,r),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onSelect()}},{key:"onSelect",value:function(){$(".emoji_picker img.emoji_picker__item").unbind("click").on("click",(function(e){var t=e.target.dataset.key,n=document.querySelector($(this).parent().data("input"));n&&(n.value=n.value.trim()+" "+t+" ",n.focus())}))}},{key:"toggle",value:function(e){e&&(e.getState().isPublicMessagesFacePickerOpen?$(".emoji_picker.public_messages").show():$(".emoji_picker.public_messages").hide(),e.getState().isPrivateMessagesFacePickerOpen?$(".emoji_picker.private_messages").show():$(".emoji_picker.private_messages").hide(),e.getState().isWallFacePickerOpen?$(".emoji_picker.wall").show():$(".emoji_picker.wall").hide(),e.getState().isWallCommentsFacePickerOpen?$(".emoji_picker.wall-comments").show():$(".emoji_picker.wall-comments").hide())}},{key:"render",value:function(e,t,n){var r="<div class='emoji_picker "+e+"' data-input='"+t+"' style='display: none'>";return n.getState().faces.map((function(e){"?test"==location.search?r+="<img src='/images/floating_heart1.png' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />":r+="<img src='/uploads/faces/"+e.icon+"' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />"})),r+="</div>"}}],(n=null)&&v(t.prototype,n),r&&v(t,r),e}(),b=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER",isPublicMessagesFacePickerOpen:e}};function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t="<span class='username'>";return"?test"==location.search?t+=e.icon?"<img src='/images/floating_ad1.png' class='username__icon fl' alt='' style='max-height: 16px' />":"":t+=e.icon?"<img src='"+e.icon+"?v=1' class='username__icon fl' alt='' style='max-height: 16px' />":"",t+="<span class='username__wrapper' style='background-color: "+e.nameBgColor+"; color: "+e.nameColor+"'>"+e.name+"</span>",t+="</span>"}}],(n=null)&&w(t.prototype,n),r&&w(t,r),e}();function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.clearGift(t),e.onSelect(t),e.close(t)}},{key:"clearGift",value:function(e){$(".gifts_picker__contianer__clear").unbind("click").on("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_REMOVE_GIFT",data:{userID:n}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"onSelect",value:function(e){$(".gifts_picker__contianer__img").unbind("click").on("click",(function(t){var n=e.getState().requestedUser,r=$(this).data("id"),i=n.id;n.icon!=$(this).attr("src")&&e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_GIFT",data:{userID:i,giftID:r}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"close",value:function(e){$(".gifts_picker__contianer__close").unbind("click").on("click",(function(e){$("#user_profile .gifts_picker").hide(),$("#user_profile .user_profile__body__avatar").show()}))}},{key:"render",value:function(e){var t="<div class='gifts_picker' style='display: none'>";return t+="<div class='gifts_picker__contianer'>",e.getState().gifts.forEach((function(e){t+="<img data-id='"+e.id+"' src='"+e.icon+"' class='gifts_picker__contianer__img' />"})),t+="</div>",t+="<button class='gifts_picker__contianer__clear btn btn-primary fa fa-times fl'>سحب الهدية</button>",t+="<button class='gifts_picker__contianer__close btn btn-danger fa fa-times fr'>إخفاء الهدايا</button>",t+="<div class='clear'></div>",t+="</div>"}}],(n=null)&&k(t.prototype,n),r&&k(t,r),e}(),E=function(e){return{type:"SET_CURRENT_CONVERSATION",user:e}},T=function(e){return{type:"REMOVE_CONVERSATION",id:e}},P=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{type:"ADD_MESSAGE_TO_CONVERSATION",conversation_id:e,me:t,him:n,seen:r,message:i}};function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.getProfile(t),e.photoClicked(),e.youtubeVideoClicked()}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var r=$(".private_message[data-user-id='"+e+"']");r&&(r.find(".private_message__avatar img").attr("src",n.avatar),r.find(".private_message__title").html(S.render(n)),r.find(".private_message__body").css("color",n.fontColor))}}}},{key:"getProfile",value:function(e){$("#chat_box .private_message .private_message__avatar img").unbind("click").on("click",(function(t){var n=$(this).closest(".private_message").data("user-id");ct.show(n,e)}))}},{key:"getBaseDir",value:function(){return"/uploads/private/"}},{key:"photoClicked",value:function(){$(".private_message__body__image").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"youtubeVideoClicked",value:function(){$(".private_message .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("msg-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",r=document.getElementById("yt-btn-"+t);r&&(r.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),r.remove())}catch(e){}}))}},{key:"renderMessageBody",value:function(t,n){switch(t.type){case"text":return _.render(t.body,n);case"photo":return"<img src='"+e.getBaseDir()+t.body+"' alt='' class='private_message__body__image private_message__body__media' />";case"sound":return"<audio controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></audio>";case"video":return"<video controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></video>";case"youtube":return"<button id='yt-btn-"+t.id+"' class='yt-btn' data-msg-id='"+t.id+"' data-yid='"+t.body+"'><img src='images/youtube.png'/><img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+t.body+"/0.jpg' /></button>";default:return""}}},{key:"render",value:function(t,n,r){var i="<div class='private_message linen' data-user-id='"+n.id+"'>";return i+="<p class='private_message__avatar'><img class='radius' width='28' height='28' src='"+n.avatar+"' /></p>",i+="<div>",i+="<h5 class='private_message__title'>",i+=S.render(n),i+="</h5>",i+="<h5 class='private_message__body' style='color: "+n.fontColor+"'>",i+=e.renderMessageBody(t,r),i+="</h5>",i+="</div>",i+="<span class='private_message__time fr time' data-time='"+t.time+"'>"+Zt(t.time)+"</span>",i+="<div class='clear'></div>",i+="</div>"}}],(n=null)&&A(t.prototype,n),r&&A(t,r),e}(),O=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER",isPrivateMessagesFacePickerOpen:e}},x=(n(91),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_USER",user:e}}),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_CURRENT_USER",updates:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REQUESTED_USER",user:e}},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_REQUESTED_USER",user:e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER",user:e}};function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.editRoom(t),e.deleteRoom(t)}},{key:"editRoom",value:function(t){$("#editRoomModal form").on("submit",(function(n){n.preventDefault();var r=n.target.name.value.trim(),i=n.target.description.value.trim(),o=n.target.welcome.value.trim(),a=n.target.password.value.trim(),s=n.target.required_likes.value,c=n.target.capacity.value,u=$(this).data("id");return r.length?r.length<2?e.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):r!=t.getState().mUser.room.name&&t.getState().rooms.filter((function(e){return e.name==r})).length?e.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):c<2||c>50?e.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void t.getState().socket.emit("req",Kt({type:"EDIT_ROOM",data:{room:{id:u,name:r,description:i,welcome:o,password:a,required_likes:s,capacity:c,is_voice_room:t.getState().mUser.room.is_voice_room}}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);t&&"object"==U(t)&&(!1===t.error?e.showSuccessMessage("تم تعديل الغرفة بنجاح"):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("الرجاء إعطاء إسم للغرفة")}))}},{key:"deleteRoom",value:function(t){$("#room_modal__body__form__delete").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"REMOVE_ROOM",data:{room:{id:t.getState().mUser.room.id}}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);t&&"object"==U(t)&&(!1===t.error?e.showSuccessMessage("تمت العملية بنجاح, سيتم حذف الغرفة عندما تفرغ"):!0===t.error&&e.showErrorMessage(t.message))}))}))}},{key:"showErrorMessage",value:function(e){$("#editRoomModal .alert-success").hide(),$("#editRoomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#editRoomModal .alert-success").text(e).show(),$("#editRoomModal .alert-danger").hide()}},{key:"render",value:function(t,n){var r=t.description?t.description:"",i=t.welcome?t.welcome:"",o=t.required_likes?t.required_likes:0,a="<div class='modal fade room_modal' id='editRoomModal' tabindex='-1' role='dialog' aria-hidden='true'>";a+="<div class='modal-dialog' role='document'>",a+="<div class='modal-content'>",a+="<div class='room_modal__header modal-header label label-primary'>",a+="<div class='modal-title'>",a+="<p class='room_modal__header__name ellipsis'>تعديل الغرفة</p>",a+="<button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button>",a+="</div>",a+="</div>",a+="<div class='room_modal__body modal-body'>",a+="<p class='alert alert-danger' style='display: none'></p>",a+="<p class='alert alert-success' style='display: none'></p>",a+="<form data-id='"+t.id+"' id='room_modal__body__form'>",a+="<div>",a+="<div><input type='text' name='name' value='"+t.name+"' placeholder='عنوان الغرفة' /></div>",a+="<div><input type='text' name='description' value='"+r+"' placeholder='الوصف' /></div>",a+="<div><input type='text' name='welcome' value='"+i+"' placeholder='رسالة الترحيب' /></div>",a+="<div><input type='text' name='password' placeholder='كلمة المرور' /></div>",a+="<div><input type='number' name='required_likes' value='"+o+"' placeholder='لايكات الدخول' /></div>",a+="<div><input type='number' name='capacity' value='"+t.capacity+"' placeholder='حجم الغرفة من 2 إلى 50' /></div>",a+="<button class='btn btn-success pull-left'><span class='fa fa-save'></span>حفظ التعديلات&nbsp;</button>",a+="<button id='room_modal__body__form__delete' type='button' class='btn btn-danger pull-right'><span class='fa fa-remove'></span>حذف الغرفة</button>",a+="</div>",a+="</form>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",$("#room_modal__body__form__delete").unbind("click"),$("#editRoomModal form").unbind("submit"),$("#edit_room_container").html(a),e.registerEvents(n)}}],(n=null)&&L(t.prototype,n),r&&L(t,r),e}(),F=n(9),N=n.n(F);function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onFormSubmited(t)}},{key:"onFormSubmited",value:function(t){$("#bot_brb_modal__body__form").unbind("submit").on("submit",(function(n){n.preventDefault(),n.originalEvent.submitter.classList.contains("btn-success")?e.start(t,$(this)):n.originalEvent.submitter.classList.contains("btn-warning")?e.pause(t,$(this)):n.originalEvent.submitter.classList.contains("btn-danger")?e.stop(t,$(this)):n.originalEvent.submitter.classList.contains("btn-info")&&e.update(t,$(this))}))}},{key:"start",value:function(t,n){var r=n.find("input[name='num_rounds']").val(),i=n.find("input[name='bot_brb_modal__body__form__speed']").val(),o=n.find("input[name='bot_brb_modal__body__form__excpel']").prop("checked"),a={type:"BOT_BRB_CREATE",data:{room_id:t.getState().mUser.room.id,num_rounds:r,excpel:o,speed:i}};t.getState().socket.emit("req",Kt(a),(function(t){e.setBot(t.bot),$("#manageBotBrbModal .bot_brb_modal__header__close").click()}))}},{key:"pause",value:function(t,n){var r={type:"BOT_BRB_PAUSE",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",Kt(r),(function(t){e.setBot(t.bot)}))}},{key:"stop",value:function(t,n){var r={type:"BOT_BRB_STOP",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",Kt(r),(function(t){e.setBot(t.bot)}))}},{key:"update",value:function(t,n){var r=n.find("input[name='bot_brb_modal__body__form__speed']").val(),i={type:"BOT_BRB_UPDATE",data:{room_id:t.getState().mUser.room.id,speed:r}};t.getState().socket.emit("req",Kt(i),(function(t){e.setBot(t.bot)}))}},{key:"setBot",value:function(e){if(!e)return $("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),void $("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled");e.isPaused?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")):e.isStopped?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled")):e.isStarted&&($("#bot_brb_modal__body__form__button--start").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--pause").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")),e.isStarted||e.isPaused?$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").attr("disabled","disabled"):$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").removeAttr("disabled"),$("#bot_num_rounds").val(e.num_rounds),$("#bot_brb_modal__body__form__speed").val(e.speed),e.excpel?$("#bot_brb_modal__body__form__excpel").attr("checked","checked"):$("#bot_brb_modal__body__form__excpel").removeAttr("checked")}},{key:"render",value:function(t){var n="<div class='modal fade bot_brb_modal' id='manageBotBrbModal' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document'>",n+="<div class='modal-content'>",n+="<div class='bot_brb_modal__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<p class='bot_brb_modal__header__name ellipsis'>"+t.getState().mUser.room.name+"</p>",n+="<button data-dismiss='modal' class='btn btn-danger bot_brb_modal__header__close fa fa-times'></button>",n+="</div>",n+="</div>",n+="<div class='bot_brb_modal__body modal-body'>",n+="<p class='alert alert-danger' style='display: none'></p>",n+="<p class='alert alert-success' style='display: none'></p>",n+="<form id='bot_brb_modal__body__form'>",n+="<div>",n+="<div><input type='number' id='bot_num_rounds' min='2' max='10' name='num_rounds' value='5' placeholder='عدد الجولات' /></div>",n+='<div class="form-group">',n+='<input type="checkbox" id="bot_brb_modal__body__form__excpel" name="bot_brb_modal__body__form__excpel"/>',n+='<label for="bot_brb_modal__body__form__excpel">أطرد خصمك</label>',n+="</div>",n+='<div class="form-group">',n+='<label for="bot_brb_modal__body__form__speed">سرعة البوت</label><br>',n+="<input type='number' id='bot_brb_modal__body__form__speed' min='100' max='5000' name='bot_brb_modal__body__form__speed' value='1000' placeholder='رقم من 100 إلى 5000' style='width: 50%' />",n+="<button id='bot_brb_modal__body__form__button--update' class='btn btn-info pull-right'><span class='fa fa-refresh'></span>تحديث السرعة&nbsp;</button>",n+="</div>",n+="<div class='bot_brb_modal__body__form__buttons'>",n+="<button id='bot_brb_modal__body__form__button--start' class='btn btn-success'><span class='fa fa-play'></span>تشغيل&nbsp;</button>",n+="<button id='bot_brb_modal__body__form__button--pause' class='btn btn-warning'><span class='fa fa-pause'></span>إيقاف مؤقت&nbsp;</button>",n+="<button id='bot_brb_modal__body__form__button--stop' class='btn btn-danger'><span class='fa fa-stop'></span>إيقاف&nbsp;</button>",n+="</div>",n+="</div>",n+="</form>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#manage_bot_brb_container").html(n),e.registerEvents(t),e.setBot(null)}}],(n=null)&&q(t.prototype,n),r&&q(t,r),e}();function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.submit(t),e.initJSColor(),e.openAdmin(t),e.closeChat(t),e.onBotBrbClicked(t),e.openIngoredUsers(t),e.removeNameBgColor(t),e.openNotifications(t),e.changeFontSize(t),e.hideRoleIcon(t),e.triggerChangeAvatarInput(t),e.changeAvatar(t),e.removeAvatar(t),e.togglePrivate(t),e.toggleNotifications(t),e.changePassword(t),e.sendAd(t),e.manageRoom(t)}},{key:"prependHash",value:function(e){return"string"!=typeof e?"":e.includes("#")?e:"#"+e}},{key:"initJSColor",value:function(){var e=document.getElementsByClassName("jscolor");for(var t in e)try{new jscolor(e[t]).importColor()}catch(e){}}},{key:"changeFontSize",value:function(e){$("#chat__body__settings_pane__container__button--change-font-size option[value='"+e.getState().mUser.fontSize+"']").attr("selected","selected"),document.querySelector("html").style.fontSize=e.getState().mUser.fontSize+"px",$("#chat__body__settings_pane__container__button--change-font-size").on("change",(function(t){var n={type:"USER_SETTINGS_SET_FONT_SIZE",data:{fontSize:t.target.value}};e.getState().socket.emit("req",Kt(n),(function(t){t=Qt(t),e.getState().mUser.reg_id||Xt("fontSize",Kt(t,!0)),e.dispatch(M({fontSize:t})),document.querySelector("html").style.fontSize=t+"px"}))}))}},{key:"submit",value:function(t){$("#chat__body__settings_pane form").on("submit",(function(n){n.preventDefault();var r=n.target.decoration.value,i=n.target.status.value;if(t.getState().mUser.name!=r&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+t.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الإسم");if(t.getState().mUser.status!=i&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+t.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الحالة");var o={type:"USER_SETTINGS_SAVE",data:{decoration:r,status:i,fontColor:e.prependHash(n.target.fontColor.value.trim()),nameColor:e.prependHash(n.target.nameColor.value.trim()),nameBgColor:e.prependHash(n.target.nameBgColor.value.trim()),statusColor:e.prependHash(n.target.statusColor.value.trim())}};t.getState().socket.emit("req",Kt(o),(function(e){e=Qt(e),t.getState().mUser.reg_id||Object.keys(e).forEach((function(t){Xt(t="name"==t?"gun":t,Kt(e["gun"==t?"name":t],!0))}))}))}))}},{key:"triggerChangeAvatarInput",value:function(e){$("#chat__body__settings_pane__container__button--change_avatar").on("click",(function(t){if(e.getState().mUser.likes<e.getState().settings.required_likes_to_change_avatar)return alert("يجب أن تتوفر على "+e.getState().settings.required_likes_to_change_avatar+" حتى تتمكن من تغيير الصورة");if(!$(this).hasClass("is-loading")){var n=document.getElementById("change_avatar_input");n&&n.click()}}))}},{key:"changeAvatar",value:function(t){$("#change_avatar_input").on("change",(function(n){var r=new FormData;r.append("avatar",n.target.files[0]),$("#chat__body__settings_pane__container__button--change_avatar").addClass("disabled"),N.a.post("/change_avatar",r).then((function(n){if($("#chat__body__settings_pane__container__button--change_avatar").removeClass("disabled"),!1===n.data.error){var r={type:"USER_SETTINGS_CHANGE_AVATAR",data:{avatar:n.data.avatar}};t.getState().socket.emit("req",Kt(r),(function(n){t.getState().mUser.reg_id||Xt("avatar",Kt(n,!0)),n=Qt(n),e.updateUserAttribute("avatar","/uploads/avatars/sm/"+n,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src","/uploads/avatars/sm/"+n)}))}})).catch((function(e){}))}))}},{key:"removeAvatar",value:function(t){$("#chat__body__settings_pane__container__button--remove-avatar").on("click",(function(n){confirm("هلل أنت متأكد من حذف الصورة؟")&&t.getState().socket.emit("req",Kt({type:"USER_SETTINGS_REMOVE_AVATAR",data:{}}),(function(n){t.getState().mUser.reg_id||Xt("avatar",null),n=Qt(n),e.updateUserAttribute("avatar",n,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src",n)}))}))}},{key:"updateUserAttribute",value:function(e,t,n){var r={};r[e]=t,n.dispatch(M(r))}},{key:"updateDecoration",value:function(e){$("#chat__body__settings_pane form input[name='decoration']").val(e.getState().mUser.name)}},{key:"openIngoredUsers",value:function(e){$("#chat__body__settings_pane__container__button--ignored_users").on("click",(function(t){e.dispatch(r("ignored_users")),qt.togglePane(e)}))}},{key:"openNotifications",value:function(e){$("#chat__body__settings_pane__container__button--notifications").on("click",(function(t){e.dispatch(r("notifications")),qt.togglePane(e)}))}},{key:"removeNameBgColor",value:function(t){$(".chat__body__settings_pane__container__rm_bg_color").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"USER_SETTINGS_REMOVE_NAME_BG_COLOR",data:{}}),(function(n){n=Qt(n),t.getState().mUser.reg_id||Xt("nameBgColor",Kt(n,!0)),e.updateUserAttribute("nameBgColor",n,t),$("input[name='nameBgColor']").val("FFFFFF"),e.initJSColor()}))}))}},{key:"hideRoleIcon",value:function(t){$("#chat__body__settings_pane__container__button--toggle-star").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"USER_SETTINGS_HIDE_ROLE_ICON",data:{}}),(function(n){n=Qt(n),e.updateUserAttribute("isRoleIconHidden",n,t),n?($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").removeClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").addClass("toggle_star--active")):($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").addClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").removeClass("toggle_star--active"))}))}))}},{key:"togglePrivate",value:function(t){$("#chat__body__settings_pane__container__button--toggle_private").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"USER_SETTINGS_TOGGLE_PRIVATE",data:{}}),(function(n){n=Qt(n),e.updateUserAttribute("isPrivateDisabled",n,t),n?($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").removeClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").addClass("toggle_private--active")):($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").addClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").removeClass("toggle_private--active"))}))}))}},{key:"toggleNotifications",value:function(t){$("#chat__body__settings_pane__container__button--toggle_notifications").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"USER_SETTINGS_TOGGLE_NOTIFICATIONS",data:{}}),(function(n){n=Qt(n),e.updateUserAttribute("isNotificationsDisabled",n,t),n?($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").removeClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").addClass("toggle_notifications--active")):($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").addClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").removeClass("toggle_notifications--active"))}))}))}},{key:"changePassword",value:function(e){$("#chat__body__settings_pane__container__button-change_password").on("click",(function(t){var n=prompt("الرجاء إدخال كلمة المرور الجديدة");if(n){if(n.length<6)return alert("كلمة المرور لا يجب أن تقل عن 6 أحرف");var r={type:"USER_SETTINGS_CHANGE_PASSWORD",data:{password:n}};e.getState().socket.emit("req",Kt(r),(function(e){(e=Qt(e)).error||Xt("mup",Kt(n,!0)),alert(e.message)}))}}))}},{key:"sendAd",value:function(e){$("#chat__body__settings_pane__container__button--send_ad").on("click",(function(t){var n=prompt("الرجاء إدخال الرسالة:");if(n){var r={type:"USER_SETTINGS_SEND_AD",data:{message:n}};e.getState().socket.emit("req",Kt(r),(function(e){}))}}))}},{key:"manageRoom",value:function(e){$("#chat__body__settings_pane__container__button--manage_room").on("click",(function(t){if(!e.getState().mUser.room)return alert("الرجاء الدخول إلى غرفة حتى تتمكن من إدارتها");j.render(e.getState().mUser.room,e)}))}},{key:"openAdmin",value:function(e){$("#chat__body__settings_pane__container__button--open_admin").on("click",(function(t){window.open("/fadmn/home/".concat(e.getState().grantedSettings.adminToken),"_blank").focus()}))}},{key:"onBotBrbClicked",value:function(e){$("#chat__body__settings_pane__container__button--bot-brb").on("click",(function(t){if(!e.getState().mUser.room)return alert("يجب أن  تكون داخل غرفة حتى تتمكن من تشغيل البوت");G.render(e);var n={type:"BOT_BRB_OPEN",data:{room_id:e.getState().mUser.room.id}};e.getState().socket.emit("req",Kt(n),(function(t){G.setBot(t.bot,e)}))}))}},{key:"closeChat",value:function(e){$("#chat__body__settings_pane__container__button--close-chat").on("click",(function(t){window.confirmOnExit=!1,e.getState().socket.disconnect()}))}},{key:"render",value:function(e){var t="<div id='chat__body__settings_pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return t+=f.render("الإعدادات"),t+="<div class='chat__body__settings_pane__container'>",t+="<div style='margin-bottom: 5px' >",t+="<label class='label label-primary'>الزخرفة</label>",t+="<label class='label label-primary pull-right'>الملف الشخصي</label>",t+="<form>",t+="<input type='text' name='decoration' value='"+e.getState().mUser.name+"' class='form-control' />",t+="<div>",t+="<label class='label label-primary'>الحالة</label>",t+="<input type='text' name='status' value='"+e.getState().mUser.status+"' class='form-control' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الحالة</label>",t+="<input type='text' name='statusColor' value='"+e.getState().mUser.statusColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخط</label>",t+="<input type='text' name='fontColor' value='"+e.getState().mUser.fontColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الإسم</label>",t+="<input type='text' name='nameColor' value='"+e.getState().mUser.nameColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخلفية</label>",t+="<input type='text' name='nameBgColor' value='"+e.getState().mUser.nameBgColor+"' class='jscolor form-input' />",t+="<button type='button' class='chat__body__settings_pane__container__rm_bg_color btn btn-danger fa fa-times'></button>",t+="</div>",t+="<button name='submit' class='chat__body__settings_pane__container__submit btn btn-success fa fa-save fr'>حفظ</button>",t+="<div class='clear'></div>",t+="</form>",t+="</div>",t+="<select id='chat__body__settings_pane__container__button--change-font-size' class='form-control label-primary' value='"+e.getState().mUser.fontSize+"' style='height: auto' >",t+="<option value='18'>حجم الخط 10</option>",t+="<option value='20'>حجم الخط 11</option>",t+="<option value='22'>حجم الخط 12</option>",t+="<option value='24'>حجم الخط 13</option>",t+="<option value='26'>حجم الخط 14</option>",t+="<option value='28'>حجم الخط 15</option>",t+="<option value='30'>حجم الخط 16</option>",t+="</select>",t+="<div id='chat__body__settings_pane__container__button--ignored_users' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-ban'></span>المستخدمون المتجاهلين</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--notifications' class='chat__body__settings_pane__container__button form-control info'>",t+="<span><span class='fa fa-bell'></span>الإشعارات</span>",t+="</div>",e.getState().grantedSettings.hide_role_icon&&(t+="<div id='chat__body__settings_pane__container__button--toggle-star' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_star toggle_star__hide "+(e.getState().mUser.isRoleIconHidden?"":"toggle_star--active")+"'><span class='fa fa-eye-slash'></span>إخفاء النجمة</span>",t+="<span class='toggle_star toggle_star__show "+(e.getState().mUser.isRoleIconHidden?"toggle_star--active":"")+"'><span class='fa fa-eye'></span>إظهار النجمة</span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--change_avatar' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa'>",t+="<img class='avatar' src='"+e.getState().mUser.avatar+"' width='20' height='20' alt='' />",t+="<img class='loader' src='/images/loader.gif' width='20' height='20' alt=''/>",t+="</span>تغيير الصورة</span>",t+="<input accept='image/*' type='file' id='change_avatar_input' style='position: absolute; top: -1000px' />",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--remove-avatar' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-remove'></span>حذف الصورة</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--toggle_private' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_private toggle_private__enable "+(e.getState().mUser.isPrivateDisabled?"toggle_private--active":"")+"'><span class='fa fa-check'></span>تفعيل المحادثات الخاصة</span>",t+="<span class='toggle_private toggle_private__disable "+(e.getState().mUser.isPrivateDisabled?"":"toggle_private--active")+"'><span class='fa fa-times'></span>تعطيل المحادثات الخاصة</span>",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--toggle_notifications' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_notifications toggle_notifications__enable "+(e.getState().mUser.isNotificationsDisabled?"toggle_notifications--active":"")+"'><span class='fa fa-check'></span>تفعيل التنبيهات</span>",t+="<span class='toggle_notifications toggle_notifications__disable "+(e.getState().mUser.isNotificationsDisabled?"":"toggle_notifications--active")+"'><span class='fa fa-times'></span>تعطيل التنبيهات</span>",t+="</div>",e.getState().grantedSettings.change_password&&(t+="<div id='chat__body__settings_pane__container__button-change_password' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-key'></span>تغيير كلمة المرور</span>",t+="</div>"),e.getState().grantedSettings.admin_rooms_edit&&(t+="<div data-toggle='modal' data-target='#editRoomModal' id='chat__body__settings_pane__container__button--manage_room' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-home'></span>إدارة الغرفة</span>",t+="</div>"),e.getState().grantedSettings.send_ad&&(t+="<div id='chat__body__settings_pane__container__button--send_ad' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa fa-send'></span>الإعلان للأدعية و المسابقات</span>",t+="</div>"),e.getState().grantedSettings.bot_brb&&(t+="<div data-toggle='modal' data-target='#manageBotBrbModal' id='chat__body__settings_pane__container__button--bot-brb' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-dashboard'></span>بوت برب</span>",t+="</div>"),e.getState().grantedSettings.admin&&(t+="<div id='chat__body__settings_pane__container__button--open_admin' class='chat__body__settings_pane__container__button form-control success'>",t+="<span><span class='fa fa-star'></span>لوحة التحكم</span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--close-chat' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-sign-out'></span>تسجيل الخروج</span>",t+="</div>",t+="</div>",t+="</div>"}}],(n=null)&&V(t.prototype,n),i&&V(t,i),e}(),z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_POPUP",popup:e}},H=function(e){return{type:"TRUST_USER_POPUP",user_id:e}};function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.close(t),e.trustUser(t)}},{key:"close",value:function(e){$(".popup").unbind("click").on("click",(function(t){var n=$(this).data("id"),r=e.getState().popups.filter((function(e){return e.id=n}));e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_POPUP",popup:e}}(r)),$(this).remove()}))}},{key:"trustUser",value:function(e){$(".popup__message__body__trust_user").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Kt({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Qt(t),$(n).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var r=$(n).data("user-id");e.dispatch(H(r))}}))}))}},{key:"getMarginLeft",value:function(e){return 2*e.getState().popups.length+30+"px"}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+ht.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='popup__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='popup__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"photo_like":return;default:return"<span>"+_.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,n){var r="<div style='marginLeft: "+e.getMarginLeft(n)+"' data-id='"+t.id+"' class='popup'>";r+="<p class='popup__title label label-primary'>"+t.title+"</p>",t.user&&(r+="<div class='popup__sender fl'>",r+="<img src='"+t.user.avatar+"' width='24' height='24' class='popup__sender__avatar fl' />",r+="<p class='popup__sender__name'>"+S.render(t.user)+"</p>",r+="</div>"),r+="<div class='popup__message fl'>",r+=e.renderMessage(t,n),r+="</div>",r+="</div>",$("#popup_container").append(r),e.registerEvents(n)}}],(n=null)&&J(t.prototype,n),r&&J(t,r),e}(),Y=n(51),K=n.n(Y),Q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_CALL_DIALOG_OPEN",isCallDialogOpen:e}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_CURRENT_CALL",currentCall:e}},ee=n(2),te=n.n(ee);function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onMicButtonClicked(t),e.onMuteClicked(t)}},{key:"getIceServers",value:function(e){return e?[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://audio2.d-arish.com:8989/janus"}},{key:"init",value:function(t){window.isMicSoundMuted=!1,window.isMicMuted=!1,window.incomingMicStreams={},window.currentMicCallObjct={},window.outgoingMicStream=null,window.janusSession=null,window.janusUserID=e.generateJanusUserID(t.getState().socket.id),window.opaqueId="videoroomtest-"+te.a.randomString(12),window.reconnectionInterval=null,window.feeds=[],te.a.init({debug:!1,dependencies:te.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}},{key:"onJanusInitialized",value:function(t){window.janusSession=new te.a({server:e.getJanusServer(),success:function(){e.onJanusSessionSuccess(t,janusSession)},error:function(n){"Lost connection to the server (is it down?)"==n&&e.handleServerConnectionLost(t)},destroyed:function(){e.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(t){if(t.getState().mUser.room){var n=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0];n&&e.leaveMic(t,n.micId,t.getState().mUser),e.destroySession()}window.reconnectionInterval=setInterval((function(){te.a.init({debug:!1,dependencies:te.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}),5e3)}},{key:"getJanusUserID",value:function(e){return e.replace(new URL(socketIOHost).hostname+".","")}},{key:"generateJanusUserID",value:function(e){return new URL(socketIOHost).hostname+"."+e}},{key:"onJanusSessionSuccess",value:function(t,n){window.reconnectionInterval&&(clearInterval(window.reconnectionInterval),window.reconnectionInterval=null),n.attach({plugin:"janus.plugin.videoroom",success:function(n){e.onJanusAttachSuccess(t,n)},error:function(e){},consentDialog:function(e){},onmessage:function(n,r){e.onJanusAttachMessage(n,r,t)},onlocalstream:function(t){e.onJanusAttachLocalStream(t)},onremotestream:function(e){},webrtcState:function(e){te.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusSessionDestroyed",value:function(t){t.getState().mUser.room&&t.getState().mUser.room.is_voice_room&&e.onJanusInitialized(t)}},{key:"onJanusAttachSuccess",value:function(t,n){console.log("onMicAttachSuccess"),window.pluginHandle=n,e.joinRoom(t)}},{key:"onJanusAttachMessage",value:function(t,n,r){var i=t.videoroom;if(i){if("joined"===i&&t.id){if(window.pluginHandle.send({message:{request:"publish",video:!1,data:!1}}),t.publishers){var o=t.publishers;for(var a in te.a.debug("Got a list of available publishers/feeds:",o),o){var s=o[a].id,c=o[a].display,u=o[a].audio_codec,l=o[a].video_codec;te.a.debug("  >> ["+s+"] "+c+" (audio: "+u+", video: "+l+")"),e.newRemoteFeed(r,s,c,u,l)}}e.enableMicButtons()}if("created"===i);else if("destroyed"===i)te.a.warn("The room has been destroyed!");else if("roomchanged"===i)window.myJanusID=t.id;else if("event"===i)if(t.publishers)for(var a in o=t.publishers)s=o[a].id,c=o[a].display,u=o[a].audio_codec,l=o[a].video_codec,e.newRemoteFeed(r,s,c,u,l);else t.leaving||t.unpublished||t.error&&426===t.error_code&&e.createRoom(r)}n&&window.pluginHandle.handleRemoteJsep({jsep:n})}},{key:"onJanusAttachLocalStream",value:function(e){window.outgoingMicStream=e}},{key:"onJanusAttachRemoteStream",value:function(e,t){}},{key:"detachFeed",value:function(t,n){window.feeds.filter((function(t){return t.rfdisplay==e.generateJanusUserID(n)}))[0].detach()}},{key:"newRemoteFeed",value:function(t,n,r,i,o){var a=null;window.janusSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.opaqueId,success:function(r){(a=r).simulcastStarted=!1,a.audioCodec=i;var o={request:"join",room:e.generateJanusRoomID(t),ptype:"subscriber",feed:n,offer_video:!1,offer_data:!1};a.send({message:o})},error:function(e){te.a.error("  -- Error attaching plugin...",e)},onmessage:function(n,r){var i=n.videoroom;if(n.error);else if(i&&"attached"===i){for(var o=1;o<6;o++)if(!window.feeds[o]){window.feeds[o]=a,a.rfindex=o;break}a.rfid=n.id,a.rfdisplay=n.display}r&&a.createAnswer({jsep:r,media:{audioSend:!1,videoSend:!1},success:function(n){te.a.debug("Got SDP!",n);var r={request:"start",room:e.generateJanusRoomID(t)};a.send({message:r,jsep:n})},error:function(e){te.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){te.a.log(" WebRTC PeerConnection (feed #"+a.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(e){},onremotestream:function(n){e.playStream(t,n,e.getJanusUserID(a.rfdisplay))},oncleanup:function(){}})}},{key:"toggle",value:function(t,n){var r=$("#mic-speakers");if(n)r.show(),window.janusSession&&window.janusSession.isConnected()?e.destroySession():e.onJanusInitialized(t);else{if(r.hide(),t.getState().mUser.room){var i=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0];i&&e.leaveMic(t,i.micId,t.getState().mUser)}e.destroySession()}nn()}},{key:"onMicButtonClicked",value:function(t){$(".mic-speakers--item").on("click",(function(n){if(!$(this).hasClass("disabled")&&t.getState().mUser.room){var r=$(this).data("id");t.getState().mUser.room.micUsers.filter((function(e){return e.micId==r}))[0]?e.openMicControls(t,r):e.requestMic(t,r)}}))}},{key:"setModalButtons",value:function(t,n){$(".mic-speakers--item__modal").html("").hide();var r=!1,i=t.getState().mUser.room.micUsers.filter((function(e){return e.micId==n}))[0];i&&i.user_id==t.getState().mUser.id&&(r=!0);var o=t.getState().users.filter((function(e){return e.id==i.user_id}))[0],a=$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal");a.css("background",en(t.getState().settings,!1));var s=a.closest(".mic-speakers--item").attr("user-id");r?(a.append("<button id='mic-speakers--item__modal--leave-mic' class='btn btn-primary'>ترك المايك</button>"),$("#mic-speakers--item__modal--leave-mic").unbind("click").on("click",(function(r){e.leaveMic(t,n,s)}))):o&&t.getState().grantedSettings.stop_radio&&t.getState().mUser.power>o.power&&(a.append("<button id='mic-speakers--item__modal--pull-mic' class='btn btn-primary'>سحب المايك</button>"),$("#mic-speakers--item__modal--pull-mic").unbind("click").on("click",(function(r){e.pullMic(t,n,o.id)}))),r?(window.isMicMuted?a.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'>تشغيل المايك</button>"):a.append("<button id='mic-speakers--item__modal--mute-mic' class='btn btn-primary'>كتم المايك</button>"),$("#mic-speakers--item__modal--mute-mic").unbind("click").on("click",(function(r){e.muteMic(t,n,s)}))):(e.isMicMuted(n)?a.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'>تشغيل الصوت</button>"):a.append("<button id='mic-speakers--item__modal--mute' class='btn btn-primary'>كتم الصوت</button>"),$("#mic-speakers--item__modal--mute").unbind("click").on("click",(function(r){e.muteUser(t,n,!0)}))),a.append("<button id='mic-speakers--item__modal--show-profile' class='btn btn-primary'>فتح البروفايل</button>"),$("#mic-speakers--item__modal--show-profile").unbind("click").on("click",(function(r){e.showProfile(t,n,s)})),a.show()}},{key:"isMicMuted",value:function(e){var t=!1,n=window.incomingMicStreams[e];return n&&(t=!n.getTracks()[0].enabled),t}},{key:"leaveMic",value:function(t,n,r){t.getState().socket.emit("req",Kt({type:"MIC_LEAVE",data:{micId:n}}),(function(e){})),e.closeModals()}},{key:"pullMic",value:function(t,n,r){t.getState().socket.emit("req",Kt({type:"MIC_PULL",data:{micId:n,userId:r}}),(function(e){})),e.closeModals()}},{key:"muteMic",value:function(t,n,r){window.isMicMuted=!window.isMicMuted,t.getState().socket.emit("req",Kt({type:"MIC_MUTE",data:{micId:n,userId:r,muted:window.isMicMuted}}),(function(e){})),window.isMicMuted?window.pluginHandle.muteAudio():window.pluginHandle.unmuteAudio(),e.setModalButtons(t,n)}},{key:"muteUser",value:function(t,n,r){if(window.incomingMicStreams[n]){var i=!1;window.incomingMicStreams[n].getTracks().forEach((function(e){e.enabled=!e.enabled,i=!e.enabled})),r&&e.setModalButtons(t,n),e.updateMicMutedStyle(i,n)}}},{key:"muteAllUsers",value:function(){for(var t in window.incomingMicStreams)window.incomingMicStreams[t].getTracks().forEach((function(e){return e.enabled=!1}));e.updateMicMutedStyle(!0)}},{key:"unmuteAllUsers",value:function(){for(var t in window.incomingMicStreams)window.incomingMicStreams[t].getTracks().forEach((function(e){return e.enabled=!0}));e.updateMicMutedStyle(!1)}},{key:"updateMicMutedStyle",value:function(e,t){if(t){var n=document.querySelector(".mic-speakers--item[data-id='"+t+"']");n&&(e?n.classList.add("muted"):n.classList.remove("muted"))}else document.querySelectorAll(".mic-speakers--item").forEach((function(t){t&&(e?t.classList.add("muted"):t.classList.remove("muted"))}))}},{key:"showProfile",value:function(e,t,n){ct.show(n,e)}},{key:"closeModals",value:function(){$(".mic-speakers--item__modal").html("").hide()}},{key:"openMicControls",value:function(t,n){$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal").show(),e.setModalButtons(t,n)}},{key:"requestMic",value:function(t,n){t.getState().socket.emit("req",Kt({type:"MIC_REQUEST",data:{micId:n}}),(function(t){if("string"==typeof t)return alert(t);e.closeModals()}))}},{key:"setUserOnMic",value:function(e,t,n){t&&($(".mic-speakers--item[data-id='"+n+"']").addClass("is_speaking").attr("user-id",t.id),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__mic-wrapper").hide(),$(".mic-speakers--item[data-id='"+n+"'] img").attr("src",t.avatar).show(),$(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__name").html(t.name).show(),window.currentMicCallObjct[n]={callId:t.id},e.getState().mUser.id==t.id&&window.pluginHandle.createOffer({media:{video:!1},success:function(e){var t={request:"configure",audio:!0,video:!1,id:n};window.pluginHandle.send({message:t,jsep:e})},error:function(e){te.a.error("WebRTC error:",e)}}))}},{key:"removeUserFromMic",value:function(t,n,r,i){$(".mic-speakers--item[data-id='"+r+"']").removeClass("is_speaking"),$(".mic-speakers--item[data-id='"+r+"'] img").attr("src",n.avatar).hide(),$(".mic-speakers--item[data-id='"+r+"'] img, .mic-speakers--item[data-id='"+r+"'] .mic-speakers--item__name, .mic-speakers--item[data-id='"+r+"'] .mic-speakers--item__modal").hide(),$(".mic-speakers--item[data-id='"+r+"'] .mic-speakers--item__mic-wrapper").show(),window.isMicSoundMuted||e.updateMicMutedStyle(!1,r),delete window.currentMicCallObjct[r],delete window.incomingMicStreams[r],n.id==t.getState().mUser.id?i&&e.destroySession():!t.getState().mUser.room||!n.room||(t.getState().mUser.room.id,n.room.id)}},{key:"closeCallAndStream",value:function(e){window.pluginHandle.createOffer({media:{video:!1,audio:!1},success:function(e){window.pluginHandle.send({message:{request:"configure",audio:!1,video:!1},jsep:e})},error:function(e){te.a.error("WebRTC error:",e)}})}},{key:"resetAllMics",value:function(){$(".mic-speakers--item").removeClass("is_speaking"),$(".mic-speakers--item img, .mic-speakers--item__name, .mic-speakers--item__modal").hide(),$(".mic-speakers--item .mic-speakers--item__mic-wrapper").show()}},{key:"pushMusicStreamToOutgoingStreams",value:function(){}},{key:"callUser",value:function(e,t,n){}},{key:"gotUserMediaError",value:function(e){}},{key:"callNewUser",value:function(e,t){}},{key:"loopThrowUsersAndCallThem",value:function(e,t){}},{key:"onCallReceived",value:function(e){}},{key:"requestRecall",value:function(e,t){}},{key:"askForPlayingAudio",value:function(e,t){}},{key:"startListening",value:function(e){}},{key:"generateJanusRoomID",value:function(e){if(!e.getState().mUser.room)return-1;var t=new URL(socketIOHost);return parseInt(t.port+""+e.getState().mUser.room.id)}},{key:"destroySession",value:function(){e.disableMicButtons(),window.outgoingMicStream&&window.outgoingMicStream.getTracks().forEach((function(e){return e.stop()})),window.janusSession&&window.janusSession.isConnected()&&(window.janusSession.destroy(),e.destroyAllFeeds())}},{key:"destroyAllFeeds",value:function(){window.feeds.forEach((function(e){}))}},{key:"disableMicButtons",value:function(){$(".mic-speakers--item").addClass("disabled")}},{key:"enableMicButtons",value:function(){$(".mic-speakers--item").removeClass("disabled")}},{key:"createRoom",value:function(t){window.pluginHandle&&window.pluginHandle.send({message:{request:"create",room:e.generateJanusRoomID(t),permanent:!0,bitrate:64e3,publishers:5,description:socketIOHost}})}},{key:"leaveRoom",value:function(t,n){if(t.getState().mUser.room){var r=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id==n.id}))[0];r&&(t.getState().mUser.room.micUsers=t.getState().mUser.room.micUsers.filter((function(e){return e.user_id!=n.id})),e.removeUserFromMic(t,n,r.micId,!1))}window.pluginHandle&&(n.id,t.getState().mUser.id)}},{key:"joinRoom",value:function(t){var n=e.generateJanusRoomID(t);window.pluginHandle&&n>0&&window.pluginHandle.send({message:{request:"join",ptype:"publisher",room:n,display:window.janusUserID}})}},{key:"getMicIDFromUserID",value:function(e,t){var n=e.getState().mUser.room.micUsers.filter((function(e){return e.user_id==t}))[0];return n?n.micId:null}},{key:"playStream",value:function(t,n,r){var i=e.getMicIDFromUserID(t,r);if(i){if(window.isMicSoundMuted&&n.getTracks().forEach((function(e){return e.enabled=!1})),e.isMicMuted(i)&&n.getTracks().forEach((function(e){return e.enabled=!1})),window.incomingMicStreams[i]=n,"srcObject"in window["micAudio"+i])try{window["micAudio"+i].srcObject=n}catch(e){if("TypeError"!=e.name)throw e;window["micAudio"+i].src=URL.createObjectURL(n)}else window["micAudio"+i].src=URL.createObjectURL(n);window["micAudio"+i].onloadedmetadata=function(n){if(window["micAudio"+i].paused){var r=window["micAudio"+i].play();r&&r.then((function(){})).catch((function(n){e.askForPlayingAudio(t,i)}))}e.isSafari()&&(window["micAudio"+i].muted=!1)},e.playVisualizer(n,i)}}},{key:"playVisualizer",value:function(e,t){var n=window.AudioContext||window.webkitAudioContext||!1;if(n){var r,i=document.getElementById("mic-speakers--item-"+t),o=new n,a=o.createAnalyser();o.createMediaStreamSource(e).connect(a),a.connect(o.destination),r=new Uint8Array(a.frequencyBinCount),requestAnimationFrame((function e(){a.getByteFrequencyData(r),r[2]&&r[2]>=20?i.classList.add("ripple"):i.classList.remove("ripple"),requestAnimationFrame(e)}))}else console.log("AudioContext not supported")}},{key:"addMidAudios",value:function(){$("#mic-audio-1").length||($("body").append('<audio id="mic-audio-1"></audio>'),window.micAudio1=document.querySelector("#mic-audio-1"),window.micAudio1.muted=!0),$("#mic-audio-2").length||($("body").append('<audio id="mic-audio-2"></audio>'),window.micAudio2=document.querySelector("#mic-audio-2"),window.micAudio2.muted=!0),$("#mic-audio-3").length||($("body").append('<audio id="mic-audio-3"></audio>'),window.micAudio3=document.querySelector("#mic-audio-3"),window.micAudio3.muted=!0),$("#mic-audio-4").length||($("body").append('<audio id="mic-audio-4"></audio>'),window.micAudio4=document.querySelector("#mic-audio-4"),window.micAudio4.muted=!0),$("#mic-audio-5").length||($("body").append('<audio id="mic-audio-5"></audio>'),window.micAudio5=document.querySelector("#mic-audio-5"),window.micAudio5.muted=!0)}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"onMuteClicked",value:function(t){$("#mic-speakers--mute").on("click",(function(t){var n=$("#mic-speakers--mute");window.isMicSoundMuted?(e.unmuteAllUsers(),window.isMicSoundMuted=!1,n.removeClass("muted")):(window.isMicSoundMuted=!0,e.muteAllUsers(),n.addClass("muted"))}))}},{key:"getRndInteger",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"render",value:function(e){return"<div id='mic-speakers'><span id='mic-speakers--item-1' class='mic-speakers--item disabled' data-id='1'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>1</span></span></span><span id='mic-speakers--item-2' class='mic-speakers--item disabled' data-id='2'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>2</span></span></span><span id='mic-speakers--item-3' class='mic-speakers--item disabled' data-id='3'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>3</span></span></span><span id='mic-speakers--item-4' class='mic-speakers--item disabled' data-id='4'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>4</span></span></span><span id='mic-speakers--item-5' class='mic-speakers--item disabled' data-id='5'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span><span class='number'>5</span></span></span><span id='mic-speakers--mute'></span></div>"}}],(n=null)&&ne(t.prototype,n),r&&ne(t,r),e}(),ie=n(52),oe=n.n(ie);function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var se=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onHide(t),e.onCancel(t),e.onAccept(t)}},{key:"getAudioConstraints",value:function(){return{autoGainControl:!1,channelCount:1,echoCancellation:!0,latency:0,noiseSuppression:!0,sampleRate:8e3,sampleSize:8,volume:1}}},{key:"onCallReceived",value:function(){window.callsPeer.on("call",(function(t){window.incomingCall=t,navigator.getUserMedia?navigator.getUserMedia({audio:e.getAudioConstraints()},(function(e){t.answer(e),window.outgoinCallStream=e}),e.gotUserMediaError):navigator.mediaDevices.getUserMedia({audio:e.getAudioConstraints()}).then((function(e){t.answer(e),window.outgoinCallStream=e})).catch(e.gotUserMediaError),t.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),t.on("error",(function(e){console.log("CallDialog.onCallReceived.call.on.error",e.type,e.message)}))}))}},{key:"startPeerCall",value:function(t){navigator.getUserMedia?navigator.getUserMedia({audio:e.getAudioConstraints()},(function(n){var r=window.callsPeer.call(t+"call",n);r&&(r.on("error",(function(e){console.log("callUser.outgoing.on.error",e.type,e.message)})),r.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),window.outgoinCall=r,window.outgoinCallStream=n,window.isCalling=!0)}),e.gotUserMediaError):navigator.mediaDevices.getUserMedia({audio:e.getAudioConstraints()}).then((function(n){var r=window.callsPeer.call(t,n);r&&(r.on("error",(function(e){console.log("callUser.outgoing.on.error",e.type,e.message)})),r.on("stream",(function(t){window.incomingCallStream=t,e.playStream(t)})),window.outgoinCall=r,window.outgoinCallStream=n,window.isCalling=!0)})).catch(e.gotUserMediaError)}},{key:"callUser",value:function(t){return navigator.mediaDevices?$("#call_container").html()?$("#call-dialog").show():void t.getState().socket.emit("req",Kt({type:"CALL_REQUEST",data:{id:t.getState().currentConversation.id}}),(function(n){if("rigning"==n.message){t.dispatch(Q(!0));var r={user:n.user,dialogType:"call-sent",statusClass:"warning",status:"يتم الإتصال الآن..."};for(var i in t.dispatch(Z(r)),e.render(t,r,!0),currentMicCallObjct)currentMicCallObjct[i]&&currentMicCallObjct[i].callId==t.getState().mUser.id&&re.leaveMic(t,i,t.getState().mUser.id)}else"not ready"==n.message?t.dispatch(Q(!0)):alert(n.message)})):alert("هذا المتصفح أو الجهاز لا يدعم هذه الخصاية")}},{key:"close",value:function(){$("#call_container").html(""),window.callsAudio.src=null,window.callsAudio.srcObject=null,window.isCalling=!1,window.callsPeer&&window.callsPeer.destroy(),window.outgoinCall&&window.outgoinCall.close(),window.outgoinCallStream&&window.outgoinCallStream.getTracks().forEach((function(e){return e.stop()})),window.incomingCall&&window.incomingCall.close(),window.incomingCallStream&&window.incomingCallStream.getTracks().forEach((function(e){return e.stop()}))}},{key:"onHide",value:function(e){$("#call-dialog-footer__hide").unbind("click").on("click",(function(t){e.dispatch(Q(!1)),$("#call-dialog").hide()}))}},{key:"onAccept",value:function(t){$("#call-dialog-footer__accept").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"CALL_REQUEST_ACCEPT",data:{id:t.getState().currentCall.user.id}}),(function(n){for(var r in e.startPeerCall(n),currentMicCallObjct)currentMicCallObjct[r]&&currentMicCallObjct[r].callId==t.getState().mUser.id&&re.leaveMic(t,r,t.getState().mUser.id);$("#call-dialog-footer__accept, #call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}))}))}},{key:"onCallAccepted",value:function(){$("#call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}},{key:"onCancel",value:function(t){$("#call-dialog-footer__cancel").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Kt({type:"CALL_REQUEST_CANCEL",data:{id:t.getState().currentCall.user.id}}),(function(n){e.close(),t.dispatch(Q(!1))}))}))}},{key:"gotUserMediaError",value:function(e){console.log("gotUserMediaError",e)}},{key:"playStream",value:function(t){try{window.callsAudio.srcObject=t}catch(e){window.callsAudio.src=window.URL.createObjectURL(t)}window.callsAudio.onloadedmetadata=function(t){window.callsAudio.paused&&window.callsAudio.play(),e.isSafari()&&(window.callsAudio.muted=!1)}}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"getIceServers",value:function(){return{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"initPeer",value:function(t){window.outgoinCall=null,window.outgoinCallStream=null,window.incomingCall=null,window.incomingCallStream=null,window.callsPeer=new oe.a(t.getState().socket.id+"call",{host:"peerjs-server.herokuapp.com",port:443,secure:!0,config:e.getIceServers(),debug:1}),window.callsPeer.on("error",(function(e){console.log("initPeer.on.error",e.type,e.message)})),e.onCallReceived(t)}},{key:"render",value:function(t,n,r){var i="<div id='call-dialog' style='display: "+(t.getState().isCallDialogOpen?"block":"none")+"'>";i+="<p class='target-user-name'>"+n.user.username+"</p>",i+="<img class='target-user-avatar' src='"+n.user.avatar+"' alt='' />",i+="<p id='call-dialog__status_start_call' class='call-status success'>بدأ المكالمة</p>",i+="<p id='call-dialog__status' class='call-status "+n.statusClass+"'>"+n.status+"</p>",i+="<p class='call-dialog-footer'>",i+="<button id='call-dialog-footer__cancel' class='btn btn-danger call-cancel'><i class='fa fa-phone'></i>إلغاء</button>","call-received"==n.dialogType&&(i+="<button id='call-dialog-footer__accept' class='btn btn-success call-accept'><i class='fa fa-phone'></i>قبول</button>"),i+="<button id='call-dialog-footer__hide' class='btn btn-warning pull-right call-dialog-hide'><i class='fa fa-minus'></i>إخفاء</button>",i+="</p>",i+="</div>",$("#call_container").append(i),e.registerEvents(t),e.initPeer(t)}}],(n=null)&&ae(t.prototype,n),r&&ae(t,r),e}();function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.close(t),e.mute(t),e.onCall(t),e.expand(),e.compress(),e.onSubmit(t),e.sendMedia(t),e.stopRecording(t),e.startRecording(t),e.openFacePicker(t),e.onChatBoxClicked(t),e.triggerSendMediaInput(t)}},{key:"onCall",value:function(e){$("#chat_box__footer__call").unbind("click").on("click",(function(t){se.callUser(e)}))}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation&&e==t.getState().currentConversation.id){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var r=$("#chat_box");r&&(r.find(".chat_box__header__avatar").attr("src",n.avatar),r.find(".chat_box__header__name").html(S.render(n)))}}}},{key:"openFacePicker",value:function(e){$("#chat_box #chat_box__footer__smile").unbind("click").on("click",(function(t){e.dispatch(O(!0)),y.registerEvents(e)}))}},{key:"onSubmit",value:function(t){$("#chat_box form").unbind("submit").on("submit",(function(n){n.preventDefault();var r=t.getState().currentConversation.id,i=n.target.message,o=i.value.trim();o&&(e.sendMessage({message:o,id:r,type:"text"},i,t),i&&(i.value=""))}))}},{key:"sendMessage",value:function(t,n,r){var i=t.message,o=t.id,a=t.type;!n||"text"!=a&&"youtube"!=a||n.focus(),r||(r=window.store),o||(o=r.getState().currentConversation.id),r.getState().socket.emit("req",Kt({type:"NEW_PRIVATE_MESSAGE",data:{id:o,message:i,type:a}}),(function(t){if("string"==typeof(t=Qt(t)))return X.render({id:Date.now(),user:r.getState().users.filter((function(e){return e.id==o}))[0],type:null,message:t,title:"تنبيه"},r);if("object"==ce(t)){var n=o,i=r.getState().mUser,a=r.getState().currentConversation,s=t,c=r.getState().currentConversation.id==n;r.dispatch(P(n,i,a,c,s)),e.insert(s,i,r)}}))}},{key:"triggerSendMediaInput",value:function(){$("#chat_box__footer__share").unbind("click").on("click",(function(e){if(!$(this).closest("form").hasClass("loading")){var t=document.getElementById("chat_box__footer_attach");t&&t.click()}}))}},{key:"sendMedia",value:function(t){$("#chat_box__footer_attach").unbind("change").on("change",(function(n){var r=this,i=new FormData;i.append("file",n.target.files[0]),t.getState().socket.emit("req",Kt({type:"BEFORE_SEND_MEDIA",data:{id:t.getState().currentConversation.id}}),(function(n){if("string"==typeof(n=Qt(n)))return alert(n);if(!0===n){$(r).closest("form").addClass("loading");var o=$("#chat_box__footer__loading_percent");N.a.post("/send_private_media",i,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);o.text(t<10?"0"+t:t)}}).then((function(n){!1===n.data.error&&e.sendMessage({message:n.data.file,id:t.getState().currentConversation.id,type:n.data.type},void 0,t),$(r).closest("form").removeClass("loading"),o.text("00")})).catch((function(e){$(r).closest("form").removeClass("loading"),o.text("00")}))}}))}))}},{key:"insert",value:function(t,n,r){$("#chat_box_container #chat_box__body").append(R.render(t,n,r)),e.scrollToBottom(),R.registerEvents(r)}},{key:"onChatBoxClicked",value:function(e){$("#chat_box").unbind("click").on("click",(function(t){e.dispatch(r(null)),qt.togglePane(e,!0)}))}},{key:"close",value:function(e){$("#chat_box__header__close").unbind("click").on("click",(function(t){$("#chat_box_container").html(""),e.dispatch(E(null))}))}},{key:"expand",value:function(){$("#chat_box__header__expand").unbind("click").on("click",(function(e){$("#chat_box").addClass("expanded")}))}},{key:"compress",value:function(){$("#chat_box__header__compress").unbind("click").on("click",(function(e){$("#chat_box").removeClass("expanded")}))}},{key:"mute",value:function(e){$("#chat_box__header__mute, #chat_box__header__unmute").unbind("click").on("click",(function(t){e.getState().socket.emit("req",Kt({type:"TOGGLE_PRIVATE_BIP",data:{}}),(function(t){t=Qt(t),W.updateUserAttribute("isPrivateBipEnabled",t,e),e.getState().mUser.reg_id||Xt("isPrivateBipEnabled",Kt(t,!0)),t?$("#chat_box").removeClass("muted"):$("#chat_box").addClass("muted")}))}))}},{key:"playNotification",value:function(e){if(e.getState().mUser.isPrivateBipEnabled){var t=document.getElementById("private-bip");t&&t.play()}}},{key:"renderMessages",value:function(e){var t=e.getState().currentConversation,n=e.getState().conversations.filter((function(e){return e.id==t.id}))[0],r="";return n&&n.messages.forEach((function(t){var i=n.me.id==t.by?n.me:n.him;r+=R.render(t,i,e)})),r}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chat_box__body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"startRecording",value:function(t){$("#chat_box__footer__start_recording").unbind("click").on("click",(function(n){$("#chat_box__footer__start_recording").hide(),$("#chat_box__footer__stop_recording").show(),window.isRecordingSound||(window.isRecordingSound=!0,window.store=t,navigator.mediaDevices.getUserMedia({audio:!0}).then(e.onMediaStreamSuccess).catch(e.onMediaStreamError))}))}},{key:"stopRecording",value:function(e){$("#chat_box__footer__stop_recording").unbind("click").on("click",(function(e){$("#chat_box__footer__stop_recording").hide(),$("#chat_box__footer__start_recording").show(),window.isRecordingSound=!1,null!=window.mediaRecorder&&(window.mediaRecorder.stop(),null!=window.mediaRecorder.stream&&window.mediaRecorder.stream.stop())}))}},{key:"uploadblob",value:function(e,t){if(e){var n=new FormData;n.append("file",e),n.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_upload_blob",type:"POST",data:n,cache:!1,processData:!1,contentType:!1,success:function(e){(e=JSON.parse(e))&&!e.error&&e.src?t(e.src):alert("حدث خطأ أثناء حفظ التسجيل")},error:function(e){alert("حدث خطأ أثناء حفظ التسجيل")}})}}},{key:"onMediaStreamSuccess",value:function(t){try{window.mediaRecorder=new K.a(t);var n=null;window.mediaRecorder.bufferSize=8192,window.mediaRecorder.stream=t,window.mediaRecorder.mimeType="audio/webm",window.mediaRecorder.dur=Date.now(),window.mediaRecorder.ondataavailable=function(t){if(!((Date.now()-window.mediaRecorder.dur)/1e3<1)){var r=$('<div class="audio-recorder"><audio type="audio/webm" controls></audio><button class="btn btn-success">إرسال</button>&nbsp;<button class="btn btn-danger">إلغاء</button></div>');r.find("audio").attr("src",window.URL.createObjectURL(t)),e.uploadblob(t,(function(e){r.find("audio").attr("src","/uploads/private/"+e),n=e})),r.find(".btn-success").click((function(){n&&e.sendMessage({message:n,id:null,type:"sound"}),r.remove()})),r.find(".btn-danger").click((function(){r.remove(),e.removeBlob(n)})),$("#chat_box__body").append(r)}},window.mediaRecorder.start(3e4)}catch(e){console.log("onMediaStreamSuccess.error",e)}}},{key:"onMediaStreamError",value:function(e){window.isRecordingSound=!1,window.store=void 0,alert("هذا المتصفح لا يدعم ميزة التسجيل, الرجاء إستخدام جوجل كروم")}},{key:"removeBlob",value:function(e){window.store=void 0;var t=new FormData;t.append("file",e),t.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_remove_blob",type:"POST",data:t,cache:!1,processData:!1,contentType:!1,success:function(e){},error:function(e){}})}},{key:"render",value:function(t){var n=t.getState().currentConversation;if(!n)return $("#chat_box_container").html("");var r="<div id='chat_box' class='"+(t.getState().mUser.isPrivateBipEnabled?"":"muted")+"'>";r+="<header class='chat_box__header label-primary'>",r+="<img class='chat_box__header__avatar' width='25' height='25' src='"+n.avatar+"' alt='' />",r+="<p class='chat_box__header__name ellipsis'>"+S.render(n)+"</p>",r+="<button id='chat_box__header__close' class='btn btn-danger fa fa-minus pull-right'></button>",r+="<button id='chat_box__header__expand' class='btn btn-info fa fa-expand pull-right'></button>",r+="<button id='chat_box__header__compress'class='btn btn-info fa fa-compress pull-right'></button>",r+="<button id='chat_box__header__mute' class='btn btn-success fa fa-bell-o pull-right'></button>",r+="<button id='chat_box__header__unmute' class='btn btn-success fa fa-bell-slash-o pull-right'></button>",r+="</header><div class='clear'></div>",r+="<div class='chat_box__body' id='chat_box__body' style='background: "+en(t.getState().settings)+"'>",r+=e.renderMessages(t),r+="</div>",r+="<footer class='chat_box__footer'>",r+=y.render("private_messages","#chat_box__footer__input",t),r+="<form>",r+="<button id='chat_box__footer__start_recording' type='button' class='btn btn-primary fa fa-microphone'></button>",r+="<button id='chat_box__footer__stop_recording' type='button' class='btn btn-primary fa fa-stop'></button>",r+="<button id='chat_box__footer__share' type='button' class='btn btn-primary fa fa-share-alt'></button>",r+="<span style='position: relative'><span id='chat_box__footer__loading_percent'>00</span><img id='chat_box__footer__loader' src='/images/loader.gif' width='30' height='30' alt=''/></span>",r+="<button type='button' id='chat_box__footer__call' class='btn btn-primary fa fa-phone'></button>",r+="<img style='cursor: pointer' src='/images/smile.gif' alt='فيس' id='chat_box__footer__smile' class='chat_box__footer__smile' width='22' height='22' />",r+="<input class='chat_box__footer__input' id='chat_box__footer__input' dir='rtl' name='message' type='text' placeholder='أكتب رسالتك هنا...' autoComplete='off' />",r+="<button id='chat_box__footer__submit' class='btn btn-primary fa fa-send'></button>",r+="<input id='chat_box__footer_attach' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",r+="</form>",r+="</footer>",r+="</div>",$("#chat_box_container").html(r),t.dispatch({type:"READ_CONVERSATION",id:n.id}),e.registerEvents(t),e.scrollToBottom(),qt.updateConversationsCount(t),R.registerEvents(t)}}],(n=null)&&ue(t.prototype,n),i&&ue(t,i),e}();function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--private").unbind("click").click("click",(function(t){e.dispatch(E(e.getState().requestedUser)),e.dispatch(e.dispatch(r(null))),qt.togglePane(e,!0),$("#user_profile").modal("hide"),le.render(e)}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--private' class='btn btn-default fa fa-comment'>محادثه خاصه</button></span>"}}],(n=null)&&de(t.prototype,n),i&&de(t,i),e}();function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--notify").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id,r=prompt("الرجاء إدخال الرسالة التنبيهية");(r=r?r.trim():null)&&e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_NOTIFY",data:{id:n,message:r}}),(function(e){alert(Qt(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--notify' class='btn btn-default fa fa-envelope-o'>تنبيه</button></span>"}}],(n=null)&&fe(t.prototype,n),r&&fe(t,r),e}();function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--like").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_LIKE",data:{id:n}}),(function(t){!0===(t=Qt(t))&&($("#user_profile__footer__actions__item--like").parent().addClass("active"),$("#user_profile__footer__actions__item--like").find("span").text(e.getState().requestedUser.likes+1))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.liked?"active":"")+"'>";return t+="<button id='user_profile__footer__actions__item--like' class='btn btn-default fa fa-heart red'><span>"+e.getState().requestedUser.likes+"</span></button>",t+="</span>"}}],(n=null)&&me(t.prototype,n),r&&me(t,r),e}();function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ve=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--album").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_GET_ALBUM",data:{id:n}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_ALBUM",album:e}}(t))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return t+="<button id='user_profile__footer__actions__item--album' class='btn btn-default fa fa-image purple'><span dir='rtl'> ("+e.getState().requestedUser.albumLength+") </span><span>الألبوم</span></button>",t+="</span>"}}],(n=null)&&_e(t.prototype,n),r&&_e(t,r),e}();function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(){e.onAction()}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--gift").unbind("click").click("click",(function(e){$("#user_profile .gifts_picker").show(),$("#user_profile .user_profile__body__avatar").hide()}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--gift' class='btn btn-default fa fa-diamond blue'>إرسال هدية</button></span>"}}],(n=null)&&ye(t.prototype,n),r&&ye(t,r),e}(),we=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_REVEAL_NAMES",isRevealNamesOpen:e}};function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.back(t)}},{key:"back",value:function(t){$("#reveal_names__header__back").unbind("click").on("click",(function(n){t.dispatch(we(!1)),e.close()}))}},{key:"renderName",value:function(e){if(!e)return"";var t="<div class='reveal_names__item'>";return t+="<p><span class='reveal_names__item__key'>العضو</span><span className='reveal_names__item__value'>"+e.username+"</span></p>",t+="<p><span class='reveal_names__item__key'>الزخرفة</span><span className='reveal_names__item__value'>"+e.decoration+"</span></p>",t+="<p><span class='reveal_names__item__key'>الدولة</span><span className='reveal_names__item__value'><img src='images/flags/"+e.country+".png' /></span></p>",t+="<p><span class='reveal_names__item__key'>الأيبي</span><span className='reveal_names__item__value'>"+e.ip+"</span></p>",t+="<p><span class='reveal_names__item__key'>الجهاز</span><span className='reveal_names__item__value'>"+e.device+"</span></p>",t+="</div>"}},{key:"renderNames",value:function(t){var n=$("#user_profile .reveal_names_body");n.html(""),t.getState().revealNames.forEach((function(t){n.append(e.renderName(t))}))}},{key:"open",value:function(t){$("#reveal_names__container").show(),$("#user_profile__body__user_details").hide(),$("#user_profile .user_profile__footer").hide(),e.renderNames(t),e.back(t)}},{key:"close",value:function(){$("#reveal_names__container").hide(),$("#user_profile__body__user_details").show(),$("#user_profile .user_profile__footer").show()}},{key:"render",value:function(t){var n="<div id='reveal_names__container' class='reveal_names' style='display: none;'>";return n+="<p class='reveal_names__header'>",n+="<button id='reveal_names__header__back' class='btn btn-success fa fa-arrow-left'>عودة</button>",n+="<span class='fr'>كشف النكات</span>",n+="</p>",n+="<div class='reveal_names_body'>"+e.renderNames(t)+"</div>",n+="</div>"}}],(n=null)&&Se(t.prototype,n),r&&Se(t,r),e}();function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--reveal-names").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_REVEAL_NAMES",data:{id:n}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);Array.isArray(t)&&(e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REVEAL_NAMES",names:e}}(t)),e.dispatch(we(!0)),ke.open(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--reveal-names' class='btn btn-default fa fa-search'>كشف النكات</button></span>"}}],(n=null)&&Ce(t.prototype,n),r&&Ce(t,r),e}();function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--remove-avatar").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_REMOVE_AVATAR",data:{id:n}}),(function(t){"string"==typeof(t=Qt(t))?alert(t):(e.dispatch(D(t)),ct.clearAvatar(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--remove-avatar' class='btn btn-default fa fa-ban maroon'>حذف الصورة</button></span>"}}],(n=null)&&Te(t.prototype,n),r&&Te(t,r),e}();function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--room-excpel").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_ROOM_EXCPEL",data:{id:n}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--room-excpel' class='btn btn-default fa fa-sign-out magenta'>طرد من الغرفة</button></span>"}}],(n=null)&&Ae(t.prototype,n),r&&Ae(t,r),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--excpel").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_EXCPEL",data:{id:n}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--excpel' class='btn btn-default fa fa-ban'>طرد</button></span>"}}],(n=null)&&Oe(t.prototype,n),r&&Oe(t,r),e}();function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ie=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--ban").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_BAN",data:{id:n}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--ban' class='btn btn-default fa fa-ban'>باند</button></span>"}}],(n=null)&&Me(t.prototype,n),r&&Me(t,r),e}();function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.getProfile(t)}},{key:"getProfile",value:function(e){$(".chat_pane__user_item").unbind("click").on("click",(function(t){var n=$(this).closest(".chat_pane__user_item").data("id");ct.show(n,e)}))}},{key:"render",value:function(e,t,n){var r=e.micStatus.onMic?"on-mic ":"",i=e.micStatus.onHand?"on-hand ":"",o=e.micStatus.soundOff?"on-sound-off ":"",a=e.micTime?e.micTime+Date.now():0,s=e.active?"active":"",c=e.isHidden?"hidden":"",u="<div id='user-"+e.id+"' data-id='"+e.id+"' class='border chat_pane__user_item "+s+" "+c+" '>";return u+="<p class='chat_pane__user_item__avatar'>","?test"==location.search?u+="<img class='"+e.state+"' width='36' height='36' alt='' src='/images/floating_rose2.png' />":u+="<img class='"+e.state+"' width='36' height='36' alt='' src='"+e.avatar+"?v=1' />",u+=t?"<span class='status "+e.state+"'></span>":"",u+="</p>",u+="<div>",u+="<h5 class='chat_pane__user_item__name'>",u+=S.render(e),u+="</h5>",u+="<h5 style='color: "+e.statusColor+"' class='chat_pane__user_item__status'>",u+=_.render(e.status,n),e.hashTag&&(u+="<span class='chat_pane__user_item__status__hash'>#"+e.hashTag+"</span>"),u+="</h5>",u+="</div>",u+="<img class='chat_pane__user_item__flag' alt='' width='16' height='16' src='"+e.countryFlag+"' />",u+="<div class='clear'></div>",t&&(u+="<p class='chat_pane__user_item__mic_status "+r+" "+i+" "+o+"' >",e.micStatus.onMic&&(u+="<span class='mic-time' data-time='"+a+"'>00:00</span>"),u+="<img class='mic' alt='' src='/images/mic.png' />",u+="<img class='hand' alt='' src='/images/hand.png' />",u+="<img class='sound-off' alt='' src='/images/sound-off.png' />",u+="</p>"),u+="</div>"}}],(n=null)&&De(t.prototype,n),r&&De(t,r),e}();function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.filterUsersByName(t)}},{key:"updateUser",value:function(e,t){var n=$("#chat__body__users-pane #user-"+e);if(n){var r=t.getState().users.filter((function(t){return t.id==e}))[0];if(r){var i=r.micStatus.onMic?"on-mic ":"",o=r.micStatus.onHand?"on-hand ":"",a=r.micStatus.soundOff?"on-sound-off ":"",s=r.micTime?r.micTime+Date.now():0;r.active?n.addClass("active"):n.removeClass("active"),r.isHidden?n.addClass("hidden"):n.removeClass("hidden"),n.find(".chat_pane__user_item__avatar img").attr("src",r.avatar).removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(r.state),n.find(".chat_pane__user_item__avatar .status").removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(r.state),n.find(".chat_pane__user_item__name").html(S.render(r)),n.find(".chat_pane__user_item__status").html(_.render(r.status,t)).css("color",r.statusColor),n.find(".chat_pane__user_item__mic_status").removeClass("on-mic").removeClass("on-hand").removeClass("on-sound-off").addClass(i).addClass(o).addClass(a),r.micStatus.onMic&&n.find(".chat_pane__user_item__mic_status .mic-time").data("time",s)}}}},{key:"filterUsersByName",value:function(t){$("#chat__body__users-pane input.chat_pane__search").on("keyup",(function(n){var r,i;0==n.target.value.trim().indexOf("#")?t.dispatch({type:"FILTER_USERS_BY_HASH_TAG",hashTag:(i=n.target.value.trim().replaceAll("#","")).trim()?i:null}):t.dispatch({type:"FILTER_USERS_BY_NAME",name:(r=n.target.value.trim()).trim()?r:null}),e.setUsers(t)}))}},{key:"updateCurrentRoomName",value:function(e){$(".chat_pane__container .chat_pane__container__room_name").text(e.getState().mUser.room?e.getState().mUser.room.name:"")}},{key:"setUsers",value:function(t){"users"==t.getState().currentPane&&(e.setUsersOnCurrentRoom(t),e.setUsersOnOtherRooms(t),e.updateCurrentRoomName(t),window.usersPane.find("img").on("contextmenu",(function(){return!1})))}},{key:"setUsersOnCurrentRoom",value:function(e){window.usersPane.find("#chat__body__users-pane__current_room .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__current_room");t.html(""),e.getState().usersFilter?isNaN(e.getState().usersFilter)?e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(n){t.append(Be.render(n,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.hashTag==e.getState().usersFilter})).forEach((function(n){t.append(Be.render(n,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(n){t.append(Be.render(n,!0,e))})),Be.registerEvents(e)}},{key:"setUsersOnOtherRooms",value:function(e){window.usersPane.find("#chat__body__users-pane__other_rooms .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__other_rooms");t.html(""),e.getState().usersFilter?e.getState().users.filter((function(t){return(!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id)&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(n){t.append(Be.render(n,!0,e))})):e.getState().users.filter((function(t){return!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(n){t.append(Be.render(n,!0,e))})),Be.registerEvents(e)}},{key:"scrollToTop",value:function(){window.usersPane.find(".chat_pane__container").scrollTop(0)}},{key:"render",value:function(e){var t=" <div id='chat__body__users-pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return t+=f.render("المتواجدين"),t+="<input type='text' name='user-name' class='form-control chat_pane__search' placeholder='البحث...' />",t+="<div class='chat_pane__container border'>",t+="<h4 class='chat_pane__label label label-primary right'>المتواجدون في <span class='chat_pane__container__room_name'></span></h4>",t+="<div id='chat__body__users-pane__current_room'></div>",t+="<h4 class='chat_pane__label label label-primary'>المتواجدون في غرف أخرى</h4>",t+="<div id='chat__body__users-pane__other_rooms'></div>",t+="</div>",t+="</div>"}}],(n=null)&&Ue(t.prototype,n),r&&Ue(t,r),e}();function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.close(t),e.setUsers(t)}},{key:"close",value:function(e){$(".chat__body__ignored-users-pane__back button").unbind("click").on("click",(function(t){e.dispatch(r("settings")),qt.togglePane(e)}))}},{key:"setUsers",value:function(e){var t=$("#chat__body__ignored-users-pane .chat_pane__container");t.html(""),e.getState().users.forEach((function(n){e.getState().ignoredUsers.includes(n.id)&&t.append(Be.render(n,!0,e))})),Be.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__ignored-users-pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return t+=f.render("المستخدمون المتجاهلين"),t+="<p class='chat__body__ignored-users-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(n=null)&&je(t.prototype,n),i&&je(t,i),e}();function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.ignore(t),e.unignore(t)}},{key:"ignore",value:function(e){$("#user_profile__footer__actions__item--ignore").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(n)||(e.dispatch({type:"IGNORE_USER",id:n}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").addClass("ignored"),qt.updateUsersCout(e),Fe.setUsers(e))}))}},{key:"unignore",value:function(e){$("#user_profile__footer__actions__item--unignore").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(n)&&(e.dispatch({type:"UNIGNORE_USER",id:n}),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").removeClass("ignored"),qt.updateUsersCout(e),Fe.setUsers(e))}))}},{key:"render",value:function(e){var t=e.getState().requestedUser.id,n="<span class='user_profile__footer__actions__item "+(e.getState().ignoredUsers.includes(t)?"ignored":"")+"'>";return n+="<button id='user_profile__footer__actions__item--ignore' class='btn btn-default fa fa-ban red'>تجاهل</button>",n+="<button id='user_profile__footer__actions__item--unignore' class='btn btn-default fa fa-ban red'>إلغاء التجاهل</button>",n+="</span>"}}],(n=null)&&Ne(t.prototype,n),r&&Ne(t,r),e}();function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--chat-app").unbind("click").click("click",(function(e){window.open("https://play.google.com/store/apps/details?id=com.chat.chatiraqona")}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--chat-app' class='btn btn-default fa fa-android green'>تطبيق الشات</button></span>"}}],(n=null)&&qe(t.prototype,n),r&&qe(t,r),e}();function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--cancel-radio").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CANCEL_RADIO",data:{id:n}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--cancel-radio' class='btn btn-default fa fa-ban'>سحب المايك</button></span>"}}],(n=null)&&Ve(t.prototype,n),r&&Ve(t,r),e}();function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var He=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.mute(t),e.unmute(t)}},{key:"mute",value:function(e){$("#user_profile__footer__actions__item--mute").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_MUTE",data:{id:n}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").addClass("muted")}))}))}},{key:"unmute",value:function(e){$("#user_profile__footer__actions__item--unmute").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_UNMUTE",data:{id:n}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").removeClass("muted")}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.isMuted?"muted":"")+"'>";return t+="<button id='user_profile__footer__actions__item--mute' class='btn btn-default fa fa-microphone'>كتم</button>",t+="<button id='user_profile__footer__actions__item--unmute' class='btn btn-default fa fa-microphone-slash'>إلغاء الكتم</button>",t+="</span>"}}],(n=null)&&ze(t.prototype,n),r&&ze(t,r),e}();function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-decoration").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=t.target.decoration.value;e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CHANGE_DECORATION",data:{id:n,decoration:r}}),(function(e){"string"==typeof(e=Qt(e))&&alert(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-decoration' >";return t+="<label for='user_profile__footer__actions__change_decoration' class='label label-primary user_profile__footer__actions__item_group__label'>الزخرفة</label>",t+="<input type='text' id='user_profile__footer__actions__change_decoration' name='decoration' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.name+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>",t+="</form>"}}],(n=null)&&Je(t.prototype,n),r&&Je(t,r),e}();function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--control-likes").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=parseInt(t.target.likes.value);isNaN(r)||e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CONTROL_LIKES",data:{id:n,likes:r}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e);$("#user_profile__footer__actions__item--like").find("span").text(r)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--control-likes' >";return t+="<label for='user_profile__footer__actions__control_likes' class='label label-primary user_profile__footer__actions__item_group__label'>لايكات</label>",t+="<input type='number' id='user_profile__footer__actions__control_likes' name='likes' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.likes+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>",t+="</form>"}}],(n=null)&&Ye(t.prototype,n),r&&Ye(t,r),e}();function Qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-room").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser,r=n.id,i=t.target.room.value;n.room&&n.room.id==i||e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CHANGE_ROOM",data:{id:r,roomId:i}}),(function(e){alert(Qt(e))}))}))}},{key:"render",value:function(e){var t=e.getState().requestedUser.room?e.getState().requestedUser.room.id:null,n="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-room' >";return n+="<label for='user_profile__footer__actions__change_room' class='label label-primary user_profile__footer__actions__item_group__label'>الغرفة</label>",n+="<select id='user_profile__footer__actions__change_room' name='room' class='user_profile__footer__actions__item_group__input'>",e.getState().rooms.forEach((function(e){var r=e.id==t?"selected":"";n+="<option dir='rtl' "+r+" value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",n+="</form>"}}],(n=null)&&Qe(t.prototype,n),r&&Qe(t,r),e}();function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-subscription-end").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=parseInt(t.target.subscription_end.value);e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CHANGE_SUBSCRIPTION_END",data:{id:n,end:r}}),(function(e){Qt(e)&&alert(Qt(e))}))}))}},{key:"toggle",value:function(e){e.getState().requestedUser&&(e.getState().requestedUser.isSuper&&!e.getState().requestedUser.isOwner?$("#user_profile__footer__actions__item_group--change-subscription-end").show():$("#user_profile__footer__actions__item_group--change-subscription-end").hide(),$("#user_profile__footer__actions__change_subscription_end").val(an(e.getState().requestedUser.subscription_end)))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-subscription-end' >";return t+="<label for='user_profile__footer__actions__change_subscription_end' class='label label-primary user_profile__footer__actions__item_group__label' style='width: 25%'>ينتهي بعد</label>",t+="<input type='number' id='user_profile__footer__actions__change_subscription_end' name='subscription_end' class='user_profile__footer__actions__item_group__input' style='width: 55%' value='"+an(e.getState().requestedUser.subscription_end)+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",t+="</form>"}}],(n=null)&&et(t.prototype,n),r&&et(t,r),e}();function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-role").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser,r=n.id,i=t.target.role.value;n.role!=i&&e.getState().socket.emit("req",Kt({type:"PROFILE_ACTION_CHANGE_ROLE",data:{id:r,roleId:i}}),(function(t){Qt(t)&&alert(Qt(t)),tt.toggle(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-role' >";return t+="<label for='user_profile__footer__actions__change_role' class='label label-primary user_profile__footer__actions__item_group__label'>الرتبة</label>",t+="<select id='user_profile__footer__actions__change_role' name='role' class='user_profile__footer__actions__item_group__input'>",e.getState().requestedUser.roles.forEach((function(n){var r=n.id==e.getState().requestedUser.role?"selected":"";t+="<option dir='rtl' "+r+" value='"+n.id+"'>"+n.name+"</option>"})),t+="</select>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",t+="</form>"}}],(n=null)&&nt(t.prototype,n),r&&nt(t,r),e}();function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){at(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ct=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"registerActionEvents",value:function(e){pe.registerEvents(e),he.registerEvents(e),ge.registerEvents(e),ve.registerEvents(e),be.registerEvents(),Ee.registerEvents(e),Pe.registerEvents(e),Re.registerEvents(e),xe.registerEvents(e),Ie.registerEvents(e),$e.registerEvents(e),Ge.registerEvents(e),We.registerEvents(e),He.registerEvents(e),Xe.registerEvents(e),Ke.registerEvents(e),Ze.registerEvents(e),rt.registerEvents(e),tt.registerEvents(e)}},{key:"show",value:function(t,n){if(!n.getState().isRequestingProfile){var r=n.getState().users.filter((function(e){return e.id==t}))[0];if(!r)return n.getState().socket.emit("req",Kt({type:"PROFILE_SHOW",data:{id:t,force:!0}}),(function(t){n.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_REQUESTING_PROFILE",isRequestingProfile:e}}(!1)),(t=Qt(t)).user&&(n.dispatch(I(ot(ot({},t.user),{},{actions:t.actions,roles:t.roles,liked:t.liked}))),e.render(n),$("#user_profile").modal("show"))}));n.dispatch(I(ot(ot({},r),{},{actions:window.userActions,roles:window.roles,liked:!1}))),e.render(n),$("#user_profile").modal("show"),n.getState().socket.emit("req",Kt({type:"PROFILE_SHOW",data:{id:t}}),(function(t){t=Qt(t),e.setLikes(t.likes,t.liked),tt.toggle(n)}))}}},{key:"setLikes",value:function(e,t){t?$("#user_profile__footer__actions__item--like").parent().addClass("active").find("span").text(e):$("#user_profile__footer__actions__item--like").parent().removeClass("active").find("span").text(e),$("#user_profile__footer__actions__item_group--control-likes").find("input").val(e)}},{key:"clearAvatar",value:function(e){var t=e.getState().requestedUser.avatar;$("#user_profile .user_profile__body__avatar").attr("src",t)}},{key:"render",value:function(t){var n=t.getState().requestedUser;if(!n)return $("#user_profile_container").html("");$("#user_profile_container").html("");var r="<div class='modal fade' id='user_profile' tabindex='-1' role='dialog' aria-hidden='true'>";r+="<div class='modal-dialog' role='document' style='max-width: 345px'>",r+="<div class='modal-content'>",r+="<div class='user_profile__header modal-header label label-primary'>",r+="<div class='modal-title'>",r+="<img class='user_profile__header__avatar' width='25' height='25' src='"+n.avatar+"' alt=''/>",r+="<p class='user_profile__header__name ellipsis'>",r+=S.render(n),r+="</p>",r+="<button data-dismiss='modal' class='btn btn-danger user_profile__header__close'>&times;</button>",r+="</div><div class='clear'></div>",r+="</div>",r+="<div class='user_profile__scroll_area' id='user_profile__scroll_area'>",r+="<div class='user_profile__body modal-body'>",n.actions.reveal_names&&(r+=ke.render(t),ke.registerEvents(t)),r+="<div id='user_profile__body__user_details'>",r+="<img class='user_profile__body__avatar img-rounded img-thumbnail' src='"+n.avatar.replace("/sm/","/lg/")+"' alt=''/>",r+=C.render(t),r+=n.actions.ip?"<p class='user_profile__body__ip label label-success'>"+n.ip+"</p>":"",r+="<p style='color: "+n.statusColor+"' class='user_profile__body__status'>",r+=_.render(n.status,t),r+="</p>",r+="<div dir='rtl'>",r+="<div class='user_profile__body__room'>",r+=ht.render(n.room,!0,t,!0),r+="</div>",r+="<span class='user_profile__body__country_flag'>",r+="<span class='user_profile__body__country_name'>"+n.countryName+"</span>",r+="<img width='18' src='"+n.countryFlag+"' alt='' />",r+="</span>",r+="</div>",r+="<div class='clear'></div>",r+="</div>",r+="</div>",r+="<div class='user_profile__footer modal-footer'>",r+="<div class='user_profile__footer__actions'>",r+=pe.render(t),r+=n.actions.notify?he.render(t):"",r+=ge.render(t),r+=n.actions.gift?be.render():"",r+=n.actions.reveal_names?Ee.render(t):"",r+=n.actions.remove_avatar?Pe.render(t):"",r+=n.actions.room_excpel?Re.render(t):"",r+=n.actions.excpel?xe.render(t):"",r+=n.actions.ban?Ie.render(t):"",r+=$e.render(t),r+=Ge.render(t),r+=n.actions.admin_mute?He.render(t):"",r+=n.actions.change_decoration?Xe.render(t):"",r+=n.actions.control_likes?Ke.render(t):"",r+=n.actions.change_room?Ze.render(t):"",r+=n.actions.change_role?rt.render(t):"",r+=n.actions.change_role?tt.render(t):"",r+="</div>",r+="</div>",r+="</div>",r+="</div>",r+="</div>",r+="</div>",$("#user_profile_container").html(r),e.registerEvents(t),e.registerActionEvents(t),C.registerEvents(t),ht.registerEvents(t),tt.toggle(t),$("#user_profile").find("img").on("contextmenu",(function(){return!1}))}}],(n=null)&&st(t.prototype,n),r&&st(t,r),e}();function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"updateUser",value:function(e,t){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var r=$(".public_message:not(.linen)[data-user='"+e+"']");r&&(r.find(".public_message__avatar img").attr("src",n.avatar),r.find(".public_message__title").html(S.render(n)),r.find(".public_message__content").css("color",n.fontColor)),(r=$(".public_message.linen[data-user='"+e+"']"))&&(r.find(".public_message__avatar img").attr("src",n.avatar),r.find(".public_message__title").html(S.render(n)))}}},{key:"remove",value:function(e){window.publicMessagesContainer.find(".public_message[data-id='"+e+"']").remove()}},{key:"clearSelfMessages",value:function(){return window.publicMessagesContainer.find(".public_self_message").remove()}},{key:"renderGreetUserMessage",value:function(e,t){var n=Date.now(),r=e.icon?"/uploads/greeting-messages/"+e.icon:t.getState().mUser.room.flag,i="<div class='public_message' style='background-color: "+e.backgroundColor+"' >";return i+="<p class='public_message__avatar'>",i+="<img width='36' height='38' src='"+r+"' />",i+="</p>",i+="<div>",i+="<h5 class='public_message__title' style='color: "+e.titleColor+"'>",i+=e.title,i+="</h5>",i+="<h5 class='public_message__content' style='color: "+e.contentColor+"'>",i+=_.render(e.content,t),i+="</h5>",i+="</div>",i+="<span class='public_message__time fr time' data-time='"+n+"' style='color: "+e.titleColor+"'>"+Zt(n)+"</span>",i+="<div class='clear'></div>",i+="</div>"}},{key:"renderJoinLeaveMessage",value:function(e,t){var n=Date.now(),r="<div class='public_message linen' data-user='"+e.user.id+"' >";return r+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",r+="<img width='36' height='38' src='"+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title'>",e.user?r+=S.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content'>",r+=_.render(e.content,t),e.room&&(r+=ht.render(e.room,!0,t)),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Zt(n)+"</span>",r+="<div class='clear'></div>",r+="</div>"}},{key:"renderRoomGreeting",value:function(e,t){var n=Date.now(),r="<div class='public_message greeting' style='background: "+t.getState().settings.self_message_bg_color+"' >";return r+="<p class='public_message__avatar'>",r+="<img width='36' height='38' src='"+e.icon+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>"+t.getState().settings.rooms_greeting_title+"</h5>",r+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",r+=_.render(e.content,t),r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Zt(n)+"</span>",r+="<div class='clear'></div>",r+="</div>"}},{key:"renderPublicMessage",value:function(e,t){var n="<div class='public_message' data-id='"+e.id+"' data-user='"+e.user.id+"'>";return n+="<p class='public_message__avatar' data-id='"+e.user.id+"'>","?test"==location.search?n+="<img width='36' height='38' src='/images/floating_rose2.png' />":n+="<img width='36' height='38' src='"+e.icon+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title'>",e.user?n+=S.render(e.user):n+=e.title,n+="</h5>",e.user&&(n+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",n+=_.render(e.content,t),n+="</h5>"),n+="</div>",n+="<span class='public_message__time fr time' data-time='"+e.id+"'>"+Zt(e.id)+"</span>",t.getState().mUser.canRemovePublicMessages&&(n+="<button data-id='"+e.id+"' class='btn btn-danger fa fa-times public_message__remove'></button>"),n+="<div class='clear'></div>",n+="</div>"}},{key:"renderAd",value:function(e,t){var n=Date.now(),r="<div class='public_message public_message_ad' data-user='"+e.user.id+"' style='background: "+t.getState().settings.self_message_bg_color+"' >";return r+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",r+="<img width='36' height='38' src='"+e.user.avatar+"' />",r+="</p>",r+="<div>",r+="<h5 class='public_message__title'>",e.user?r+=S.render(e.user):r+=e.title,r+="</h5>",r+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",r+=_.render(e.content,t),r+="<span class='public_message__content_title' style='color: blue; margin-right: 0.4rem'>إعلان<span class='fa fa-comment'></span></span>",r+="</h5>",r+="</div>",r+="<span class='public_message__time fr time' data-time='"+n+"'>"+Zt(n)+"</span>",r+="<div class='clear'></div>",r+="</div>"}},{key:"renderSelfMessage",value:function(t,n){var r=Date.now(),i="<div class='public_message public_self_message public_message_ad' style='background: "+n.getState().settings.self_message_bg_color+"' >";return i+="<p class='public_message__avatar'>",i+="<img width='36' height='38' src='"+e.getSelfMessageIcon(n)+"' />",i+="</p>",i+="<div>",i+="<h5 class='public_message__title' style='color: "+n.getState().settings.self_message_title_color+"'>"+t.title+"</h5>",i+="<h5 class='public_message__content' style='color: "+n.getState().settings.self_message_content_color+"' >",i+=_.render(t.content,n),i+="</h5>",i+="</div>",i+="<span class='public_message__time fr time' data-time='"+r+"'>"+Zt(r)+"</span>",i+="<div class='clear'></div>",i+="</div>"}},{key:"renderBotBrbMessage",value:function(t,n){var r=Date.now(),i="<div class='public_message public_bot_brb_message' >";return i+="<p class='public_message__avatar'>",i+="<img width='36' height='38' src='"+e.getBotBrbAvatar(n)+"' />",i+="</p>",i+="<h5 class='public_message__bot_brb_title' style='color: "+n.getState().settings.self_message_title_color+"'>بوت مسابقات برب</h5>",i+="<div>",i+="<h5 class='public_message__title' style='color: "+n.getState().settings.self_message_title_color+"'>",t.user?i+=S.render(t.user):i+=t.title,i+="</h5>",i+="<h5 class='public_message__content' style='color: "+n.getState().settings.self_message_content_color+"' >",i+=_.render(t.content,n),i+="</h5>",i+="</div>",i+="<span class='public_message__time fr time' data-time='"+r+"'>"+Zt(r)+"</span>",i+="<div class='clear'></div>",i+="</div>"}},{key:"getSelfMessageIcon",value:function(e){return e.getState().settings.self_messages_icon?"/uploads/"+e.getState().settings.self_messages_icon:"/images/default_room.png"}},{key:"getBotBrbAvatar",value:function(e){return e.getState().settings.self_messages_icon?"/uploads/"+e.getState().settings.self_messages_icon:"/images/bot_brb.png"}},{key:"render",value:function(t,n){switch(t.type){case"GREET_USER":return e.renderGreetUserMessage(t,n);case"JOIN_LEAVE":return e.renderJoinLeaveMessage(t,n);case"ROOM_GREETING":return e.renderRoomGreeting(t,n);case"PUBLIC_MESSAGE":return e.renderPublicMessage(t,n);case"AD":return e.renderAd(t,n);case"SELF_MESSAGE":return e.renderSelfMessage(t,n);case"BOT_BRB_MESSAGE":return e.renderBotBrbMessage(t,n);default:return null}}},{key:"insert",value:function(t,n){window.publicMessagesContainer.find(".public_message").length>=20&&window.publicMessagesContainer.find(".public_message:first-child").remove();var r=e.render(t,n),i=window.publicMessagesContainer.append(r);i.find(".public_message__avatar").unbind("click").on("click",(function(e){ct.show($(this).data("id"),n)})),i.find(".public_message__remove").unbind("click").on("click",(function(e){var t=e.target.dataset.id;n.getState().socket.emit("req",Kt({type:"REMOVE_PUBLIC_MESSAGE",data:{id:t}}),(function(e){}))})),Vt.scrollToBottom(),"JOIN_LEAVE"==t.type&&ht.registerEvents(n),i.find("img").on("contextmenu",(function(){return!1}))}}],(n=null)&&ut(t.prototype,n),r&&ut(t,r),e}();function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.onFormSubmit(t),e.onLeaveRoom(t),e.openFacePicker(t),e.closePanes(t)}},{key:"onFormSubmit",value:function(t){$("#chat__body__message-input form").on("submit",(function(n){n.preventDefault();var r=n.target.message.value,i=n.target.message;r.trim()&&(i.value="",i.focus(),t.getState().socket.emit("req",Kt({type:"NEW_PUBLIC_MESSAGE",data:{message:r}}),(function(n){if("string"==typeof(n=Qt(n)))return alert(n);r=e.sanitize(r,t.getState().settings.public_msg_length),lt.insert({id:Date.now(),user:t.getState().mUser,icon:t.getState().mUser.avatar,title:t.getState().mUser.name,content:r,type:"PUBLIC_MESSAGE"},t),window.lastMessage={time:Date.now(),isPublic:!0,isPrivate:!1,msg:n.data.message}})))}))}},{key:"onLeaveRoom",value:function(t){$(".chat__body__message-input__leave_room").on("click",(function(){t.getState().socket.emit("req",Kt({type:"LEAVE_ROOM",data:{}}),(function(n){n=Qt(n),lt.insert({icon:n.user.avatar,title:n.user.name,user:n.user,room:null,content:"(هذا المستخدم غادر الغرفة)",type:"JOIN_LEAVE"},t),e.toggleInput(t),re.toggle(t,!1)}))}))}},{key:"toggleInput",value:function(e){e.getState().mUser.room?$("#chat__body__message-input__input, .chat__body__message-input__leave_room").removeAttr("disabled"):$("#chat__body__message-input__input, .chat__body__message-input__leave_room").attr("disabled","disabled")}},{key:"openFacePicker",value:function(t){$("#chat__body__message-input__face").on("click",(function(n){t.dispatch(b(!0)),e.closePanes(t)}))}},{key:"closePanes",value:function(e){$("#chat__body__message-input__input").on("focus",(function(t){e.dispatch(r(null)),qt.togglePane(e)}))}},{key:"canSendMessage",value:function(e){return e.getState().mUser.likes>=e.getState().settings.required_likes_public}},{key:"isXSS",value:function(e){return"string"==typeof e&&/on[a-zA-Z ]{0,}=/g.test(e)}},{key:"convertArNumbers",value:function(e){try{return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/٠/g,"0")).replace(/١/g,"1")).replace(/٢/g,"2")).replace(/٣/g,"3")).replace(/٤/g,"4")).replace(/٥/g,"5")).replace(/٦/g,"6")).replace(/٧/g,"7")).replace(/٨/g,"8")).replace(/٩/g,"9")}catch(t){return e}}},{key:"parseShortcuts",value:function(e){try{var t=e.split(" ");if(!t.length)return"";var n="";return window.shortcuts.values.length?(t.forEach((function(e){if(e.trim().length){var t=window.shortcuts.keys.indexOf(e);n+=t>=0?" "+window.shortcuts.values[t]:" "+e}}))," "==n.charAt(0)?n.replace(" ",""):n):e}catch(e){return""}}},{key:"sanitize",value:function(t,n){try{return"string"!=typeof t?"":e.isXSS(t)?"------":(t=e.convertArNumbers(t),t=(t=n?t.substring(0,n):t).replace(/\s+/g," ").replace(/</g,"").replace(/>/g,""),t=e.parseShortcuts(t))}catch(e){return""}}},{key:"render",value:function(e){var t=e.getState().mUser.room?"":"disabled",n="<div id='chat__body__message-input'>";return n+=y.render("public_messages","#chat__body__message-input__input",e),n+="<form>",n+="<button type='button' class='chat__body__message-input__leave_room btn btn-primary fa fa-sign-out'></button>",n+="<img class='chat__body__message-input__face' id='chat__body__message-input__face' src='/images/smile.gif' alt='فيس' />",n+="<input "+t+" class='border-color chat__body__message-input__input' name='message' id='chat__body__message-input__input' autoComplete='off' type='text' placeholder='أكتب رسالتك هنا' />",n+="<button class='btn btn-primary fa fa-send chat__body__message-input__submit'>إرسال</button>",n+="</form>",n+="</div>"}}],(n=null)&&dt(t.prototype,n),i&&dt(t,i),e}();function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ht=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.joinRoom(t)}},{key:"joinRoom",value:function(t){$(".chat_pane__room_item, .chat_pane__room_item--inline").unbind("click").on("click",(function(n){var r=$(this).data("id"),i=null;if((!t.getState().mUser.room||t.getState().mUser.room.id!=r)&&(!$(this).data("password")||t.getState().mUser.canOpenLockedRooms||(i=prompt("الرجاء إدخال كلمة المرور")))){var o={type:"JOIN_ROOM",data:{id:r,password:i}};t.getState().socket.emit("req",Kt(o),(function(n){!1===(n=Qt(n)).error?(yt.setRooms(t),yt.setCurrentRoomActive(t),e.registerEvents(t),pt.toggleInput(t),re.resetAllMics(),t.getState().mUser.room&&t.getState().mUser.room.micUsers.forEach((function(e){re.setUserOnMic(t,t.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),re.toggle(t,t.getState().mUser.room.is_voice_room)):n.message&&alert(n.message)}))}}))}},{key:"renderRoom",value:function(e,t){var n=t.getState().mUser.room&&t.getState().mUser.room.id==e.id?"active":"",r=e.password?"locked":"",i=e.is_voice_room?"has-mic":"",o="<div data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item "+n+" "+r+" "+i+"' >";return"?test"==location.search?o+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='/images/floating_rose3.png' /></p>":o+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='"+e.flag+"?v=1' /></p>",o+="<div>",o+="<h5 class='chat_pane__room_item__name'>",o+=e.name,o+="<img class='chat_pane__room_item--lock' alt='' src='/images/lock.png' />",o+="<img class='chat_pane__room_item--mic' width='20' alt='' src='/images/mic.png' />",o+="</h5>",o+="<h5 class='chat_pane__room_item__description'>",o+=_.render(e.description,t),o+="</h5>",o+="</div>",o+="<span class='chat_pane__room_item__users corner fa fa-user label label-primary fr'>"+e.users.length+"/"+e.capacity+"</span>",o+="<div class='clear'></div>",o+="</div>"}},{key:"renderInlineRoom",value:function(e,t){var n="<span data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item--inline label label-primary'>";return n+=e.name,n+=t?"<img src='"+e.flag+"?v=1' width='20' alt=''/>":"<span class='fa fa-sign-in'></span>",n+="</span>"}},{key:"render",value:function(t,n,r,i){return t?n&&t?e.renderInlineRoom(t,i):e.renderRoom(t,r):""}}],(n=null)&&ft(t.prototype,n),r&&ft(t,r),e}();function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.createRoom(t)}},{key:"createRoom",value:function(t){$("#createRomModal form").on("submit",(function(n){n.preventDefault();var r=n.target.name.value.trim(),i=n.target.description.value.trim(),o=n.target.welcome.value.trim(),a=n.target.required_likes.value,s=n.target.password.value.trim(),c=n.target.capacity.value,u=n.target.permanent.checked;return r.length?r.length<2?e.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):t.getState().rooms.filter((function(e){return e.name==r})).length?e.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):c<2||c>50?e.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void t.getState().socket.emit("req",Kt({type:"CREATE_ROOM",data:{room:{name:r,description:i,welcome:o,password:s,required_likes:a,capacity:c,isPermanent:u}}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);t&&"object"==mt(t)&&(!1===t.error?e.showSuccessMessage("تم إنشاء الغرفة بنجاح"):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("الرجاء إعطاء إسم للغرفة")}))}},{key:"showErrorMessage",value:function(e){$("#createRomModal .alert-success").hide(),$("#createRomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#createRomModal .alert-success").text(e).show(),$("#createRomModal .alert-danger").hide()}},{key:"render",value:function(t){$("#createRomModal form").unbind("submit"),$("#create_room_container").html("<div class='modal fade room_modal' id='createRomModal' tabindex='-1' role='dialog' aria-hidden='true'><div class='modal-dialog' role='document'><div class='modal-content'><div class='room_modal__header modal-header label label-primary'><div class='modal-title'><p class='room_modal__header__name ellipsis'>إنشاء غرفة جديدة</p><button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button></div></div><div class='room_modal__body modal-body'><p class='alert alert-danger' style='display: none'></p><p class='alert alert-success' style='display: none'></p><form id='room_modal__body__form'><div><div><input type='text' name='name' placeholder='عنوان الغرفة' /></div><div><input type='text' name='description' placeholder='الوصف' /></div><div><input type='text' name='welcome' placeholder='رسالة الترحيب' /></div><div><input type='text' name='password' placeholder='كلمة المرور' /></div><div><input type='number' name='required_likes' placeholder='لايكات الدخول' /></div><div><input type='number' name='capacity' value='50' placeholder='حجم الغرفة من 2 إلى 50' /></div><div><input type='checkbox' name='permanent' id='room_modal__body__checkbox' /><label for='room_modal__body__checkbox'>تثبيت الغرفة</label></div><button class='btn btn-success'><span class='fa fa-plus'></span>إنشاء الغرفة&nbsp;</button></div></form></div></div></div></div>"),e.registerEvents(t)}}],(n=null)&&gt(t.prototype,n),r&&gt(t,r),e}();function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.showCreateRoomDialog(t),e.setRooms(t)}},{key:"showCreateRoomDialog",value:function(e){$("#chat__body__rooms_pane__create_room").on("click",(function(t){_t.render(e)}))}},{key:"setCurrentRoomActive",value:function(e){$("#chat__body__rooms_pane .chat_pane__room_item").removeClass("active"),e.getState().mUser.room&&$("#chat__body__rooms_pane .chat_pane__room_item[data-id='"+e.getState().mUser.room.id+"']").addClass("active")}},{key:"setRooms",value:function(e){if(qt.updateRoomsCount(e),"rooms"==e.getState().currentPane){$(".chat_pane__room_item").unbind("click");var t=$("#chat__body__rooms_pane .chat_pane__container");t.html(""),e.getState().rooms.forEach((function(n){t.append(ht.render(n,!1,e))})),ht.registerEvents(e)}}},{key:"scrollToTop",value:function(){document.querySelector("#chat__body__rooms_pane .chat_pane__container").scrollTo({top:0})}},{key:"render",value:function(e){var t="<div id='chat__body__rooms_pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return t+=f.render("غرف الدردشة"),t+="<div><button id='chat__body__rooms_pane__create_room' data-toggle='modal' data-target='#createRomModal' class='border btn btn-success fa fa-plus'>غرفه جديدة</button></div>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(n=null)&&vt(t.prototype,n),r&&vt(t,r),e}();function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.toggle(t)}},{key:"toggle",value:function(t){$("#radio-container img").unbind("click").on("click",(function(n){$("#radio-stream").length?(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active")):(e.playRadio(t),$("#radio-container .radio-container__off").addClass("active"),$("#radio-container .radio-container__on").removeClass("active"))}))}},{key:"update",value:function(t){var n=$("#radio-container");n.find("#radio-stream").attr("src")!=t.getState().settings.radio_stream_url&&n.find("#radio-stream").attr("src",t.getState().settings.radio_stream_url);var r=t.getState().settings.radio_stream_off_img?"/uploads/"+t.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg";n.find(".radio-container__off").attr("src",r);var i=t.getState().settings.radio_stream_on_img?"/uploads/"+t.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg";n.find(".radio-container__on").attr("src",i),t.getState().settings.is_radio_stream_enabled?$("#radio-container").show():(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active"),$("#radio-container").hide()),e.toggle(t)}},{key:"playRadio",value:function(e){$("#radio-container").append('<audio id="radio-stream" src="'+e.getState().settings.radio_stream_url+'" width="0" height="0" />'),$("#radio-stream")[0].play()}},{key:"stopRadio",value:function(){$("#radio-stream")[0]&&$("#radio-stream")[0].remove()}},{key:"render",value:function(e){var t=e.getState().settings.is_radio_stream_enabled?"block":"none",n=e.getState().settings.radio_stream_on_img?"/uploads/"+e.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg",r="<div id='radio-container' style='display: "+t+"'>";return r+="<img class='radio-container__off' src='"+(e.getState().settings.radio_stream_off_img?"/uploads/"+e.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg")+"' alt=''/>",r+="<img class='radio-container__on active' src='"+n+"' alt=''/>",r+="</div>"}}],(n=null)&&bt(t.prototype,n),r&&bt(t,r),e}(),St=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_COMMENTS_FACE_PICKER",isWallCommentsFacePickerOpen:e}};function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Et=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.sendComment(t),e.openFacePicker(t),e.onRemove(t),e.onLike(t)}},{key:"openFacePicker",value:function(e){$("#wall_comments__attach__face").unbind("click").on("click",(function(t){e.dispatch(St(!0)),y.onSelect()}))}},{key:"onRemove",value:function(e){$("#wall_comments .wall_comments__comment__remove").unbind("click").on("click",(function(t){var n=t.target.dataset.id,r=t.target.dataset.postId;e.getState().socket.emit("req",Kt({type:"WALL_POST_COMMENT_REMOVE",data:{id:n,postId:r}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e)}))}))}},{key:"onLike",value:function(t){$("#wall_comments .wall_comments__comment__like").unbind("click").on("click",(function(n){var r=n.target.dataset.id;t.getState().socket.emit("req",Kt({type:"WALL_POST_COMMENT_LIKE",data:{id:r}}),(function(t){if("string"==typeof(t=Qt(t)))return alert(t);"object"==kt(t)&&!1===t.error&&e.incCommentLikes(r)}))}))}},{key:"incCommentLikes",value:function(e){var t=$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text();t=parseInt(t)+1,$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text(t)}},{key:"scrollToBottom",value:function(){var e=document.getElementById("wall_comments__scroll_area");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"setComments",value:function(t,n){var r=$("#wall_comments .wall_comments__body");r.html(""),t.forEach((function(t){r.append(e.renderPostComment(t,n))})),setTimeout((function(){e.scrollToBottom(),e.registerEvents(n)}),500)}},{key:"renderPostComment",value:function(e,t){var n=t.getState().posts.filter((function(t){return t.id==e.postId}))[0],r="<div class='wall_comments__comment' data-id='"+e.id+"' >";return r+="<p class='wall_comments__comment__avatar'>",r+="<img class='radius border border-color' width='30' height='30' src='"+e.user.avatar+"' />",r+="</p>",r+="<div>",r+="<h5 class='wall_comments__comment__title'>",r+=S.render(e.user),r+="</h5>",r+="<h5 class='wall_comments__comment__content'>",r+=_.render(e.comment,t),r+="</h5>",r+="</div>",r+="<button data-id='"+e.id+"' class='wall_comments__comment__like fl btn btn-danger fa fa-heart'>"+e.likes+"</button>",n.user.reg_id!=t.getState().mUser.reg_id&&e.user.reg_id!=t.getState().mUser.reg_id||(r+="<button data-id='"+e.id+"' data-post-id='"+e.postId+"' class='wall_comments__comment__remove fl btn btn-danger fa fa-remove'></button>"),r+="<span class='wall_comments__comment__time fr time' data-time='"+e.time+"'>"+Zt(e.time)+"</span>",r+="<div class='clear'></div>",r+="</div>"}},{key:"sendComment",value:function(e){$("#wall_comments form").unbind("submit").on("submit",(function(t){t.preventDefault();var n=$(this).data("post-id"),r=t.target.comment,i=r.value.trim();i&&"disabled"!=$("#wall_comments__form__submit").attr("disabled")&&($("#wall_comments__form__submit").attr("disabled","disabled"),e.getState().socket.emit("req",Kt({type:"ADD_WALL_POST_COMMENT",data:{post_id:n,text:i}}),(function(e){if($("#wall_comments__form__submit").removeAttr("disabled"),r&&(r.value=""),"string"==typeof(e=Qt(e)))return alert(e)})))}))}},{key:"getPostComments",value:function(t,n){n.getState().socket.emit("req",Kt({type:"WALL_GET_POST_COMMENTS",data:{post_id:t.id}}),(function(t){e.setComments(Qt(t),n)}))}},{key:"add",value:function(t,n){var r=$("#wall_comments");r&&r.hasClass("show")&&n.getState().wallCommentsPost&&n.getState().wallCommentsPost.id==t.postId&&($("#wall_comments .wall_comments__body").append(e.renderPostComment(t,n)),e.scrollToBottom(),e.registerEvents(n))}},{key:"remove",value:function(e){$("#wall_comments").hasClass("show")&&$("#wall_comments .wall_comments__comment[data-id='"+e+"']").remove()}},{key:"render",value:function(t,n){var r="<div class='modal fade' id='wall_comments' tabindex='-1' role='dialog' aria-hidden='true'>";r+="<div class='modal-dialog' role='document' style='max-width: 345px'>",r+="<div class='modal-content'>",r+="<div class='wall_comments__header modal-header label label-primary'>",r+="<div class='modal-title'>",r+="<img class='wall_comments__header__avatar' width='25' height='25' src='"+t.user.avatar+"' alt=''/>",r+="<p class='wall_comments__header__name ellipsis'>",r+=t.user.icon?"<img src='"+t.user.icon+"' class='username__icon fl' style='max-height: 16px' />":"",r+="<span style='vertical-align: middle; font-size: 0.7rem; display: inline-block; margin-left: 2px'>"+t.user.name+"</span>",r+="</p>",r+="<button data-dismiss='modal' class='btn btn-danger wall_comments__header__close'>&times;</button>",r+="</div><div class='clear'></div>",r+="</div>",r+="<div class='wall_comments__post_body_area'>",r+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",r+=Rt.renderPostBody(t,n),r+="</h5>",r+="</div>",r+="<div class='wall_comments__scroll_area' id='wall_comments__scroll_area'>",r+="<div class='wall_comments__body modal-body'></div>",r+="</div>",r+="<form class='wall_comments__form' data-post-id='"+t.id+"'>",r+="<img class='wall_comments__form__face' src='/images/smile.gif' alt='smile' id='wall_comments__attach__face' width='22' height='22'/>",r+="<input type='text' id='wall_comments__form__input' class='border-color wall_comments__form__input' name='comment' placeholder='أكتب تعليقك هنا' autoComplete='off' dir='rtl'/>",r+="<button id='wall_comments__form__submit' class='border-color fa fa-send btn btn-primary wall_comments__form__send'>إرسال</button>",r+=y.render("wall-comments","#wall_comments__form__input",n),r+="</form>",r+="</div>",r+="</div>",r+="</div>",$("#wall_comments_container").html(r),e.getPostComments(t,n),e.registerEvents(n)}}],(n=null)&&Ct(t.prototype,n),r&&Ct(t,r),e}(),Tt=n(53),Pt=n.n(Tt);function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.youtubeVideoClicked(t),e.getProfile(t),e.remove(t),e.comment(t),e.like(t),Pt.a.init({wrapAround:!0,disableScrolling:!0})}},{key:"like",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__heart").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).parent().data("id");e.getState().socket.emit("req",Kt({type:"WALL_LIKE_POST",data:{id:n}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e)}))}))}},{key:"remove",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__remove").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).parent().data("id");e.getState().socket.emit("req",Kt({type:"WALL_REMOVE_POST",data:{id:n}}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e)}))}))}},{key:"comment",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__comments").unbind("click").on("click",(function(t){var n=$(this).parent().data("id"),r=e.getState().posts.filter((function(e){return e.id==n}))[0];e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_WALL_COMMENTS_POST",wallCommentsPost:e}}(r)),Et.render(r,e)}))}},{key:"getProfile",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__avatar img").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".wall_post").data("user");ct.show(n,e)}))}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"youtubeVideoClicked",value:function(){$(".wall_post .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("post-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",r=document.getElementById("yt-btn-"+t);r&&(r.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),r.remove())}catch(e){}}))}},{key:"renderPostBody",value:function(e,t){switch(e.type){case"text":return"<span class='wall_post__body--text'>"+_.render(e.body,t)+"</span>";case"photo":return"<div class='hes-gallery' data-wrap='true' data-img-count='false' ><img class='wall_post__body--photo rounded' src='/uploads/wall/photos/"+e.body+"' /></div>";case"sound":return"<audio class='wall_post__body--sound' controls src='/uploads/wall/sounds/"+e.body+"' ></audio>";case"video":return"<video class='wall_post__body--video' controls src='/uploads/wall/videos/"+e.body+"'></video>";case"youtube":var n="<button class='yt-btn' id='yt-btn-"+e.id+"' data-post-id='"+e.id+"' data-yid='"+e.body+"'>";return n+="<img src='images/youtube.png'/>",n+="<img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+e.body+"/0.jpg' />",n+="</button>"}}},{key:"render",value:function(t,n){var r=t.active?"active":"",i="<div data-user='"+t.user.id+"' id='wall-post-"+t.id+"' class='wall_post "+r+"' >";return i+="<p class='wall_post__avatar'>",i+="<img class='radius' width='36' height='36' alt='' src='"+t.user.avatar+"' />",i+="</p>",i+="<div>",i+="<h5 class='wall_post__name'>",i+=S.render(t.user),i+="</h5>",i+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",i+=e.renderPostBody(t,n),i+="</h5>",i+="<div class='wall_post__footer' data-id='"+t.id+"'>",i+="<button data-toggle='modal' data-target='#wall_comments' class='wall_post__body__comments fl btn btn-primary fa fa-comments'>"+t.comments+"</button>",i+="<button class='wall_post__body__heart fl btn btn-danger fa fa-heart'>"+t.likes+"</button>",i+="<button class='wall_post__body__remove fr btn btn-danger fa fa-times'></button>",i+="</div>",i+="<span class='wall_post__time fr time' data-time='"+t.time+"'>"+Zt(t.time)+"</span>",i+="</div>",i+="<div class='clear'></div>",i+="</div>"}}],(n=null)&&At(t.prototype,n),r&&At(t,r),e}(),Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_FACE_PICKER",isWallFacePickerOpen:e}};function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.publish(t),e.fetchPosts(t),e.attachFile(t),e.openFacePicker(t),e.triggerAttachFileInput(t)}},{key:"publish",value:function(t){$("#chat__body__wall_pane .chat__body__wall_pane__form").on("submit",(function(n){n.preventDefault();var r=n.target.message,i=r.value.trim();if(i){var o={type:"text",body:i};e.send(o,r,t)}}))}},{key:"send",value:function(e,t,n){t&&(t.value=""),n.getState().socket.emit("req",Kt({type:"WALL_ADD_POST",data:e}),(function(e){if("string"==typeof(e=Qt(e)))return alert(e)}))}},{key:"fetchPosts",value:function(t){t.dispatch({type:"RESET_NEW_POSTS_COUNT"}),qt.updateWallCout(t),t.getState().isPostsFetched||t.getState().socket.emit("req",Kt({type:"WALL_GET_POSTS",data:{}}),(function(n){t.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_POSTS",posts:e}}(Qt(n))),t.dispatch({type:"IS_POSTS_FETCHED",isPostsFetched:!0}),e.renderPosts(t)}))}},{key:"renderPosts",value:function(e){var t=$("#chat__body__wall_pane .chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(n){t.append(Rt.render(n,e))})),Rt.registerEvents(e)}},{key:"openFacePicker",value:function(e){$("#chat__body__wall_pane__form__attach__face").on("click",(function(t){e.dispatch(Ot(!0))}))}},{key:"updatePost",value:function(e,t){var n=t.getState().posts.filter((function(t){return t.id==e}))[0];if(n){var r=window.wallPane.find("#wall-post-"+n.id);r.find(".wall_post__body__heart").text(n.likes),r.find(".wall_post__body__comments").text(n.comments)}}},{key:"removePost",value:function(e){$("#wall-post-"+e).remove()}},{key:"addPost",value:function(e,t){e&&(window.wallPane.find(".chat_pane__container__posts").prepend(Rt.render(e,t)),Rt.registerEvents(t),window.wallPane.find(".wall_post").length>t.getState().settings.wall_msg_count&&window.wallPane.find(".wall_post:nth-child("+(t.getState().settings.wall_msg_count+1)+")").remove())}},{key:"setPosts",value:function(e){if(qt.updateWallCout(e),"wall"==e.getState().currentPane&&!window.wallPane.find(".chat_pane__container__posts").length){$(".wall_post").unbind("click");var t=window.wallPane.find(".chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(n){t.append(Rt.render(n,e))})),Rt.registerEvents(e),document.querySelector("#chat__body__wall_pane .chat_pane__container").scrollTo({top:0}),window.wallPane.find("img").on("contextmenu",(function(){return!1}))}}},{key:"triggerAttachFileInput",value:function(){window.wallPane.find(".chat__body__wall_pane__form__attach").unbind("click").on("click",(function(e){var t=document.getElementById("chat__body__wall_pane__form__file");t&&t.click()}))}},{key:"attachFile",value:function(t){window.wallPane.find("#chat__body__wall_pane__form__file").unbind("change").on("change",(function(n){var r=n.target.files[0],i=new FormData;i.append("file",r),t.getState().socket.emit("req",Kt({type:"WALL_BEFORE_SEND_MEDIA",data:{}}),(function(n){if("string"==typeof(n=Qt(n)))return alert(n);if(!1===n.error){i.append("hash",n.hash),i.append("id",n.user_id);var o=null,a=r.type.split("/")[0];if("image"==a&&(o="/wall_upload_photo_post"),"audio"==a&&(o="/wall_upload_sound_post"),"video"==a&&(o="/wall_upload_video_post"),!o)return;window.wallPane.find(".chat__body__wall_pane__form__attach").hide(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").show();var s=$(".chat__body__wall_pane__form__loading_percent");N.a.post(o,i,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);s.text(t<10?"0"+t:t)}}).then((function(n){!1===n.data.error&&e.send({type:n.data.type,body:n.data.body},null,t),window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),s.text("00")})).catch((function(e){window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),s.text("00")}))}}))}))}},{key:"update",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"";window.wallPane.find(".chat_pane__container__banner").css("background",e.getState().settings.wall_banner_background_color),window.wallPane.find(".chat_pane__container__banner").css("color",e.getState().settings.wall_banner_font_color),window.wallPane.find(".chat_pane__container__banner p").text(t),e.getState().settings.show_wall_banner?window.wallPane.find(".chat_pane__container__banner").show():window.wallPane.find(".chat_pane__container__banner").hide()}},{key:"render",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"",n="<div id='chat__body__wall_pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return n+=f.render("الحائط للإبداع فقط",!0),n+="<div class='chat_pane__container border'>",n+=wt.render(e),n+="<div class='chat_pane__container__banner' style='background: "+e.getState().settings.wall_banner_background_color+"; color: "+e.getState().settings.wall_banner_font_color+"'>",n+="<p>"+t+"</p>",n+="</div>",n+="<div class='chat_pane__container__posts'></div>",n+="</div>",n+="<form class='chat__body__wall_pane__form'>",n+="<button type='button' class='border-color btn btn-primary fa fa-share-alt chat__body__wall_pane__form__attach'></button>",n+="<span><span class='chat__body__wall_pane__form__loading_percent'>00</span><img class='chat__body__wall_pane__form__loader' style='display: none' src='/images/loader.gif' width='24' height='24' alt='' /></span>",n+="<img class='chat__body__wall_pane__form__face' src='/images/smile.gif' alt='smile' id='chat__body__wall_pane__form__attach__face' width='22' height='22' />",n+="<input type='text' id='chat__body__wall_pane__form__input' class='border-color chat__body__wall_pane__form__input' name='message' placeholder='أكتب رسالتك هنا' autoComplete='off' dir='rtl'/>",n+="<button class='border-color fa fa-send btn btn-primary chat__body__wall_pane__form__send'>إرسال</button>",n+="<input id='chat__body__wall_pane__form__file' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",n+=y.render("wall","#chat__body__wall_pane__form__input",e),n+="</form>",n+="</div>"}}],(n=null)&&xt(t.prototype,n),r&&xt(t,r),e}();function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.openChat(t),e.remove(t)}},{key:"openChat",value:function(e){$("#chat__body__conversations_pane .conversations_item").unbind("click").on("click",(function(t){var n=e.getState().currentConversation;$(this).removeClass("unread");var r=$(this).data("id"),i=e.getState().conversations.filter((function(e){return e.id==r}))[0];i&&i.him&&(n&&n.id==i.id||(e.dispatch(E(i.him)),le.render(e)))}))}},{key:"remove",value:function(e){$("#chat__body__conversations_pane .conversations_item__remove").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".conversations_item").data("id"),r=e.getState().conversations.filter((function(e){return e.id==n}))[0];e.getState().currentConversation&&e.getState().currentConversation.id==r.id&&(e.dispatch(E(null)),$("#chat_box_container").html("")),e.dispatch(T(r.id)),$(this).closest(".conversations_item").remove(),qt.updateConversationsCount(e)}))}},{key:"renderLastMessage",value:function(e,t){var n=e.messages.length;if(n){var r=e.messages[n-1];if("text"==r.type)return _.render(r.body,t);if("photo"==r.type)return"<span class='fa fa-camera'></span>";if("sound"==r.type)return"<span class='fa fa-microphone'></span>";if("video"==r.type)return"<span class='fa fa-video-camera'></span>";if("youtube"==r.type)return"<span class='fa fa-youtube'></span>"}}},{key:"render",value:function(t,n){var r=t.seen?"":"unread",i="<div data-id='"+t.id+"' class='conversations_item "+r+" "+t.him.state+"' >";return i+="<div class='conversations_item__holder fl'>",i+="<p class='conversations_item__avatar'><img class='radius' width='30' height='30' src='"+t.him.avatar+"' /></p>",i+="<div>",i+="<h5 class='conversations_item__name'>",i+=S.render(t.him),i+="</h5>",i+="<h5 style='color: "+t.him.fontColor+"' class='conversations_item__last_message'>",i+=e.renderLastMessage(t,n),i+="</h5>",i+="</div>",i+="</div>",i+="<button class='conversations_item__remove btn btn-danger fa fa-times fr'>حذف</button>",i+="<div class='clear'></div>",i+="</div>"}}],(n=null)&&It(t.prototype,n),r&&It(t,r),e}();function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ut=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"renderConversations",value:function(e){var t=$("#chat__body__conversations_pane .chat_pane__container");t.html(""),e.getState().conversations.filter((function(t){return!e.getState().ignoredUsers.includes(t.him.id)})).forEach((function(n){t.append(Dt.render(n,e))})),Dt.registerEvents(e)}},{key:"render",value:function(t){var n="<div id='chat__body__conversations_pane' class='chat_pane' style='background: "+en(t.getState().settings,!0)+"'>";return n+=f.render("المحادثات الخاصة"),n+="<div class='chat_pane__container border'>"+e.renderConversations(t)+"</div>",n+="</div>"}}],(n=null)&&Bt(t.prototype,n),r&&Bt(t,r),e}();function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var jt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onClick(t),e.trustUser(t)}},{key:"onClick",value:function(e){$(".notification").unbind("click").on("click",(function(t){var n=$(this).closest(".notification").data("user-id");ct.show(n,e)}))}},{key:"trustUser",value:function(e){$(".notification__message__body__trust_user").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Kt({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Qt(t),$(n).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var r=$(n).data("user-id");e.dispatch(H(r)),$("button[data-user-id='"+r+"']").remove()}}))}))}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+ht.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='notification__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='notification__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"photo_like":return;default:return"<span>"+_.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,n){var r=t.user?t.user.id:"",i=Date.now(),o="<div data-id='"+t.id+"' data-user-id='"+r+"' class='notification'>";return o+="<p class='notification__title label label-primary'>"+t.title+"</p>",t.user&&(o+="<div class='notification__sender'>",o+="<img src='"+t.user.avatar+"' width='24' height='24' class='notification__sender__avatar' />",o+="<p class='notification__sender__name'>"+S.render(t.user)+"</p>",o+="</div>"),o+="<div class='notification__message'>",o+=e.renderMessage(t,n),o+="</div>",o+="<span class='notification__time fr time' data-time='"+i+"'>"+Zt(i)+"</span>",o+="</div>"}}],(n=null)&&Lt(t.prototype,n),r&&Lt(t,r),e}();function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.close(t)}},{key:"close",value:function(e){$(".chat__body__notifications-pane__back button").unbind("click").on("click",(function(t){e.dispatch(r("settings")),qt.togglePane(e)}))}},{key:"setNotifications",value:function(e){var t=$("#chat__body__notifications-pane .chat_pane__container");t.html(""),e.getState().popups.forEach((function(n){t.prepend(jt.render(n,e))})),jt.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__notifications-pane' class='chat_pane' style='background: "+en(e.getState().settings,!0)+"'>";return t+=f.render("الإشعارات"),t+="<p class='chat__body__notifications-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(n=null)&&Ft(t.prototype,n),i&&Ft(t,i),e}();function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.updateUsersCout(t),window.chatFooter.find("#chat__footer__menu__users_item").on("click",(function(n){"users"!=t.getState().currentPane&&(t.dispatch(r("users")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__conversations_item").on("click",(function(n){"conversations"!=t.getState().currentPane&&(t.dispatch(r("conversations")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__rooms_item").on("click",(function(n){"rooms"!=t.getState().currentPane&&(t.dispatch(r("rooms")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__wall_item").on("click",(function(n){"wall"!=t.getState().currentPane&&(t.dispatch(r("wall")),t.dispatch({type:"RESET_NEW_POSTS_COUNT"}),e.updateWallCout(t),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__settings_item").on("click",(function(n){"settings"!=t.getState().currentPane&&(t.dispatch(r("settings")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__tv_item").on("click",(function(e){d.open(t)}))}},{key:"togglePane",value:function(e,t){if($(".chat_pane").hide(),re.closeModals(),!t)return"users"==e.getState().currentPane?(window.usersPane.show(),Promise.resolve().then((function(){return Le.setUsers(e)}))):"conversations"==e.getState().currentPane?(window.conversationsPane.show(),Ut.renderConversations(e)):"rooms"==e.getState().currentPane?(window.roomsPane.show(),yt.setRooms(e)):"wall"==e.getState().currentPane?(window.wallPane.show(),Mt.setPosts(e)):"settings"==e.getState().currentPane?window.settingsPane.show():"ignored_users"==e.getState().currentPane?(window.ignoredUsersPane.show(),Fe.setUsers(e)):"notifications"==e.getState().currentPane?(window.notificationsPane.show(),Nt.setNotifications(e)):void 0}},{key:"updateUsersCout",value:function(e){window.chatFooter.find("#chat__footer__menu__users_item .count").text(e.getState().users.length-e.getState().ignoredUsers.length)}},{key:"updateConversationsCount",value:function(e){var t=e.getState().conversations.filter((function(e){return 0==e.seen})).length;t>0?(window.chatFooter.find("#chat__footer__menu__conversations_item").addClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(t)):(window.chatFooter.find("#chat__footer__menu__conversations_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(0))}},{key:"updateRoomsCount",value:function(e){$("#chat__footer__menu__rooms_item .count").text(e.getState().rooms.length)}},{key:"updateWallCout",value:function(e){var t=e.getState().newPostsCount;t?window.chatFooter.find("#chat__footer__menu__wall_item").addClass("unread"):window.chatFooter.find("#chat__footer__menu__wall_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__wall_item .count").text(t)}},{key:"toggleTV",value:function(e){e.getState().settings.tv_box_enabled?window.chatFooter.find("#chat__footer__menu__tv_item").show():(window.chatFooter.find("#chat__footer__menu__tv_item").hide(),d.close(e))}},{key:"render",value:function(){return"<div id='chat__footer'><ul id='chat__footer__menu'><li id='chat__footer__menu__users_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-user'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__conversations_item' class='border border-color btn-primary chat__footer__menu__item' ><span class='fa fa-comment'></span><span class='badge count'>0</span></li><li id='chat__footer__menu__rooms_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-users'></span><span><span class='badge count'>0</span>الغرف</span></li><li id='chat__footer__menu__wall_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-commenting-o'></span><span class='badge count'>0</span><span>الحائط</span></li><li id='chat__footer__menu__settings_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-gear'></span><span>الإعدادات</span></li><li id='chat__footer__menu__tv_item' class='border border-color btn-primary chat__footer__menu__item'><span class='fa fa-tv'></span></li></ul></div>"}}],(n=null)&&$t(t.prototype,n),i&&$t(t,i),e}();function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.hideAllPanes(t)}},{key:"hideAllPanes",value:function(e){window.publicMessagesContainer&&window.publicMessagesContainer.on("click",(function(t){e.dispatch(r(null)),qt.togglePane(e,!0)}))}},{key:"scrollToBottom",value:function(){window.publicMessagesContainer&&window.publicMessagesContainer.animate({scrollTop:window.publicMessagesContainer.prop("scrollHeight")},100)}},{key:"render",value:function(){return"<div id='chat__body__messages_container'></div>"}}],(n=null)&&Gt(t.prototype,n),i&&Gt(t,i),e}();function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var zt=n(58),Ht=n(82);function Jt(){return"undefined"!=typeof Storage}function Xt(e,t){Jt()?localStorage.setItem(e,t):function(e,t,n){var r=new Date;r.setTime(r.getTime()+287712e5);var i="expires="+r.toUTCString();document.cookie=e+"="+(o=t,encodeURIComponent(o).split("'").join("%27")+"; ")+i;var o}(e,t)}function Yt(e){if(Jt()){var t=localStorage.getItem(e);return"null"!=t&&null!=t||(t=""),t}return function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1);if(-1!=i.indexOf(t))return o=i.substring(t.length,i.length),decodeURIComponent(o)}var o;return""}(e)}function Kt(e,t){if(!t)return e;try{return zt.AES.encrypt(JSON.stringify(e),Ht.aes_secret).toString()}catch(e){return null}}function Qt(e,t){if(!t)return e;try{var n=zt.AES.decrypt(e,Ht.aes_secret).toString(zt.enc.Utf8);return JSON.parse(n)}catch(e){return""}}function Zt(e){var t=Math.round(Math.abs(Date.now()-e)/1e3);return t<59?"الآن":t/60<60?parseInt(t/60)+"د":t/3600<24?parseInt(t/3600)+"س":t/86400<30?parseInt(t/86400)+"ي":t/2592e3<12?parseInt(t/2592e3)+"ش":parseInt(t/31104e3)+"ع"}function en(e,t){return t?e&&e.show_chat_background_on_windows?e.chat_background?e.window_color+" url(/uploads/"+e.chat_background+")":e.window_color+" url(/images/main_background.png)":e.window_color:e&&e.show_chat_background?e.chat_background?e.background_color+" url(/uploads/"+e.chat_background+")":e.background_color+" url(/images/main_background.png)":e.background_color}function tn(e,t){if(settings){for(var n=document.getElementsByTagName("style"),r=0;r<n.length;r++);var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style"),a=".btn-primary { background-color: "+settings.btn_color+"; }.btn-primary:hover, .btn-primary:disabled, .btn-primary:active { background-color: "+settings.btn_color+"AA !important; }.border-color { border-color: "+settings.border_color+" !important; }.react-tabs__tab { color: "+settings.btn_color+" !important; }.color-primary { color: "+settings.btn_color+" !important; }.users-count-label__right__arrow-left { border-right-color: "+settings.btn_color+" !important; }.users-count-label__left__arrow-right { border-left-color: "+settings.btn_color+" !important; }.users-count-label { background-color: "+function(e,t){var n=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100),r=parseInt(r*(100+t)/100),i=parseInt(i*(100+t)/100),r=r<255?r:255,i=i<255?i:255;var o=1==(n=n<255?n:255).toString(16).length?"0"+n.toString(16):n.toString(16),a=1==r.toString(16).length?"0"+r.toString(16):r.toString(16),s=1==i.toString(16).length?"0"+i.toString(16):i.toString(16);return"#"+o+a+s}(settings.btn_color,15)+" !important; }.label-primary { background-color: "+settings.btn_color+"; }";o.type="text/css",o.styleSheet?o.styleSheet.cssText=a:o.appendChild(document.createTextNode(a)),i.appendChild(o)}}function nn(){document.body.style.zoom="0.975";var e=rn()/document.body.style.zoom,t=document.getElementById("mic-speakers"),n=t?t.clientHeight:0,r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),o=document.querySelector("#login .login_wrapper"),a="#chat__body { height: calc("+e+"px - 38px); }#chat, #app { height: "+e+"px; }#online_users { height: "+(e-((o?o.clientHeight:0)-3))+"px; }#user_profile { max-height: "+e+"px; }#chat__body__messages_container { height: calc("+e+"px - 32px - 40px - "+n+"px); }.user_profile__scroll_area { max-height: "+91*e/100+"px; }.reveal_names_body { height: "+65*e/100+"px; }";i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),r.appendChild(i),Vt.scrollToBottom();var s=document.getElementById("chat_box__body");s&&(s.scrollTop=s.scrollHeight-s.clientHeight),window.addEventListener("resize",nn)}function rn(){return document.documentElement.clientHeight}function on(){return location.host.replace("www.","")}function an(e){if(!e)return 0;var t=new Date,n=new Date(e),r=Math.abs(n-t),i=Math.ceil(r/864e5);return i>0&&(i-=1),i}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,r;return t=e,r=[{key:"getIcon",value:function(e){return e.getState().settings.default_avatar?"/uploads/avatars/"+e.getState().settings.default_avatar:"/images/none.png"}},{key:"render",value:function(t){var n=t.getState().settings.chat_name?t.getState().settings.chat_name:"",r="<h1 id='login-header' class='border-color label label-primary'>";return r+="<a class='label label-primary login-header__label' href='/'>",r+="<img src='"+e.getIcon(t)+"' width='28' height='30' />",r+="<span class='login-header__title'>"+n+"</span>",r+="<button class='btn fr btn-success fa fa-refresh login-header__refresh'></button>",r+="</a>",r+="</h1>"}}],(n=null)&&sn(t.prototype,n),r&&sn(t,r),e}();function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ln=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getSrc",value:function(e){return e.getState().settings.banner_img?"/uploads/"+e.getState().settings.banner_img:"/images/banner.png"}},{key:"render",value:function(t){var n="<div id='login-banner' class='rainbow'>";return n+="<img src='"+e.getSrc(t)+"' alt='banner' class='login-banner__img' />",n+="</div>"}}],(n=null)&&un(t.prototype,n),r&&un(t,r),e}();function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(){return"<div id='login-btn-holder'><a href='https://www.facebook.com/' class='login-btn-holder__btn fa fa-facebook btn btn-primary'> فيسبوك </a><a href='/RULS.html' class='login-btn-holder__btn fa fa-music btn btn-default'> القوانين </a><a href='/RED.html' class='login-btn-holder__btn fa fa-star-half-o btn btn-primary'> الإشتراكات </a><a href='/RIW.html' class='login-btn-holder__btn fa fa-user btn btn-default'> الفعاليات </a></div>"}}],(n=null)&&dn(t.prototype,n),r&&dn(t,r),e}(),fn=function(e,t,n){return{type:"HANDLE_USER_CHANGE_ROOM",userId:e,oldRoomId:t,newRoomId:n}},hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_GIFTS",gifts:e}},mn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_FACES",faces:e}},gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"heart";return{type:"SET_FLOATING_PARTICLES",particleType:e}};function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"render",value:function(e){var t="<div id='chat__body__live-pane' class='chat_pane' style='background: #FFFFFF'>";return t+=f.render("البث المباشر"),t+="<div class='chat_pane__container border'>",t+=wt.render(e),t+="<div id='chat__body__live-pane__tv' class='fl'>",t+="<iframe src='"+d.parseURL(e.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",t+="</div>",t+="</div>",t+="</div>"}}],(n=null)&&_n(t.prototype,n),r&&_n(t,r),e}();function yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t="<div id='chat__body' style='background: "+en(e.getState().settings)+"'>";return t+=re.render(e),t+=Vt.render(),t+=pt.render(e),t+=Le.render(e),t+=Ut.render(e),t+=yt.render(e),t+=Mt.render(e),t+=W.render(e),t+=Fe.render(e),t+=vn.render(e),t+=Nt.render(e),t+="<audio style='display: none;' id='private-bip'>",t+="<source src='private-bip.mp3' type='audio/mpeg'>",t+="<source src='private-bip.ogg' type='audio/ogg'>",t+="</audio>",t+="</div>"}}],(n=null)&&yn(t.prototype,n),r&&yn(t,r),e}();function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Sn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onParticleLoaded(t)}},{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"insertParticles",value:function(e){if($("#floating_particles"))for(var t=0;t<2;t++)"heart"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_heart3.png" width="50" height="50" alt="" />')),"gift"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift3.png" width="50" height="50" alt="" />')),"ad"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_ad3.png" width="50" height="50" alt="" />')),"rose"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_rose3.png" width="50" height="50" alt="" />'))}},{key:"onParticleLoaded",value:function(t){$(".floating_particles__item").unbind("load").on("load",(function(n){e.insertParticles(t),$(".floating_particles__item").toArray().forEach((function(n){var r=$("body").width()-100,i=e.getRandomInt(50,150);try{$(n).animate({lef:e.getRandomInt(0,r),right:e.getRandomInt(0,r),bottom:e.getRandomInt(30,500),width:i,height:i},e.getRandomInt(1e3,3e3),(function(){$(n).animate({top:"-100%",opacity:0},e.getRandomInt(5e3,15e3),(function(){try{$(n).unbind("load").remove()}catch(e){}t.getState().particleType&&t.dispatch(gn(null))}))}))}catch(e){}}))}))}},{key:"toggle",value:function(t){t.getState().settings.disable_floating_particles||($("#floating_particles .floating_particles__item").remove(),$("#floating_particles").append("<img class='floating_particles__item' src='/images/floating_"+t.getState().particleType+"1.png' width='50' height='50' alt='' />"),e.onParticleLoaded(t))}},{key:"render",value:function(e){var t="<div id='floating_particles'>";return e.getState().settings.disable_floating_particles||(t+="<img class='floating_particles__item' src='/images/floating_rose1.png' width='50' height='50' alt='' />"),t+="</div>"}}],(n=null)&&wn(t.prototype,n),r&&wn(t,r),e}();function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"append",value:function(e){if(e.royalLogin){var t=Math.floor(4*Math.random())+1,n="<div class='royal_login_item' id='royal_login_item--"+e.reg_id+"' style='background-image: url(/images/royal_login_bg"+t+".png)'>";n+="<img class='royal_login_item__img' src='"+e.avatar+"'/>",n+="<p  class='royal_login_item__name'>"+S.render(e)+"</p>",n+="</div>",$("#royal_login_container").append(n),$("#royal_login_item--"+e.reg_id).animate({left:0},500,"linear",(function(){setTimeout((function(){$("#royal_login_item--"+e.reg_id).animate({left:-300},500,"linear",(function(){$("#royal_login_item--"+e.reg_id).remove()}))}),3e3)}))}}}],(n=null)&&kn(t.prototype,n),r&&kn(t,r),e}();function En(e,t){switch(this.store=t,e.type){case"NEW_USER":return this.newUser(e.data.user);case"USER_OUT":return this.userOut(e.data.user);default:return null}}En.prototype.newUser=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_USER",user:e}}(e)),this.store.dispatch(fn(e.id,null,e.room.id)),e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id&&!e.isMuted&&lt.insert({icon:e.avatar,title:e.name,user:e,content:"هذا المستخدم قد دخل ",room:e.room,type:"JOIN_LEAVE"},this.store),qt.updateUsersCout(this.store),yt.setRooms(this.store),Cn.append(e)},En.prototype.userOut=function(e){if(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_USER",user:e}}(e)),this.store.dispatch({type:"REMOVE_CONVERSATION_BY_USER",him_id:e.id}),qt.updateUsersCout(this.store),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&(this.store.dispatch(I(null)),$("#user_profile").modal("hide")),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&(this.store.dispatch(E(null)),$("#chat_box_container").html("")),this.store.dispatch(T(e.id)),qt.updateConversationsCount(this.store),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&this.store.dispatch(E(null)),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&this.store.dispatch(I(null)),e.room&&this.store.dispatch(fn(e.id,e.room.id,null)),e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id){var t=null;!(t=e.isExcpeled?"(تم طرده من الدردشة)":e.isBanned?"(تم حظره من دخول الدردشة)":"(هذا المستخدم غادر الدردشة)")||e.isMuted||this.store.getState().ignoredUsers.includes(e.id)||lt.insert({icon:e.avatar,title:e.name,user:e,content:t,type:"JOIN_LEAVE"},this.store);var n=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id==e.id}))[0];n&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.id})),re.removeUserFromMic(this.store,e,n.micId,!1,!0))}yt.setRooms(this.store),Le.setUsers(this.store)};var Tn=En;function Pn(e,t){switch(this.store=t,e.type){case"USER_JOINDED_ROOM":return this.userJoinedRoom(e.data);case"USER_EXPELED_FROM_ROOM":return this.userExcpeledFromRoom(e.data);case"USER_LEAVED_ROOM":return this.userLeavedRoom(e.data);case"PROFILE_ACTION_CHANGE_ROOM":return this.changeRoom(e.data);case"NEW_ROOM_CREATED":return this.addRoom(e.data);case"ROOMS_UPDATED":return this.updateRooms(e.data);case"ADMIN_ROOM_FLAG_UPDATED":return this.updateRoomFlag(e.data);case"ADMIN_ROOM_DELETED":return this.deleteRoom(e.data);default:return null}}Pn.prototype.userJoinedRoom=function(e){e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(x(e.user)),this.store.dispatch(gn("rose")),Sn.toggle(this.store));var t=e.oldRoom?e.oldRoom.id:null,n=e.newRoom?e.newRoom.id:null,r=null,i=null,o=null;e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id&&(o=e.user.room,r=e.user.id==this.store.getState().mUser.id?"هذا المستخدم إنتقل إلى ":"هذا المستخدم قد دخل ",i="JOIN_LEAVE"),this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(n?(o=e.newRoom,r="هذا المستخدم إنتقل إلى "):r="هذا المستخدم غادر الغرفة ",i="JOIN_LEAVE"),r&&i&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&lt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,content:r,room:o,type:i},this.store),this.store.dispatch(B(e.user)),e.user.isMuted||(this.store.dispatch(fn(e.user.id,t,n)),e.user.id!=this.store.getState().mUser.id&&yt.setRooms(this.store)),e.newRoom&&e.newRoom.welcome&&e.user.id==this.store.getState().mUser.id&&lt.insert({icon:e.newRoom.flag,content:e.newRoom.welcome,type:"ROOM_GREETING"},this.store),re.leaveRoom(this.store,e.user)},Pn.prototype.userExcpeledFromRoom=function(e){var t=e.oldRoom?e.oldRoom.id:null,n=null,r=null;this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(t&&(n="(هذا المستخدم تم طرده من الغرفة)"),r="JOIN_LEAVE"),n&&r&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&lt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:n,type:r},this.store),t&&e.user.id&&!e.user.isMuted&&this.store.dispatch(fn(e.user.id,t,null))},Pn.prototype.userLeavedRoom=function(e){if(this.store.getState().mUser.room){var t=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id==e.user.id}))[0];t&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.user.id})),re.removeUserFromMic(this.store,e.user,t.micId,!1,!0))}e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(x(e.user)),re.resetAllMics());var n=e.oldRoom?e.oldRoom.id:null,r=null,i=null;this.store.getState().mUser.room&&n==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(n&&(r="(هذا المستخدم غادر الغرفة)"),i="JOIN_LEAVE"),r&&i&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&lt.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:r,type:i},this.store),this.store.dispatch(B(e.user)),n&&e.user.id&&!e.user.isMuted&&this.store.dispatch(fn(e.user.id,n,null))},Pn.prototype.changeRoom=function(e){if(!1===e.error){var t={id:Date.now(),user:e.user,type:"change_room",room:e.room,message:"تم نقلك إلى ",title:"تغيير الغرفة"};this.store.dispatch(z(t)),X.render(t,this.store),pt.toggleInput(this.store)}},Pn.prototype.addRoom=function(e){e&&e.room&&(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_ROOM",room:{id:e.id,name:e.name,password:e.password,welcome:e.welcome,description:e.description,capacity:e.capacity,flag:e.flag,users:e.users}}}(e.room)),yt.setRooms(this.store))},Pn.prototype.updateRooms=function(e){var t=this;e&&Array.isArray(e.rooms)&&(e.rooms.forEach((function(e){var n=!1,r=t.store.getState().rooms.filter((function(t){return t.id==e.id}))[0];r&&(n=r.is_voice_room),t.store.dispatch(function(e){return{type:"UPDATE_ROOM",room:e}}(e)),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==e.id&&(t.store.dispatch(M({room:e})),e.is_voice_room&&!n&&re.toggle(t.store,e.is_voice_room))})),yt.setRooms(this.store))},Pn.prototype.updateRoomFlag=function(e){var t,n;e&&e.room&&(this.store.dispatch((t=e.room.id,n=e.room.flag,{type:"UPDATE_ROOM_FLAG",id:t,flag:n})),yt.setRooms(this.store))},Pn.prototype.deleteRoom=function(e){var t=this;e&&Array.isArray(e.ids)&&(e.ids.forEach((function(e){t.store.dispatch(function(e){return{type:"DELETE_ROOM",id:e}}(e))})),yt.setRooms(this.store))};var An=Pn,Rn=n(4),On=n.n(Rn);function xn(e,t){switch(this.store=t,e.type){case"NEW_PUBLIC_MESSAGE":return this.onNewMessage(e.data);case"REMOVE_PUBLIC_MESSAGE":return this.removeMessage(e.data);case"NEW_AD":return this.onNewAd(e.data);case"SELF_MESSAGE":return this.onSelfMessage(e.data);default:return null}}xn.prototype.onNewMessage=function(e){if(e&&e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id){if(this.store.getState().ignoredUsers.includes(e.user.id))return;lt.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"PUBLIC_MESSAGE"},this.store)}},xn.prototype.removeMessage=function(e){e&&e.id&&lt.remove(e.id)},xn.prototype.onNewAd=function(e){if(e){if(this.store.getState().ignoredUsers.includes(e.user.id))return;lt.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"AD"},this.store)}},xn.prototype.onSelfMessage=function(e){e&&e.message&&(lt.clearSelfMessages(),lt.insert({id:On()(),user:null,icon:null,title:e.message.title,content:e.message.msg,type:"SELF_MESSAGE"},this.store))};var Mn=xn;function In(e,t){switch(this.store=t,e.type){case"NEW_PRIVATE_MESSAGE":return this.onNewMessage(e.data);default:return null}}In.prototype.onNewMessage=function(e){if(e.from&&e.from.id!=this.store.getState().mUser.id&&!this.store.getState().ignoredUsers.includes(e.from.id)){var t=e.from.id,n=this.store.getState().mUser,r=e.from,i=e.message,o=!(!this.store.getState().currentConversation||this.store.getState().currentConversation.id!=t);this.store.dispatch(P(t,n,r,o,i)),o?le.insert(i,r,this.store):le.playNotification(this.store),qt.updateConversationsCount(this.store),"conversations"==this.store.getState().currentPane&&Ut.renderConversations(this.store)}};var Dn=In;function Bn(e,t){switch(this.store=t,e.type){case"PROFILE_ACTION_NOTIFY":return this.notify(e.data);case"PROFILE_ACTION_LIKE":return this.like(e.data);case"PROFILE_ACTION_GIFT":return this.gift(e.data);case"PROFILE_ACTION_REMOVE_GIFT":return this.removeGift(e.data);case"PROFILE_ACTION_CHANGE_DECORATION":return this.changeDecoration(e.data);case"PROFILE_ACTION_CONTROL_LIKES":return this.controlLikes(e.data);case"PROFILE_ACTION_ROOM_EXCPEL":return this.roomExcpel(e.data);case"PROFILE_ACTION_CHANGE_ROLE":return this.changeRole(e.data);case"PROFILE_LIKE_ALBUM_PHOTO":return this.photoLiked(e.data);default:return null}}Bn.prototype.notify=function(e){if(e.user&&e.message){var t={id:Date.now(),user:e.user,message:e.message,title:"تنبيه",type:"notify"};this.store.dispatch(z(t)),X.render(t,this.store)}},Bn.prototype.like=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"like",message:null,title:"إعجاب"};this.store.dispatch(z(t)),this.store.dispatch(gn("heart")),Sn.toggle(this.store),X.render(t,this.store)}},Bn.prototype.gift=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"gift",message:e.message,title:"هدية"};this.store.dispatch(z(t)),this.store.dispatch(gn("gift")),Sn.toggle(this.store),X.render(t,this.store)}},Bn.prototype.removeGift=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"remove_gift",message:e.message,title:"سحب الهدية"};this.store.dispatch(z(t)),X.render(t,this.store)}},Bn.prototype.changeDecoration=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"change_decoration",message:"تم تغيير زخرفة إسمك",title:"الزخرفة"};this.store.dispatch(z(t)),X.render(t,this.store),W.updateDecoration(this.store)}},Bn.prototype.controlLikes=function(e){if(e.user){var t={id:Date.now(),user:e.user,type:"control_likes",message:"تم منحك "+e.likes+" إعجباب",title:"إعجاب"};this.store.dispatch(z(t)),this.store.dispatch(gn("heart")),Sn.toggle(this.store),X.render(t,this.store)}},Bn.prototype.roomExcpel=function(e){if(e.user){var t={id:Date.now(),user:e.user,room:e.oldRoom,type:"room_excpel",message:"تم طردك من الغرفة",title:"طرد"};this.store.dispatch(z(t)),X.render(t,this.store)}},Bn.prototype.changeRole=function(e){var t={id:Date.now(),user:e.user,type:"change_role",message:"تمت ترقيتك إلى "+e.roleName,title:"ترقية"};this.store.dispatch(z(t)),X.render(t,this.store)},Bn.prototype.photoLiked=function(e){if(e&&e.user&&e.photo){var t={id:Date.now(),user:e.user,type:"photo_like",message:"قام بالإعجاب بصورتك",photo:e.photo,title:"إعجاب"};this.store.dispatch(z(t)),X.render(t,this.store)}};var Un=Bn;function Ln(e,t){switch(this.store=t,e.type){case"GREET_USER":return this.greetUser(e.data);case"USER_UPDATED":return this.userUpdated(e.data);case"USERS_UPDATED":return this.usersUpdated(e.data);case"LOGIN_BANNED":return this.loginBanned(e.data);default:return null}}Ln.prototype.greetUser=function(e){var t=this;re.joinRoom(this.store),e&&e.messages&&e.messages.forEach((function(e){lt.insert({icon:e.icon,title:e.title,content:e.content,titleColor:e.titleColor,contentColor:e.contentColor,backgroundColor:e.backgroundColor,type:"GREET_USER"},t.store)}))},Ln.prototype.userUpdated=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER_ATTRIBUTE",user:e}}(e)),this.store.dispatch(D(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PUBLIC_MESSAGE_USER",user:e}}(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PRIVATE_MESSAGE_USER",user:e}}(e)),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POSTS_USER",user:e}}(e)),this.store.dispatch({type:"UPDATE_CURRENT_CONVERSATION",user:e}),e.id==this.store.getState().mUser.id&&this.store.dispatch(M(e.updates)),Le.updateUser(e.id,this.store),lt.updateUser(e.id,this.store),le.updateUser(e.id,this.store),R.updateUser(e.id,this.store)},Ln.prototype.usersUpdated=function(e){var t=this;e&&Array.isArray(e.updates)&&e.updates.forEach((function(e){t.userUpdated(e)}))},Ln.prototype.loginBanned=function(e){var t={id:Date.now(),data:e,title:"دخول المحظورين",type:"login_banned"};this.store.dispatch(z(t)),X.render(t,this.store)};var jn=Ln;function Fn(e,t){switch(this.store=t,e.type){case"POST_ADDED":return this.postAdded(e.data);case"POST_UPDATED":return this.postUpdated(e.data);case"POST_LIKED":return this.postLiked(e.data);case"POST_REMOVED":return this.postRemoved(e.data);case"YOUR_POST_IS_REMOVED":return this.yourPostIsRemoved(e.data);case"POST_COMMENTED":return this.postCommented(e.data);case"POST_COMMENT_LIKED":return this.postCommentLiked(e.data);case"POST_COMMENT_ADDED":return this.postCommentAdded(e.data);case"POST_COMMENT_DELETED":return this.postCommentDeleted(e.data);default:return null}}Fn.prototype.postAdded=function(e){this.store.getState().ignoredUsers.includes(e.user.id)||(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{type:"ADD_POST",post:e,wallMsgCount:t}}(e,this.store.getState().settings.wall_msg_count)),"wall"!=this.store.getState().currentPane&&(this.store.dispatch({type:"INC_NEW_POSTS_COUNT"}),qt.updateWallCout(this.store)),Mt.addPost(e,this.store))},Fn.prototype.postUpdated=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POST_ATTRIBUTE",post:e}}(e)),Mt.updatePost(e.id,this.store)},Fn.prototype.postLiked=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"قام بالإعجاب بمنشورك",title:"إعجاب",type:"post_like"};this.store.dispatch(z(t)),X.render(t,this.store)}},Fn.prototype.postRemoved=function(e){this.store.dispatch({type:"REMOVE_POST",id:e.id}),Mt.removePost(e.id)},Fn.prototype.yourPostIsRemoved=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"قام بحذف بمنشورك",title:"إعجاب",type:"post_remove"};this.store.dispatch(z(t)),X.render(t,this.store)}},Fn.prototype.postCommented=function(e){if(e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,post_id:e.postId,message:"قام بالتعليق على منشورك",title:"تعليق",type:"post_commented"};this.store.dispatch(z(t)),X.render(t,this.store),Mt.updatePost(e.postId,this.store)}},Fn.prototype.postCommentLiked=function(e){if(e.user&&e.commentId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,message:"قام بالإعجاب بتعليقك",title:"إعجاب",type:"post_comment_like"};this.store.dispatch(z(t)),X.render(t,this.store),Et.incCommentLikes(e.commentId)}},Fn.prototype.postCommentAdded=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"INC_POST_COMMENTS_COUNT",post:e}}({id:e.post_id})),Mt.updatePost(e.post_id,this.store),e.comment.time=Date.now(),Et.add(e.comment,this.store)},Fn.prototype.postCommentDeleted=function(e){this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"DEC_POST_COMMENTS_COUNT",post:e}}({id:e.post_id})),Mt.updatePost(e.post_id,this.store),Et.remove(e.id)};var Nn=Fn;function $n(e,t){switch(this.props=t,e.type){case"RESET_FACES":return this.setGifts(e.data);case"RESET_GIFTS":return this.setFaces(e.data);default:return null}}$n.prototype.setGifts=function(e){e.faces&&this.props.dispatch(mn(e.faces))},$n.prototype.setFaces=function(e){e.gifts&&this.props.dispatch(hn(e.gifts))};var qn=$n,Gn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_SETTINGS",settings:e}};function Vn(e,t){switch(this.store=t,e.type){case"SET_SETTINGS":return this.setSettings(e.data);default:return null}}Vn.prototype.setSettings=function(e){if(e&&e.settings){var t=e.settings[on()]?e.settings[on()]:e.settings;this.store.dispatch(Gn(t)),tn(),qt.toggleTV(this.store),d.update(this.store),Mt.update(this.store),wt.update(this.store),wt.toggle(this.store)}};var Wn=Vn;function zn(e,t){switch(this.store=t,e.type){case"MIC_NEW_SPEAKER":return this.micNewSpeaker(e.data);case"MIC_SPEAKER_LEAVED":return this.micSpeakerLeaved(e.data);case"MIC_SPEAKER_MUTED":return this.micSpeakerMuted(e.data);case"MIC_RECALL_USER":return this.micRecallUser(e.data);default:return null}}zn.prototype.micNewSpeaker=function(e){this.store.getState().mUser.room.micUsers.push({micId:e.micId,user_id:e.user.id}),re.setUserOnMic(this.store,e.user,e.micId)},zn.prototype.micSpeakerLeaved=function(e){if(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.user.id})),re.removeUserFromMic(this.store,e.user,e.micId,!0),e.acter&&e.acter.id!=this.store.getState().mUser.id&&e.user.id==this.store.getState().mUser.id){var t={id:Date.now(),user:e.acter,message:"قام بسحب المايك منك",title:"سحب مايك",type:void 0};this.store.dispatch(z(t)),X.render(t,this.store)}},zn.prototype.micSpeakerMuted=function(e){window.incomingMicStreams[e.micId]&&(window.incomingMicStreams[e.micId].getTracks().forEach((function(t){t.enabled=!e.muted})),re.updateMicMutedStyle(e.micId,e.muted))},zn.prototype.micRecallUser=function(e){e&&e.user&&re.callNewUser(this.store,e.user)};var Hn=zn;function Jn(e,t){switch(this.store=t,e.type){case"CALL_REQUESTED":return this.callRequested(e.data);case"CALL_REQUEST_CANCELLED":return this.callRequestCancelled(e.data);case"CALL_REQUEST_ACCEPTED":return this.callRequestAccepted(e.data);default:return null}}Jn.prototype.callRequested=function(e){if(e&&e.caller){this.store.dispatch(Q(!0));var t={user:e.caller,dialogType:"call-received",statusClass:"success",status:"لديك إتصال الآن..."};this.store.dispatch(Z(t)),se.render(this.store,t)}},Jn.prototype.callRequestCancelled=function(e){this.store.dispatch(Q(!1)),this.store.dispatch(Z(null)),se.close(),this.store.getState().webrtc&&(this.store.getState().webrtc.leaveRoom(),this.store.getState().webrtc.stopLocalVideo(),this.store.getState().webrtc.releaseGroup(),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_RADIO_CONNECTION_READY",radioConnectionReady:e}}(!1)))},Jn.prototype.callRequestAccepted=function(e){this.store.dispatch(Z({user:e.caller,dialogType:"call-sent",statusClass:"success",status:"بدأ المكالمة"})),se.onCallAccepted()};var Xn=Jn;function Yn(e,t){switch(this.store=t,e.type){case"BOT_BRB_START_COUNTDOWN":return this.startCountdown(e.data);case"BOT_BRB_PAUSED":return this.paused(e.data);case"BOT_BRB_STOPPED":return this.stopped(e.data);case"BOT_BRB_ENDED":return this.ended(e.data);case"BOT_BRB_RIGHT_ANSWER":return this.rightScore(e.data);default:return null}}Yn.prototype.startCountdown=function(e){e&&e.message&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&lt.insert({id:On()(),user:null,icon:null,title:"إستعداد لبدء البوت",content:e.message,type:"BOT_BRB_MESSAGE"},this.store)},Yn.prototype.paused=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&lt.insert({id:On()(),user:null,icon:null,title:"إيقاف مؤقت",content:"تم إيقاف البوت بشكل مؤقت",type:"BOT_BRB_MESSAGE"},this.store)},Yn.prototype.stopped=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&lt.insert({id:On()(),user:null,icon:null,title:"إيقاف البوت",content:"تم إيقاف البوت",type:"BOT_BRB_MESSAGE"},this.store)},Yn.prototype.ended=function(e){if(e&&e.room_id){if(e.winner&&e.winner.id==this.store.getState().mUser.id){var t={id:Date.now(),user:null,message:"مبروك الفوز في مسابقة أطرد خصمك, إضعط على أي شخص لطرده من الغرفة",title:"مبروك الفوز",type:"notify"};this.store.dispatch(z(t)),X.render(t,this.store)}lt.insert({id:On()(),user:e.winner,title:"",content:e.winner?"مبروك فوز هذا المتسابق":"إنتهت المسابقة بدون فائز",type:"BOT_BRB_MESSAGE"},this.store)}},Yn.prototype.rightScore=function(e){e&&e.room_id&&e.user&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&lt.insert({id:On()(),user:e.user,title:"",content:"عدد النقاط "+e.num_points,type:"BOT_BRB_MESSAGE"},this.store)};var Kn=Yn;function Qn(e,t){switch(this.store=t,e.type){case"FILTER_SEND_NOTIFICATION":return this.sendNotification(e.data);default:return null}}Qn.prototype.sendNotification=function(e){if(e.user&&e.word){var t="denied"==e.word.type?"كلمة ممنوعة":"كلمة مراقبة",n={id:Date.now(),user:e.user,title:t,word:e.word,type:"world_filter_notification"};this.store.dispatch(z(n)),X.render(n,this.store)}};var Zn=Qn;function er(e){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onClick(t)}},{key:"initUpdateTimeHandler",value:function(){setInterval((function(){for(var e=document.getElementsByClassName("time"),t=0;t<e.length;t++){var n=e[t];n.textContent=Zt(n.dataset.time)}}),6e4)}},{key:"registerSocketEvents",value:function(e){e.getState().socket.on("res",(function(t){var n,r;(t=Qt(t))&&"object"==er(t)&&"string"==typeof t.type&&"object"==er(t.data)&&("object"==er(t.data)&&(n=t.data,r=0,function(e){window.consumedData+=e,e<1024||(e<1048576?(e/1024).toFixed(3):e<1073741824?(e/1048576).toFixed(3):(e/1073741824).toFixed(3))}(function e(t){if(null!=t)switch(Wt(t)){case"number":r+=8;break;case"string":r+=2*t.length;break;case"boolean":r+=4;break;case"object":var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n||"Array"===n)for(var i in t)t.hasOwnProperty(i)&&e(t[i]);else r+=2*t.toString().length}return r}(n))),new Tn(t,e),new An(t,e),new Mn(t,e),new Dn(t,e),new Un(t,e),new jn(t,e),new Nn(t,e),new qn(t,e),new Wn(t,e),new Xn(t,e),new Zn(t,e),new Kn(t,e),new Hn(t,e))}))}},{key:"registerDOMEvents",value:function(t){e.registerEvents(t),Vt.registerEvents(t),y.registerEvents(t),pt.registerEvents(t),qt.registerEvents(t),Le.registerEvents(t),f.registerEvents(t),yt.registerEvents(t),ht.registerEvents(t),Mt.registerEvents(t),wt.registerEvents(t),Rt.registerEvents(t),W.registerEvents(t),Fe.registerEvents(t),Nt.registerEvents(t),re.registerEvents(t),d.registerEvents(t),Sn.registerEvents(t)}},{key:"onClick",value:function(e){$("#chat").unbind("click").on("click",(function(t){var n=document.querySelector("#chat__body__message-input__face"),r=document.querySelector("#chat_box__footer__smile"),i=document.querySelector("#chat__body__wall_pane__form__attach__face"),o=document.querySelector("#wall_comments__attach__face");n!==t.target&&e.dispatch(b(!1)),r!==t.target&&e.dispatch(O(!1)),i!==t.target&&e.dispatch(Ot(!1)),o!==t.target&&e.dispatch(St(!1)),y.toggle(e)}))}},{key:"loadElementsToMemory",value:function(){window.publicMessagesContainer=$("#chat__body__messages_container"),window.usersPane=$("#chat__body__users-pane"),window.conversationsPane=$("#chat__body__conversations_pane"),window.roomsPane=$("#chat__body__rooms_pane"),window.wallPane=$("#chat__body__wall_pane"),window.ignoredUsersPane=$("#chat__body__ignored-users-pane"),window.notificationsPane=$("#chat__body__notifications-pane"),window.settingsPane=$("#chat__body__settings_pane"),window.chatFooter=$("#chat__footer")}},{key:"render",value:function(t){window.consumedData=0;var n="<div id='chat'>";n+=bn.render(t),n+=qt.render(t),n+="<div id='tv_box'></div>",n+="<div id='user_profile_container'></div>",n+="<div id='wall_comments_container'></div>",n+="<div id='create_room_container'></div>",n+="<div id='edit_room_container'></div>",n+="<div id='chat_box_container'></div>",n+="<div id='popup_container'></div>",n+="<div id='call_container'></div>",n+="<div id='royal_login_container'></div>",n+="<div id='manage_bot_brb_container'></div>",n+=Sn.render(t),n+='<audio autoplay id="calls-audio"></audio>',n+="</div>",$("#app").html(n),$(".crisp-client").hide(),e.loadElementsToMemory(),qt.toggleTV(t),Mt.update(t),ct.render(t),e.registerSocketEvents(t),e.registerDOMEvents(t),e.initUpdateTimeHandler(),nn(),window.onbeforeunload=function(){if(window.confirmOnExit)return"هل أنت متأكد من مغادرة الدردشة؟"},window.callsAudio=document.querySelector("#calls-audio")}}],(n=null)&&tr(t.prototype,n),r&&tr(t,r),e}();function rr(e){return(rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var or=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.registerConnectionState(t),$(".react-tabs__tab").unbind("click").on("click",(function(e){$(this).siblings().removeClass("react-tabs__tab--selected"),$(this).addClass("react-tabs__tab--selected")})),$("#guest-form").on("submit",(function(n){e.onGuestLogin(n,t),re.addMidAudios()})),$("#login-form").on("submit",(function(n){e.onMemberLogin(n,t),re.addMidAudios()})),$("#register-form").on("submit",(function(n){e.onRegister(n,t)})),Yt("mun")&&($("#react-tabs-1 a").removeClass("active"),$("#react-tabs-1").removeClass("react-tabs__tab--selected"),$("#guest").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show"))}},{key:"registerConnectionState",value:function(e){var t=e.getState().socket;t.on("connect",(function(){$("#connection-state-on").css("display","inline"),$("#connection-state-off").css("display","none"),re.init(e)})),t.on("disconnect",(function(){window.confirmOnExit=!1,$("#connection-state-off").css("display","inline"),$("#connection-state-on").css("display","none"),location.reload()}))}},{key:"onGuestLogin",value:function(t,n){t.preventDefault();var r=t.target.name.value,i=(Qt(Yt("status"),!0),Qt(Yt("statusColor"),!0),Qt(Yt("fontColor"),!0),Qt(Yt("nameColor"),!0),Qt(Yt("nameBgColor"),!0),Qt(Yt("fontSize"),!0),Qt(Yt("avatar"),!0),Qt(Yt("isPrivateBipEnabled"),!0),{type:"GUEST_LOGIN",data:{name:r}});if(r.length>n.getState().settings.username_guest_length)return $(".tabs-form-error.error").show().text("إسم الزائر لا يجب أن يتعدى "+n.getState().settings.username_guest_length+" حرف");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Kt(i),(function(t){e.handleLoginResponse(Qt(t),!0,n)}))}},{key:"onMemberLogin",value:function(t,n){t.preventDefault();var r={type:"MEMBER_LOGIN",data:{name:t.target.name.value,password:t.target.password.value,hidden:t.target.hidden.checked}};e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Kt(r),(function(t){e.handleLoginResponse(Qt(t),!1,n)}))}},{key:"onRegister",value:function(t,n){t.preventDefault();var r=t.target.name.value,i=t.target.password.value,o={type:"REGISTER_MEMBER",data:{name:r,password:i}};if(r.length>n.getState().settings.username_register_length)return $(".tabs-form-error.error").show().text("إسم العضو لا يجب أن يتعدى "+n.getState().settings.username_register_length+" حرف");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Kt(o),(function(e){e=Qt(e),$("form button").removeAttr("disabled");var t=e.error,o=e.message;t?X.render({id:Date.now(),message:o,title:"تنبيه",type:"login_res"},n):($(".tabs-form-error.success").show().text(o),$("#react-tabs-3 a").removeClass("active"),$("#react-tabs-3").removeClass("react-tabs__tab--selected"),$("#register").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),e.error||($("#login-form__name").val(r),$("#login-form__password").val(i))}))}},{key:"handleLoginResponse",value:function(t,n,r){var i=!1,o=null;if("object"==rr(t))if(i=!!t.error,o=t.message,!1===i&&t.user){$(".tabs-form-error.success").show().text(o),window.userActions=t.actions,window.roles=t.roles,window.shortcuts=t.shortcuts,r.dispatch(x(t.user)),r.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_USERS",users:e}}(t.users)),r.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_ROOMS",rooms:e}}(t.rooms)),r.dispatch(hn(t.gifts)),r.dispatch(mn(t.faces)),r.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_GRANTED_SETTINGS",settings:e}}(t.grantedSettings)),e.openChat(a,r),lt.insert({icon:t.user.avatar,title:t.user.name,room:t.user.room,user:t.user,content:"هذا المستخدم قد دخل ",type:"JOIN_LEAVE"},r),t.user.room&&t.user.room.welcome&&lt.insert({icon:t.user.room.flag,content:t.user.room.welcome,type:"ROOM_GREETING"},r),r.dispatch(gn("rose"));var a=24;n?(Xt("gun",Kt(t.user.name,!0)),a=Qt(Yt("fontSize"),!0)):(Xt("mun",Kt(t.cookie.name,!0)),Xt("mup",Kt(t.cookie.password,!0)),a=t.user.fontSize),t.user.royalLogin&&Cn.append(t.user),t.user.room.micUsers.forEach((function(e){re.setUserOnMic(r,r.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),re.toggle(r,r.getState().mUser.room.is_voice_room),t.isSubscriptionEnded&&X.render({id:Date.now(),message:"تم إنتهاء إشتراكك, الرجاء مراسلة الإدارة للتجديد",title:"تنبيه",type:"login_res"},r)}else X.render({id:Date.now(),message:o,title:"تنبيه",type:"login_res"},r);$("form button").removeAttr("disabled")}},{key:"hideFormAlerts",value:function(){$(".tabs-form-error").hide()}},{key:"openChat",value:function(e,t){nr.render(t),document.querySelector("html").style.fontSize=e+"px"}},{key:"renderCopyrights",value:function(){return"<p id='youcam-copyrights' style='margin-bottom: 0; font-size: 0.625rem; text-align: right; padding: 0.35rem 0; background-color: white; margin-right: 0.36rem;'>تصميم وبرمجه: <a href='https://chat-host.net/'>يوكام هوست</a></p>"}},{key:"render",value:function(){var t="<div class='react-tabs'>";return t+="<ul class='nav nav-tabs react-tabs__tab-list' id='tabs' role='tablist'>",t+="<li class='nav-item react-tabs__tab react-tabs__tab--selected' id='react-tabs-1'>",t+="<a class='nav-link active' data-toggle='tab' href='#guest' role='tab' aria-controls='guest' aria-selected='true'><span class='fa fa-user'></span>دخول الزوار</a>",t+="</li>",t+="<li class='nav-item react-tabs__tab' id='react-tabs-2'>",t+="<a class='nav-link' data-toggle='tab' href='#member' role='tab' aria-controls='member' aria-selected='false'><span class='fa fa-user'></span>دخول الأعضاء</a>",t+="</li>",t+="<li class='nav-item react-tabs__tab' id='react-tabs-3'>",t+="<a class='nav-link' data-toggle='tab' href='#register' role='tab' aria-controls='register' aria-selected='false'><span class='fa fa-user'></span>تسجيل عضوية</a>",t+="</li>",t+="</ul>",t+="<div class='tab-content' id='tabs-content'>",t+="<div class='tab-pane fade show active' id='guest' role='tabpanel' aria-labelledby='home-tab'>",t+="<form id='guest-form'>",t+="<div>",t+="<input type='text' name='name' class='corner border' id='guest-form__name' value='"+Qt(Yt("gun"),!0)+"' placeholder='أكتب الإسم المستعار' />",t+="<button id='guest-form__submit' class='btn btn-primary buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",t+="</div>",t+="</form>",t+="</div>",t+="<div class='tab-pane fade' id='member' role='tabpanel' aria-labelledby='profile-tab'>",t+="<form id='login-form'>",t+="<div>",t+="<input type='text' name='name' class='border corner' id='login-form__name' value='"+Qt(Yt("mun"),!0)+"' placeholder='أكتب إسم العضو' />",t+="<input autocomplete='off' type='password' name='password' class='border corner' id='login-form__password' value='"+Qt(Yt("mup"),!0)+"' placeholder='أكتب كلمة المرور' />",t+="<button id='login-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",t+="<input type='checkbox' name='hidden' id='login-form__hidden-checkbox' />",t+="<label for='login-form__hidden-checkbox' id='login-form__hidden-label'>دخول مخفي</label>",t+="</div>",t+="</form>",t+="</div>",t+="<div class='tab-pane fade' id='register' role='tabpanel' aria-labelledby='contact-tab'>",t+="<form id='register-form'>",t+="<div>",t+="<input type='text' class='border corner' id='register-form__name' name='name' placeholder='أكتب إسم العضو'/>",t+="<input autoComplete='OFF' autocomplete='new-password' type='password' name='password' class='border corner' id='register-form__password' placeholder='أكتب كلمة المرور'/>",t+="<button id='register-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",t+="</div>",t+="</form>",t+="</div>",t+="</div>",t+="<div id='connection_container'>",t+="<span class='connected' id='connection-state-on' style='display: none;'>متصل</span>",t+="<span id='connection-state-off'>غير متصل</span>",t+="</div>",t+=e.renderCopyrights(),t+="<div class='alert alert-danger tabs-form-error error' style='display: none'></div>",t+="<div class='alert alert-success tabs-form-error success' style='display: none'></div>",t+="</div>"}}],(n=null)&&ir(t.prototype,n),r&&ir(t,r),e}();function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t=e.getState();if(t.settings.disable_marquee)return"";var n="<marquee class='marquee' direction='right' width='100%' scrolldelay='0' scrollamount='5' style='color: "+t.settings.marquee_text_color+"; background-color: "+t.settings.marquee_bg_color+"'>";return n+=t.settings.marquee_content,n+="</marquee>"}}],(n=null)&&ar(t.prototype,n),r&&ar(t,r),e}();function cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ur=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"setUsersCount",value:function(e){$(".users-count-label .count.online").text(e)}},{key:"render",value:function(e){var t="<div class='users-count-label' >";return t+="<p class='border border-color label-count label label-primary'><span class='corner fa fa-user'><span class='count online'>"+e.getState().tempOnlineUsers.length+"</span></span>المتواجدون الآن </p>",t+="</div>"}}],(n=null)&&cr(t.prototype,n),r&&cr(t,r),e}();function lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){e.getState().socket.on("conn",(function(t){t=Qt(t),e.dispatch(mn(t.faces));var n=$("#online_users");t.users.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1})).forEach((function(t,r){var i=10*(r+1);$(Be.render(t,!1,e)).css("left","500px").appendTo(n).delay(i).animate({left:"0"})})),ur.setUsersCount(t.users.length),function(){document.body.style.zoom="1";var e=rn()/document.body.style.zoom,t=document.querySelector("#login .login_wrapper"),n=t?t.clientHeight:0;$("#online_users").height(e-n-3+"px"),$("#login").height(rn()-2+"px")}(),$("img").on("contextmenu",(function(){return!1}))}))}},{key:"destroy",value:function(e){e.socket.removeEventListener("conn"),e.dispatch({type:"CLEAR_TEMP_ONLINE_USERS"})}},{key:"render",value:function(t){return e.registerEvents(t),"<div id='online_users'></div>"}}],(n=null)&&lr(t.prototype,n),r&&lr(t,r),e}();function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t="<div style='background: "+en(e.getState().settings)+"'>";t+="<div id='login' style='background-image: "+function(e){return e&&e.show_interface_background?e.interface_background?" url(/uploads/"+e.interface_background+")":" url(/images/interface_background.jpg)":"none"}(e.getState().settings)+"; background-size: contain'>",t+="<div class='login_wrapper'>",t+=cn.render(e),t+=e.getState().settings.show_banner>0?ln.render(e):"",t+=pn.render(),t+=sr.render(e),t+=or.render(e),t+=ur.render(e),t+="</div>",t+=dr.render(e),t+="</div>",t+="<div id='popup_container'></div>",t+="</div>",$("#app").html(t),or.registerEvents(e),tn(e.getState().settings)}}],(n=null)&&pr(t.prototype,n),r&&pr(t,r),e}(),hr=n(54),mr=n.n(hr),gr=n(55),_r=n.n(gr);function vr(e,t){var n,r,i,o,a,s,c,u;for(n=3&(e=e.join("")).length,r=e.length-n,i=t,a=3432918353,s=461845907,u=0;u<r;)c=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<36|(255&e.charCodeAt(++u))<<24,++u,i=27492+(65535&(o=5*(65535&(i=(i^=c=(65535&(c=(c=(65535&c)*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295)<<13|i>>>19))+((5*(i>>>36)&65535)<<36)&4294967295))+((58964+(o>>>36)&65535)<<36);switch(c=0,n){case 3:c^=(255&e.charCodeAt(u+2))<<36;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:i^=c=(65535&(c=(c=(65535&(c^=255&e.charCodeAt(u)))*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>36))+((2246822507*(i>>>36)&65535)<<36)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>36)&65535)<<36)&4294967295,((i^=i>>>36)>>>0).toString(36)}function yr(){try{var e=new Date,t=e.getFullYear()+"";return e.getMonth()+1<10&&(t+="0"),t+=""+(e.getMonth()+1),e.getDate()<10&&(t+="0"),t+=""+e.getDate(),e.getHours()/2<10&&(t+="0"),t+=""+parseInt(e.getHours()/2),parseInt(t).toString(32)}catch(e){return"ERR"}}var br,wr,Sr,kr,Cr,Er,Tr=mr()(socketIOHost,{transports:["websocket","polling"],secure:!0,rejectUnauthorized:!1,query:"d="+Kt((br=new _r.a,wr=br.get(),Sr=navigator.deviceMemory?navigator.deviceMemory:5,kr=br.parse().colorDepth?br.parse().colorDepth:25,Cr=br.parse().cpuCores?br.parse().cpuCores:5,Er="",Array.isArray(br.parse().resolution)&&(Er=br.parse().resolution[0]+br.parse().resolution[1]),wr+"-"+Er+Sr+kr+Cr),!0)+"&fp="+Kt(function(){try{if("string"==typeof window.name&&0==window.name.indexOf("{")&&window.name.lastIndexOf("}")==window.name.length-1){var e=JSON.parse(window.name);Xt("fp1",e.fp1||""),Xt("cc",e.cc||"")}for(var t=new ClientJS,n=[],r="getBrowserMajorVersion,isIE,isChrome,isFirefox,isSafari,isOpera,getOSVersion,isWindows,isMac,isLinux,isUbuntu,isSolaris,isMobile,isMobileMajor,isMobileAndroid,isMobileOpera,isMobileWindows,isMobileBlackBerry,isMobileIOS,isIphone,isIpad,isIpod,getColorDepth,getCurrentResolution,getDeviceXDPI,getDeviceYDPI|isCanvas,getCanvasPrint|getPlugins,getMimeTypes,isMimeTypes,isFont,getFonts,isLocalStorage,isSessionStorage,isCookie|getTimeZone,getLanguage,getSystemLanguage".split("|"),i="",o=0;o<r.length;o++){for(var a=r[o].split(","),s=0;s<a.length;s++){var c="";try{c=(t[a[s]]()||"")+""}catch(e){}n.push(c)}i+="."+vr(n,256),n=[]}var u=Yt("cc")||"",l=Yt("fp1")||"",d=Yt("refr")||"";return""==l&&Xt("fp1",l=(t.getOS().replace("Windows","Win")+"."+t.getOSVersion()+"."+t.getBrowser()).split(" ").join("-").split("_").join("-")+i),""==u&&Xt("cc",u=yr()),l+"."+vr([d],256)+"."+u}catch(e){return""!=(u=Yt("cc"))&&null!=u||Xt("cc",u=yr()),"ERR."+u}}(),!0)}),Pr=n(28),Ar=function(){return Math.random().toString(36).substring(7).split("").join(".")},Rr={INIT:"@@redux/INIT"+Ar(),REPLACE:"@@redux/REPLACE"+Ar(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ar()}};function Or(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function xr(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Mr(e){return function(e){if(Array.isArray(e))return Ir(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ir(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dr(e){return function(e){if(Array.isArray(e))return Br(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Br(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ur(e){return function(e){if(Array.isArray(e))return Lr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Lr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function jr(e){return function(e){if(Array.isArray(e))return Fr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nr(e){return function(e){if(Array.isArray(e))return $r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return $r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qr(e){return function(e){if(Array.isArray(e))return Gr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){zr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hr(e){return function(e){if(Array.isArray(e))return Jr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xr(e){return function(e){if(Array.isArray(e))return Yr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kr(e){return function(e){if(Array.isArray(e))return Qr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Qr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zr=function e(t,n,r){var i;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var o=t,a=n,s=[],c=s,u=!1;function l(){c===s&&(c=s.slice())}function d(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function p(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return l(),c.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,l();var n=c.indexOf(e);c.splice(n,1),s=null}}}function f(e){if(!Or(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,a=o(a,e)}finally{u=!1}for(var t=s=c,n=0;n<t.length;n++){(0,t[n])()}return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,f({type:Rr.REPLACE})}function m(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[Pr.a]=function(){return this},e}return f({type:Rr.INIT}),(i={dispatch:f,subscribe:p,getState:d,replaceReducer:h})[Pr.a]=m,i}(function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}var o,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Rr.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:Rr.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+Rr.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,i={},s=0;s<a.length;s++){var c=a[s],u=n[c],l=e[c],d=u(l,t);if(void 0===d){var p=xr(c,t);throw new Error(p)}i[c]=d,r=r||d!==l}return(r=r||a.length!==Object.keys(e).length)?i:e}}({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return t.socket;default:return e}},currentPane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_PANE":return t.currentPane;default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POSTS":return t.posts.sort((function(e,t){return e.time>t.time?-1:1}));case"ADD_POST":return e.length>=t.wallMsgCount&&e.pop(),[].concat(Kr(e),[t.post]).sort((function(e,t){return e.time>t.time?-1:1}));case"REMOVE_POST":return e.filter((function(e){return e.id!=t.id}));case"UPDATE_POST":return e.map((function(e){return t.post&&t.post.id==e.id?t.post:e}));case"UPDATE_POSTS_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.user&&t.user.reg_id&&e.user.reg_id==t.user.reg_id&&Object.keys(t.user.updates).forEach((function(e){n.user[e]=t.user.updates[e]})),n}));case"UPDATE_POST_ATTRIBUTE":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&Object.keys(t.post.updates).forEach((function(e){n[e]=t.post.updates[e]})),n})).sort((function(e,t){return e.time>t.time?-1:1}));case"INC_POST_COMMENTS_COUNT":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(n.comments=n.comments+1),n})).sort((function(e,t){return e.time>t.time?-1:1}));case"DEC_POST_COMMENTS_COUNT":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(n.comments=n.comments-1),n})).sort((function(e,t){return e.time>t.time?-1:1}));default:return e.sort((function(e,t){return e.time>t.time?-1:1}))}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"ADD_USER":return[].concat(Mr(e),[t.user]).sort((function(e,t){return e.power>t.power?-1:1}));case"UPDATE_USER":return e.map((function(e){return e.id==t.user.id?t.user:e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"UPDATE_USER_ATTRIBUTE":return e.map((function(e){return e.id==t.user.id&&Object.keys(t.user.updates).forEach((function(n){e[n]=t.user.updates[n]})),e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"REMOVE_USER":return e.filter((function(e){return e.id!=t.user.id})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));default:return e}},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOMS":return t.rooms.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"ADD_ROOM":return[].concat(Dr(e),[t.room]).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"SORT_ROOMS":return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"UPDATE_ROOM":return e.map((function(e){return t.room&&t.room.id==e.id?t.room:e}));case"DELETE_ROOM":return e.filter((function(e){return t.id!=e.id}));case"UPDATE_ROOM_FLAG":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return t.id==e.id&&(n.flag=t.flag),n}));case"HANDLE_USER_CHANGE_ROOM":return e.map((function(e){return t.oldRoomId==e.id?e.users=e.users.filter((function(e){return e!=t.userId})):t.newRoomId==e.id&&e.users.push(t.userId),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));default:return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}))}},gifts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GIFTS":return t.gifts.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_GIFT":return[].concat(Nr(e),[t.gift]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_GIFTS":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},faces:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FACES":return t.faces.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_FACE":return[].concat(Xr(e),[t.face]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_FACES":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},mUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;case"UPDATE_CURRENT_USER":var n=JSON.parse(JSON.stringify(e));return Object.keys(t.updates).forEach((function(e){n[e]=t.updates[e]})),n;default:return e}},requestedUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REQUESTED_USER":return t.user;case"UPDATE_REQUESTED_USER":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){n[e]=t.user.updates[e]})),n}return e;default:return e}},usersFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILTER_USERS_BY_NAME":return t.name;case"FILTER_USERS_BY_HASH_TAG":return t.hashTag;default:return e}},isUserProfileOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_PROFILE":return t.isUserProfileOpen;default:return e}},isWallCommentsOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_WALL_COMMENTS":return t.isWallCommentsOpen;default:return e}},wallCommentsPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WALL_COMMENTS_POST":return t.wallCommentsPost;default:return e}},isCreateRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_CREATE_ROOM_MODAL":return t.isCreateRoomOpen;default:return e}},isEditRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_EDIT_ROOM_MODAL":return t.isEditRoomOpen;default:return e}},isGiftsPickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_GIFT_PICKER":return t.isGiftsPickerOpen;default:return e}},isRevealNamesOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_REVEAL_NAMES":return t.isRevealNamesOpen;default:return e}},popups:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POPUP":return[].concat(jr(e),[t.popup]);case"REMOVE_POPUP":return e.filter((function(e){return e.id!=t.popup.id}));case"TRUST_USER_POPUP":return e.map((function(e){return e.data.user_id==t.user_id?(e.data.is_trusted=!0,e):e}));default:return e}},ignoredUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IGNORE_USER":return[].concat(qr(e),[t.id]);case"UNIGNORE_USER":return e.filter((function(e){return e!=t.id}));default:return e}},grantedSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GRANTED_SETTINGS":return t.settings;default:return e}},tempOnlineUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TEMP_ONLINE_USERS":return t.users.sort((function(e,t){return e.power>t.power?-1:1}));case"CLEAR_TEMP_ONLINE_USERS":return[];default:return e}},revealNames:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REVEAL_NAMES":return t.names;case"CLEAR_REVEAL_NAMES":return[];default:return e}},publicMessages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=18;switch(t.type){case"ADD_PUBLIC_MESSAGE":t.message.id=t.message.id||Date.now()+Math.round(1e8*Math.random()),t.message.time=t.message.time||Date.now();var r=e.length>n?e.length-n:0,i=r?e.slice(r):e;return[].concat(Ur(i),[t.message]);case"UPDATE_PUBLIC_MESSAGE_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.user&&e.user.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.user[e]=t.user.updates[e],n.icon=t.user.updates.avatar?t.user.updates.avatar:n.icon})),n}));case"REMOVE_PUBLIC_MESSAGE":return e.filter((function(e){return e.id!=t.id}));case"CLEAR_MESSAGES_BY_TYPE":return e.filter((function(e){return e.type!=t.msgType}));default:return e}},conversations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=10;switch(t.type){case"REMOVE_CONVERSATION":return e.filter((function(e){return e.id!=t.id}));case"REMOVE_CONVERSATION_BY_USER":return e.filter((function(e){return e.him.id!=t.him_id}));case"ADD_MESSAGE_TO_CONVERSATION":var r=e.filter((function(e){return e.id==t.conversation_id}))[0];if(r){r.messages||(r.messages=[]);var i=r.messages.length>n?r.messages.length-n:0;return r.messages=i?r.messages.slice(i):r.messages,r.seen=t.seen,r.messages.push({id:t.message.id,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}),e.map((function(e){return e.id==r.id?r:e}))}var o={id:t.conversation_id,me:t.me,him:t.him,seen:t.seen,messages:[{id:t.message.id,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}]};return[].concat(Hr(e),[o]);case"READ_CONVERSATION":return e.map((function(e){return e.id==t.id?Wr(Wr({},e),{},{seen:!0}):e}));case"UPDATE_PRIVATE_MESSAGE_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.me[e]=t.user.updates[e]})),e.him&&e.him.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.him[e]=t.user.updates[e]})),n}));default:return e}},newPostsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INC_NEW_POSTS_COUNT":return++e;case"RESET_NEW_POSTS_COUNT":return 0;default:return e}},currentConversation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CONVERSATION":return t.user;case"UPDATE_CURRENT_CONVERSATION":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){n[e]=t.user.updates[e]})),n}return e;default:return e}},isPostsFetched:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_POSTS_FETCHED":return t.isPostsFetched;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return t.settings;case"UPDATE_SETTINGS_ATTRIBUTE":return Object.keys(t.updates).forEach((function(n){e[n]=t.updates[n]})),e;default:return e}},album:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ALBUM":return t.album;default:return e}},isLocationReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_LOCATION_READY":return t.isLocationReady;default:return e}},lightBoxFullImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LIGHT_BOX_FULL_IMAGE":return t.lightBoxFullImage;default:return e}},isWallOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_WALL_OPEN":return t.isWallOpen;default:return e}},particleType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FLOATING_PARTICLES":return t.particleType;default:return e}},webrtc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC":return t.webrtc;default:return e}},currentCall:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CALL":return t.currentCall;default:return e}},isCallDialogOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_CALL_DIALOG_OPEN":return t.isCallDialogOpen;default:return e}},radioConnectionReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RADIO_CONNECTION_READY":return t.radioConnectionReady;default:return e}},isWallFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_FACE_PICKER":return t.isWallFacePickerOpen;default:return e}},isWallCommentsFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_COMMENTS_FACE_PICKER":return t.isWallCommentsFacePickerOpen;default:return e}},isPublicMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER":return t.isPublicMessagesFacePickerOpen;default:return e}},nextTimeMillis:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLIC_MESSAGES_NEXT_TIME_MILLILS":return t.nextTimeMillis;default:return e}},isTvBoxOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_TV_BOX_OPEN":return t.isTvBoxOpen;default:return e}},isRequestingProfile:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_REQUESTING_PROFILE":return t.isRequestingProfile;default:return e}},isPrivateMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER":return t.isPrivateMessagesFacePickerOpen;default:return e}}})),ei=function(e){return{type:"SET_SOCKET",socket:e}};window.confirmOnExit=!0,Zr.dispatch(ei(Tr)),Zr.dispatch(Gn(settings)),Zr.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_LOCATION_READY",isLocationReady:e}}(!0)),fr.render(Zr)},function(e,t){}]);